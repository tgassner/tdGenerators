<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Vitrinen-Fixxer Generator</title>
<script src="https://cdn.jsdelivr.net/npm/makerjs@0/target/js/browser.maker.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bezier-js@2/bezier.js"></script>
<script src="https://cdn.jsdelivr.net/npm/opentype.js@0/dist/opentype.js"></script>

<script type="text/javascript">
	var makerjs = require('makerjs');
</script>
</head>
<body>
<h1>Karton Inlay Generator</h1>

<div id="logodiv" style="background: linear-gradient(to left, #ffcd00, #ffcd14 , #ffcd00);width:fit-content; right:0px;position:absolute;top:0px;padding:20px">
	<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg  xmlns:dc="http://purl.org/dc/elements/1.1/"  xmlns:cc="http://creativecommons.org/ns#"  xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"  xmlns:svg="http://www.w3.org/2000/svg"  xmlns="http://www.w3.org/2000/svg"  xmlns:xlink="http://www.w3.org/1999/xlink"  id="svg8"  version="1.1"  viewBox="0 0 50.469002 15.519"  height="15.519mm"  width="50.469002mm">  <defs  id="defs2">  <rect  id="SVGID_1_"  x="22.370001"  y="29.84"  width="181.41"  height="181.41" />  <rect  id="SVGID_3_"  x="54.110001"  y="146.83"  width="120.25"  height="24.34" />  <rect  id="SVGID_5_"  x="54.110001"  y="146.83"  width="120.25"  height="24.34" />  <rect  id="SVGID_7_"  x="54.110001"  y="121.56"  width="121.28"  height="23.139999" />  <rect  id="SVGID_9_"  x="54.110001"  y="121.56"  width="121.28"  height="23.139999" />  <path  id="SVGID_11_"  d="m 168.62,135.89 c 0.54,0.29 0.91,0.55 1.1,0.79 0.2,0.24 0.3,0.6 0.3,1.07 v 0.47 c 0,1.02 -0.89,1.52 -2.67,1.52 -1.78,0 -3.38,-0.3 -4.79,-0.9 v 4.51 c 1.14,0.48 2.83,0.71 5.08,0.71 2.25,0 4,-0.45 5.24,-1.35 1.24,-0.9 1.87,-2.19 1.87,-3.87 v -1.93 c 0,-0.11 -0.03,-0.21 -0.04,-0.31 -2.3,-0.47 -4.7,-0.91 -7.21,-1.32 z m -113.87,0.43 v 7.59 h 4.7 v -6.22 h 2.33 c 1.68,0 3,-0.4 3.96,-1.21 0.65,-0.54 1.06,-1.28 1.27,-2.17 -4.34,0.59 -8.44,1.26 -12.26,2.01 M 69.41,134 v 9.91 h 10.48 v -3.92 h -5.75 v -6.56 c -1.61,0.18 -3.18,0.37 -4.73,0.57 m 76.16,9.91 h 4.45 l 0.84,-4.97 h 4.26 l 0.9,4.97 h 4.45 l -1.92,-9.92 c -1.44,-0.18 -2.9,-0.36 -4.39,-0.52 l 0.27,1.52 h -2.92 l 0.3,-1.77 c -1.34,-0.14 -2.7,-0.27 -4.07,-0.39 z m -64.2,-11.18 v 11.18 h 10.92 v -4.04 h -6.25 v -4.85 h 5.41 V 132 c -3.45,0.2 -6.81,0.44 -10.08,0.73 m 52.82,11.18 h 10.48 v -3.92 h -5.75 v -7.84 c -1.56,-0.1 -3.13,-0.19 -4.73,-0.27 z m -35.91,-12.23 0.64,1.5 -4.6,10.73 h 5.07 l 2.11,-5.88 1.99,5.88 h 5.07 l -4.63,-10.73 0.73,-1.71 c -2.15,0.05 -4.28,0.13 -6.38,0.21 m 20.44,7.16 c 0,1.66 0.58,2.94 1.73,3.86 1.15,0.91 2.84,1.37 5.05,1.37 2.21,0 4.14,-0.43 5.75,-1.31 v -10.42 h -4.54 v 7.28 c -0.33,0.17 -0.8,0.25 -1.42,0.25 -0.61,0 -1.07,-0.13 -1.38,-0.39 -0.31,-0.26 -0.47,-0.64 -0.47,-1.13 v -6.87 c -1.56,-0.04 -3.14,-0.06 -4.73,-0.08 v 7.44 z m -8.04,-7.45 v 12.52 h 4.73 v -12.53 c -0.47,0 -0.93,-0.01 -1.4,-0.01 -1.12,0 -2.22,0.01 -3.33,0.02" />  <rect  id="SVGID_17_"  x="170.49001"  y="118.36"  width="16.209999"  height="9.5900002" />  <clipPath  id="SVGID_2_">    <use  height="100%"  width="100%"  y="0"  x="0"  xlink:href="#SVGID_1_"  style="overflow:visible"  id="use19" />    </clipPath>  </defs>  <metadata  id="metadata5">  <rdf:RDF>  <cc:Work  rdf:about="">  <dc:format>image/svg+xml</dc:format>  <dc:type  rdf:resource="http://purl.org/dc/dcmitype/StillImage" />  <dc:title></dc:title>  </cc:Work>  </rdf:RDF>  </metadata>  <g  transform="translate(0,-281.481)"  id="layer1">  <g  id="g358">  <g  style="fill:#fff9d1"  id="g40"  clip-path="url(#SVGID_2_)"  class="st1"  transform="matrix(0.26458333,0,0,0.26458333,2.7061703,251.01424)">    <g  id="g38">     <defs  id="defs23" />      <clipPath  id="SVGID_4_">      <use  id="use25"  style="overflow:visible"  xlink:href="#SVGID_3_"  x="0"  y="0"  width="100%"  height="100%" />      </clipPath>      <g  id="g36"  clip-path="url(#SVGID_4_)"  class="st2">      <defs  id="defs29" />       <clipPath  id="SVGID_6_">       <use  id="use31"  style="overflow:visible"  xlink:href="#SVGID_5_"  x="0"  y="0"  width="100%"  height="100%" />       </clipPath>       <path  id="path34"  clip-path="url(#SVGID_6_)"  d="m 163.69,151.53 c -0.88,0 -1.9,0.25 -3.08,0.74 v -0.68 h -1.79 v 14.98 h 1.87 v -12.61 c 0.96,-0.46 1.86,-0.68 2.68,-0.68 1.3,0 1.95,0.64 1.95,1.92 v 11.37 h 1.87 V 155.2 c 0,-0.44 -0.04,-0.79 -0.13,-1.05 0.95,-0.58 1.9,-0.87 2.84,-0.87 1.28,0 1.92,0.64 1.92,1.92 v 11.37 h 1.9 V 155 c 0,-1.11 -0.32,-1.96 -0.95,-2.57 -0.63,-0.61 -1.55,-0.91 -2.74,-0.91 -1.19,0 -2.4,0.36 -3.61,1.08 -0.63,-0.71 -1.54,-1.07 -2.73,-1.07 m -8.56,0.1 c -0.18,0.05 -0.31,0.09 -0.41,0.12 -0.1,0.03 -0.24,0.09 -0.42,0.2 -0.18,0.11 -0.3,0.17 -0.34,0.2 -0.04,0.03 -0.18,0.12 -0.4,0.28 -0.22,0.16 -0.36,0.25 -0.41,0.29 v -1.13 h -1.79 v 14.98 h 1.87 V 154.5 c 0.53,-0.37 0.87,-0.61 1.03,-0.71 0.51,-0.33 1.08,-0.5 1.71,-0.5 h 0.9 v -1.79 h -0.66 c -0.46,0 -0.82,0.05 -1.08,0.13 m -15.66,11.11 c 0,1.25 0.35,2.24 1.05,2.97 0.7,0.74 1.77,1.11 3.21,1.11 1.44,0 2.51,-0.37 3.21,-1.11 0.7,-0.74 1.05,-1.73 1.05,-2.97 v -7.35 c 0,-1.25 -0.35,-2.24 -1.05,-2.97 -0.7,-0.74 -1.77,-1.11 -3.21,-1.11 -1.44,0 -2.51,0.37 -3.21,1.11 -0.7,0.74 -1.05,1.73 -1.05,2.97 z m 6.68,-0.02 c 0,1.65 -0.81,2.47 -2.42,2.47 -1.62,0 -2.42,-0.82 -2.42,-2.47 v -7.29 c 0,-1.63 0.81,-2.45 2.42,-2.45 1.61,0 2.42,0.82 2.42,2.45 z m -16.19,3.84 h 1.87 v -7.71 h 5.29 v -1.69 h -5.29 v -6.63 h 5.58 v -1.66 h -7.45 z m -8.66,-14.93 c -0.18,0.05 -0.31,0.09 -0.41,0.12 -0.1,0.03 -0.24,0.09 -0.42,0.2 -0.18,0.11 -0.3,0.17 -0.34,0.2 -0.04,0.03 -0.18,0.12 -0.4,0.28 -0.22,0.16 -0.36,0.25 -0.41,0.29 v -1.13 h -1.79 v 14.98 h 1.87 V 154.5 c 0.53,-0.37 0.87,-0.61 1.03,-0.71 0.51,-0.33 1.08,-0.5 1.71,-0.5 h 0.9 v -1.79 h -0.66 c -0.45,0 -0.81,0.05 -1.08,0.13 m -13.66,3.79 c 0,-1.65 0.82,-2.47 2.45,-2.47 1.63,0 2.45,0.83 2.45,2.47 v 3.03 h -4.9 z m 3.11,11.27 c 1.21,0 2.25,-0.14 3.13,-0.42 v -1.74 c -1.11,0.32 -2.18,0.47 -3.21,0.47 -1.04,0 -1.8,-0.19 -2.29,-0.58 -0.49,-0.39 -0.74,-0.97 -0.74,-1.76 V 160 h 6.69 v -4.58 c 0,-1.25 -0.35,-2.24 -1.04,-2.99 -0.69,-0.75 -1.76,-1.12 -3.2,-1.12 -1.44,0 -2.51,0.37 -3.22,1.12 -0.71,0.75 -1.07,1.74 -1.07,2.99 v 7.32 c 0,2.64 1.65,3.95 4.95,3.95 m -10.19,-15.11 h -2.47 c -1.23,0 -2.21,0.35 -2.95,1.04 -0.74,0.69 -1.11,1.66 -1.11,2.91 v 7.34 c 0,1.21 0.31,2.14 0.94,2.79 0.62,0.65 1.52,0.97 2.7,0.97 1.18,0 2.16,-0.32 2.95,-0.95 v 0.87 h 1.82 l 0.44,-18.95 H 101 Z m 0,12.48 c -0.63,0.6 -1.47,0.9 -2.53,0.9 -1.42,0 -2.13,-0.74 -2.13,-2.21 v -7.19 c 0,-1.51 0.83,-2.26 2.5,-2.26 h 2.16 z m -16.17,-8.64 c 0,-1.65 0.82,-2.47 2.45,-2.47 1.63,0 2.45,0.83 2.45,2.47 v 3.03 h -4.9 z m 3.11,11.27 c 1.21,0 2.25,-0.14 3.13,-0.42 v -1.74 c -1.11,0.32 -2.18,0.47 -3.21,0.47 -1.04,0 -1.8,-0.19 -2.29,-0.58 -0.49,-0.39 -0.74,-0.97 -0.74,-1.76 V 160 h 6.69 v -4.58 c 0,-1.25 -0.35,-2.24 -1.04,-2.99 -0.69,-0.75 -1.76,-1.12 -3.2,-1.12 -1.44,0 -2.51,0.37 -3.22,1.12 -0.71,0.75 -1.07,1.74 -1.07,2.99 v 7.32 c 0,2.64 1.65,3.95 4.95,3.95 m -10.19,0.11 c 0,0.72 -0.14,1.24 -0.42,1.55 -0.28,0.32 -0.73,0.47 -1.34,0.47 -0.19,0 -0.43,-0.02 -0.71,-0.05 v 1.68 c 0.26,0.05 0.52,0.08 0.76,0.08 1.18,0 2.07,-0.33 2.67,-0.99 0.61,-0.66 0.91,-1.58 0.91,-2.75 v -15.11 h -1.87 z m 2.08,-18.12 c 0,-0.81 -0.38,-1.21 -1.14,-1.21 -0.76,0 -1.15,0.4 -1.15,1.21 0,0.81 0.38,1.21 1.15,1.21 0.77,0 1.14,-0.4 1.14,-1.21 m -17.14,2.9 h -1.79 v 14.98 h 1.87 v -12.61 c 0.97,-0.46 1.86,-0.68 2.69,-0.68 1.3,0 1.95,0.64 1.95,1.92 v 11.37 h 1.87 V 155 c 0,-1.11 -0.32,-1.96 -0.95,-2.57 -0.63,-0.61 -1.43,-0.91 -2.41,-0.91 -0.98,0 -2.05,0.25 -3.22,0.74 v -0.68 z m -7.29,14.98 h 1.87 v -14.87 h -1.87 z m 2.08,-17.88 c 0,-0.81 -0.38,-1.21 -1.14,-1.21 -0.76,0 -1.15,0.4 -1.15,1.21 0,0.81 0.38,1.21 1.15,1.21 0.76,0.01 1.14,-0.4 1.14,-1.21"  class="st3"  style="fill:#647a84" />      </g>     </g>    </g>  <g  style="fill:#fff9d1"  id="g77"  clip-path="url(#SVGID_2_)"  class="st1"  transform="matrix(0.26458333,0,0,0.26458333,2.7061703,251.01424)">    <g  id="g75">     <defs  id="defs43" />      <clipPath  id="SVGID_8_">      <use  id="use45"  style="overflow:visible"  xlink:href="#SVGID_7_"  x="0"  y="0"  width="100%"  height="100%" />      </clipPath>      <g  id="g56"  clip-path="url(#SVGID_8_)"  class="st4">      <defs  id="defs49" />       <clipPath  id="SVGID_10_">       <use  id="use51"  style="overflow:visible"  xlink:href="#SVGID_9_"  x="0"  y="0"  width="100%"  height="100%" />       </clipPath>       <path  id="path54"  clip-path="url(#SVGID_10_)"  d="m 162.28,129.36 c 0,2.03 1.01,3.61 3.02,4.73 l 3.33,1.8 c 0.54,0.29 0.91,0.56 1.1,0.79 0.2,0.24 0.3,0.6 0.3,1.07 v 0.47 c 0,1.02 -0.89,1.52 -2.67,1.52 -1.78,0 -3.38,-0.3 -4.79,-0.9 v 4.51 c 1.14,0.48 2.83,0.72 5.08,0.72 2.25,0 4,-0.45 5.24,-1.35 1.24,-0.9 1.87,-2.19 1.87,-3.87 v -1.93 c 0,-1.87 -0.85,-3.26 -2.55,-4.2 l -3.55,-1.99 c -0.66,-0.35 -1.09,-0.67 -1.29,-0.95 -0.2,-0.28 -0.3,-0.71 -0.3,-1.29 v -0.47 c 0,-0.48 0.14,-0.85 0.44,-1.1 0.29,-0.26 0.85,-0.39 1.68,-0.39 1.62,0 3.06,0.27 4.32,0.81 v -4.48 c -1.04,-0.44 -2.61,-0.65 -4.71,-0.65 -2.1,0 -3.72,0.45 -4.84,1.35 -1.12,0.9 -1.68,2.18 -1.68,3.84 z m -9.34,-2.71 1.49,8.33 h -2.92 z m 7.52,17.26 -4.17,-21.55 h -6.5 l -4.23,21.55 h 4.45 l 0.84,-4.98 h 4.26 l 0.9,4.98 z m -26.27,0 h 10.48 v -3.92 h -5.75 v -17.63 h -4.73 z m -15.47,-5.07 c 0,1.66 0.58,2.94 1.73,3.86 1.15,0.91 2.84,1.37 5.05,1.37 2.22,0 4.14,-0.44 5.75,-1.31 v -10.42 h -4.54 v 7.28 c -0.33,0.17 -0.8,0.25 -1.41,0.25 -0.61,0 -1.07,-0.13 -1.38,-0.39 -0.31,-0.26 -0.47,-0.64 -0.47,-1.14 v -10.23 c 0,-0.5 0.22,-0.89 0.65,-1.18 0.43,-0.29 1.28,-0.43 2.52,-0.43 1.24,0 2.49,0.24 3.73,0.72 v -4.42 c -1.18,-0.39 -2.64,-0.59 -4.39,-0.59 -2.32,0 -4.11,0.48 -5.36,1.45 -1.25,0.96 -1.88,2.26 -1.88,3.9 z m -8.04,5.07 h 4.73 v -21.55 h -4.73 z m -9.18,-15.61 -2.15,-5.94 h -5.04 l 4.6,10.82 -4.6,10.73 h 5.07 l 2.11,-5.88 1.99,5.88 h 5.07 l -4.63,-10.73 4.63,-10.82 h -5.04 z m -20.13,15.61 h 10.92 v -4.04 h -6.25 v -4.85 h 5.41 v -4.04 h -5.41 v -4.57 h 6.25 v -4.04 H 81.37 Z m -11.96,0 h 10.48 v -3.92 h -5.75 v -17.63 h -4.73 z m -14.66,0 h 4.7 v -6.22 h 2.33 c 1.68,0 3,-0.4 3.96,-1.21 0.96,-0.81 1.45,-2 1.45,-3.58 v -5.75 c 0,-1.57 -0.48,-2.77 -1.45,-3.58 -0.96,-0.81 -2.29,-1.21 -3.96,-1.21 h -7.03 z m 7.78,-11.57 c 0,0.87 -0.45,1.31 -1.34,1.31 h -1.74 v -7.25 h 1.74 c 0.89,0 1.34,0.43 1.34,1.31 z"  class="st5"  style="fill:#afca0b" />      </g>      <g  id="g73"  clip-path="url(#SVGID_8_)"  class="st4">      <defs  id="defs59" />       <clipPath  id="SVGID_12_">       <use  id="use61"  style="overflow:visible"  xlink:href="#SVGID_11_"  x="0"  y="0"  width="100%"  height="100%" />       </clipPath>              <radialGradient  gradientUnits="userSpaceOnUse"  gradientTransform="matrix(32.166,0,0,-32.166,1223.5194,8516.6758)"  r="0.68699998"  cy="260.28519"  cx="-34.4804"  id="SVGID_13_">       <stop  id="stop64"  style="stop-color:#AFCA0B"  offset="0" />        <stop  id="stop66"  style="stop-color:#AFCA0B"  offset="9.340660e-04" />        <stop  id="stop68"  style="stop-color:#95C11F"  offset="1" />       </radialGradient>       <rect  id="rect71"  clip-path="url(#SVGID_12_)"  height="12.7"  width="120"  class="st6"  y="131.37"  x="54.75"  style="fill:url(#SVGID_13_)" />      </g>     </g>    </g>  <g  id="g112"  transform="matrix(0.26458333,0,0,0.26458333,2.7061703,251.01424)">   <g  id="g110">    <g  id="g108">     <defs  id="defs101" />      <clipPath  id="SVGID_18_">      <use  height="100%"  width="100%"  y="0"  x="0"  xlink:href="#SVGID_17_"  style="overflow:visible"  id="use103" />      </clipPath>      <path  style="fill:#afca11"  class="st9"  d="m 178.26,124.27 h 0.33 c 0.18,0 0.3,0.03 0.37,0.08 0.07,0.05 0.11,0.17 0.11,0.36 0,0.19 -0.04,0.32 -0.13,0.39 -0.08,0.07 -0.23,0.1 -0.43,0.1 h -0.26 v -0.93 z m -0.38,2.21 h 0.38 v -0.96 h 0.29 c 0.07,0 0.13,0 0.16,-0.01 l 0.39,0.97 h 0.42 l -0.47,-1.05 c 0.24,-0.12 0.35,-0.36 0.35,-0.73 0,-0.51 -0.29,-0.77 -0.86,-0.77 h -0.69 v 2.55 z m -0.51,-2.61 c 0.19,-0.24 0.6,-0.36 1.22,-0.36 0.62,0 1.03,0.12 1.23,0.36 0.2,0.24 0.3,0.69 0.3,1.35 0,0.66 -0.1,1.1 -0.29,1.34 -0.2,0.24 -0.61,0.35 -1.23,0.35 -0.63,0 -1.03,-0.12 -1.22,-0.35 -0.19,-0.24 -0.28,-0.68 -0.28,-1.34 -0.02,-0.66 0.07,-1.11 0.27,-1.35 m -0.28,2.91 c 0.28,0.32 0.78,0.47 1.51,0.47 0.73,0 1.23,-0.16 1.51,-0.48 0.28,-0.32 0.41,-0.84 0.41,-1.56 0,-0.72 -0.14,-1.24 -0.42,-1.57 -0.28,-0.32 -0.78,-0.49 -1.5,-0.49 -0.72,0 -1.22,0.16 -1.5,0.49 -0.28,0.33 -0.42,0.85 -0.42,1.57 0,0.72 0.13,1.26 0.41,1.57"  clip-path="url(#SVGID_18_)"  id="path106" />     </g>    </g>   </g>  <g  id="g306"  transform="matrix(0.20975229,0,0,0.20975229,-0.91464975,280.66829)">  <path  id="path302"  d="M 75.97,50.42 C 73.55,43.59 66.92,32.31 58.25,23.24 49.53,14.05 36.85,3.55 28,3.88 21.38,4.14 17.63,8.63 14.27,15.22 c -0.31,0.84 0.08,1.56 1.43,1.56 h 22.08 c 0,0 1.64,-0.03 2.52,0.83 3.21,3.17 5.31,6.22 6.91,9.82 0.71,1.58 -0.09,2.72 -2.26,2.72 -3.99,0 -7.88,0.01 -9.62,0 -1.07,0 -1.86,0.94 -1.86,1.99 0,0.01 0,0.01 0,0.02 l -0.03,26.78 c 0,0 0.04,1.21 -1.49,1.94 -3.01,1.44 -7.64,2.75 -11.97,3.21 0,0 -1.34,0.26 -1.34,-1.42 V 32.11 c 0,0 0,0 0,0 0,-1.08 -0.84,-1.96 -1.91,-1.96 H 9.7 c 0,0 0,0 0,0 -0.96,0 -1.49,0.52 -1.79,1.29 -2.42,8.8 -3.67,18.31 -3.54,24.21 0.19,8.06 1.14,13.52 4.77,18.08 3.44,4.31 14.16,4.85 24.53,3.43 C 50.33,74.96 59.35,71.1 67.58,67 79.29,61.34 78.39,57.25 75.97,50.42"  class="st0"  style="fill:#ffffff" />   <path  id="path304"  d="m 67.57,66.99 c 2.47,-1.19 4.35,-2.31 5.8,-3.4 C 65.82,48.49 51.13,37.35 33.48,34.27 l -0.03,24.66 c 0,0 0.04,1.21 -1.49,1.94 -3.01,1.44 -7.64,2.75 -11.97,3.21 0,0 -1.34,0.26 -1.34,-1.42 V 33.62 c -4.09,0.35 -8.05,1.11 -11.84,2.27 -1.69,7.43 -2.55,14.85 -2.44,19.76 0.19,8.06 1.14,13.52 4.77,18.08 3.44,4.31 14.16,4.85 24.53,3.43 16.64,-2.21 25.66,-6.06 33.9,-10.17"  class="st1"  style="fill:#fff9d1" />  </g>  </g>  </g>  <style  type="text/css"  id="style10">  .st0{fill:#FFFFFF;}  .st1{clip-path:url(#SVGID_2_);}  .st2{clip-path:url(#SVGID_4_);}  .st3{clip-path:url(#SVGID_6_);fill:#647A84;}  .st4{clip-path:url(#SVGID_8_);}  .st5{clip-path:url(#SVGID_10_);fill:#AFCA0B;}  .st6{clip-path:url(#SVGID_12_);fill:url(#SVGID_13_);}  .st7{clip-path:url(#SVGID_2_);fill:#FFDE14;}  .st8{clip-path:url(#SVGID_15_);fill:url(#SVGID_16_);}  .st9{clip-path:url(#SVGID_18_);fill:#AFCA11;} </style>  <style  type="text/css"  id="style300">  .st0{fill:#FFFFFF;}  .st1{fill:#FFF9D1;} </style> </svg> 
</div>

<div id="inleyPreviewDiv" name="inleyPreviewDiv"></div>

<br><br>
<div id="guiElements" style="width: fit-content;">
	<div id="settings" >
		<div style="background-color: aliceblue;height: fit-content;clear: both; width: 100%;display: table;">
			<div style="float: left; padding-top: 15px; padding-bottom: 5px; display:table-cell; width:55%">
				<div style='font-weight: bold; margin-left: 15px; margin-bottom: 8px;'>Vitrine LxBxH Außenmaße</div>
				<div style="float: left; width:10px; margin:7px; margin-left: 35px; ">L: </div>            <input type="number" id="cabinetLength" name="cabinetLength" onchange="cabinetLengthChanged()" style="width: 60px;margin:5px">mm<br>
				<div style="float: left; width:10px; margin:6px; margin-left: 35px; clear:left;">B: </div> <input type="number" id="cabinetWidth"  name="cabinetWidth"  onchange="cabinetWidthChanged()"  style="width: 60px;margin:5px">mm<br>
				<div style="float: left; width:10px; margin:7px; margin-left: 35px; clear:left;">H: </div> <input type="number" id="cabinetHeight" name="cabinetHeight" onchange="cabinetHeightChanged()" style="width: 60px;margin:5px">mm
			</div>
			
			<div style="width:45%;float: left;display:table-cell">
				<div id="infoMessage" style="padding:10px;"></div>
			</div>
		</div>
		
		<div style="clear: left; background-color: blanchedalmond; width: 100%">
			<div style='font-weight: bold; padding: 15px;'>Auftragsnummer</div>
			<input type="text" id="auftragsNummer" name="auftragsNummer" onchange="auftragsnummerChanged()" maxlength="16" value="?" style="width: 120px;margin-bottom:15px; margin-left: 29px;">
		</div>

		<div style="background-color: #C49976; width: 100%;">
			<div style='font-weight: bold; margin-bottom: 8px;padding-top: 15px;padding-left: 15px;padding-right: 15px;'>Karton Templates - (üblicherweise vorhandene Schachteln)</div>
			
			<div style="width: 25px;float: left;margin-left:20px;">
				<input type="radio" id="box500x300x200"  name="boxTemplate" value="500x300x200"  onchange="boxTemplateChanged()" style="width: 15px;" checked="checked" >
			</div> 
			<div style="width: 35px;float: left;text-align: right; font-family: monospace;font-size: larger;">500</div> 
			<div style="width: 16px;float: left;text-align: center; font-family: monospace;font-size: larger;">*</div> 
			<div style="width: 35px;float: left;text-align: right; font-family: monospace;font-size: larger;">300</div> 
			<div style="width: 16px;float: left;text-align: center; font-family: monospace;font-size: larger;">*</div> 
			<div style="width: 35px;float: left;text-align: right; font-family: monospace;font-size: larger;">200</div> 
			<div style="width: 35px;float: left;text-align: left;margin-left: 3px; font-family: monospace;font-size: larger;">mm</div>
			<br>

			<div style="width: 25px;float: left;margin-left:20px;clear: left;">
				<input type="radio" id="box500x300x250"  name="boxTemplate" value="500x300x250"  onchange="boxTemplateChanged()" style="width: 15px;">
			</div> 
			<div style="width: 35px;float: left;text-align: right; font-family: monospace;font-size: larger;">500</div> 
			<div style="width: 16px;float: left;text-align: center; font-family: monospace;font-size: larger;">*</div> 
			<div style="width: 35px;float: left;text-align: right; font-family: monospace;font-size: larger;">300</div> 
			<div style="width: 16px;float: left;text-align: center; font-family: monospace;font-size: larger;">*</div> 
			<div style="width: 35px;float: left;text-align: right; font-family: monospace;font-size: larger;">250</div> 
			<div style="width: 35px;float: left;text-align: left;margin-left: 3px; font-family: monospace;font-size: larger;">mm</div>
			<br>

			<div style="width: 25px;float: left;margin-left:20px;clear: left;">
				<input type="radio" id="box500x300x300"  name="boxTemplate" value="500x300x300"  onchange="boxTemplateChanged()" style="width: 15px;">
			</div> 
			<div style="width: 35px;float: left;text-align: right; font-family: monospace;font-size: larger;">500</div> 
			<div style="width: 16px;float: left;text-align: center; font-family: monospace;font-size: larger;">*</div> 
			<div style="width: 35px;float: left;text-align: right; font-family: monospace;font-size: larger;">300</div> 
			<div style="width: 16px;float: left;text-align: center; font-family: monospace;font-size: larger;">*</div> 
			<div style="width: 35px;float: left;text-align: right; font-family: monospace;font-size: larger;">300</div> 
			<div style="width: 35px;float: left;text-align: left;margin-left: 3px; font-family: monospace;font-size: larger;">mm</div>
			<br>
			
			<div style="width: 25px;float: left;margin-left:20px;clear: left;">
				<input type="radio" id="box630x430x400"  name="boxTemplate" value="630x430x400"  onchange="boxTemplateChanged()" style="width: 15px">
			</div> 
			<div style="width: 35px;float: left;text-align: right; font-family: monospace;font-size: larger;">630</div> 
			<div style="width: 16px;float: left;text-align: center; font-family: monospace;font-size: larger;">*</div> 
			<div style="width: 35px;float: left;text-align: right; font-family: monospace;font-size: larger;">430</div> 
			<div style="width: 16px;float: left;text-align: center; font-family: monospace;font-size: larger;">*</div> 
			<div style="width: 35px;float: left;text-align: right; font-family: monospace;font-size: larger;">400</div> 
			<div style="width: 35px;float: left;text-align: left;margin-left: 3px; font-family: monospace;font-size: larger;">mm</div>
			<br>
			
			<div style="width: 25px;float: left;margin-left:20px;clear: left;">
				<input type="radio" id="box786x586x580"  name="boxTemplate" value="786x586x580"  onchange="boxTemplateChanged()" style="width: 15px">
			</div> 
			<div style="width: 35px;float: left;text-align: right; font-family: monospace;font-size: larger;">786</div> 
			<div style="width: 16px;float: left;text-align: center; font-family: monospace;font-size: larger;">*</div> 
			<div style="width: 35px;float: left;text-align: right; font-family: monospace;font-size: larger;">586</div> 
			<div style="width: 16px;float: left;text-align: center; font-family: monospace;font-size: larger;">*</div> 
			<div style="width: 35px;float: left;text-align: right; font-family: monospace;font-size: larger;">500</div> 
			<div style="width: 35px;float: left;text-align: left;margin-left: 3px; font-family: monospace;font-size: larger;">mm</div>
			<br>

			<div style="width: 25px;float: left;margin-left:20px;clear: left;">
				<input type="radio" id="box1000x700x500" name="boxTemplate" value="1000x700x500" onchange="boxTemplateChanged()" style="width: 15px">
			</div> 
			<div style="width: 35px;float: left;text-align: right; font-family: monospace;font-size: larger;">1000</div> 
			<div style="width: 16px;float: left;text-align: center; font-family: monospace;font-size: larger;">*</div> 
			<div style="width: 35px;float: left;text-align: right; font-family: monospace;font-size: larger;">700</div> 
			<div style="width: 16px;float: left;text-align: center; font-family: monospace;font-size: larger;">*</div> 
			<div style="width: 35px;float: left;text-align: right; font-family: monospace;font-size: larger;">500</div> 
			<div style="width: 35px;float: left;text-align: left;margin-left: 3px; font-family: monospace;font-size: larger;">mm</div>
			<br>
			
			<br>
			<div style='font-weight: bold; margin-bottom: 8px;padding-top: 15px;padding-left: 15px;'>Karton LxBxH Innenmaß</div>
			<div style="float: left; width:10px; padding-left: 20px;margin:7px">L: </div>              <input type="number" id="boxLength" name="boxLength" onchange="boxLengthChanged()" style="width: 60px;margin:5px">mm<br> 
			<div style="float: left; width:10px; padding-left: 20px;margin:6px; clear:left;">B: </div> <input type="number" id="boxWidth"  name="boxWidth"  onchange="boxWidthChanged()"  style="width: 60px;margin:5px">mm <br> 
			<div style="float: left; width:10px; padding-left: 20px;margin:7px; clear:left;">H: </div> <input type="number" id="boxHeight" name="boxHeight" onchange="boxHeightChanged()" style="width: 60px;margin:5px">mm
		</div>
		<div style="background-color: blanchedalmond; width: 100%;">
			<div style='font-weight: bold;padding-top: 15px;padding-left: 15px;'>Inlay ohne Karton Vitrine + 40mm Schutz pro Seite</div>
			<div style="padding: 15px;"><button id="downloadInlayOhneKarton" onclick="defineInlayOhneKarton()" title="definiert die maße des Kartons in einer größe, die 40 mm größer ist als die Vitrine,\nfür nur Kantenschutz z.B.: für Botendienst"> Inlay ohne Karton</button></div>
		</div>
	</div>
	
	<div id="exportButtons" style="background-color: cornsilk; width: 100%; margin-top:10px">
		<div style="padding: 15px;">
			<button id="downloadDXF" onclick="downloadDXF()" title="Generiere und download eine DXF Datei"> DXF Download</button>
			<button id="downloadSVG" onclick="downloadSVG()" title="Generiere und download eine SVG Datei"> SVG Download</button>
			<button id="sayHello" onclick="alert('Hello')" title="Say Hello"> Say Hello</button>
		</div>
	</div>
</div>
<script type="text/javascript">
var makerjs = require('makerjs');
var font;
var model;
var metadata = {
	// cabinet = Vitrine

	//cabinetLength : 800, //359,
	//cabinetWidth : 700, //159,
	//cabinetHeight : 600, //124,


	cabinetLength : 359,
	cabinetWidth : 159,
	cabinetHeight : 124,

	//cabinetLength : 900,
	//cabinetWidth : 800,
	//cabinetHeight : 420,

	// Box = Karton
	boxLength : 1000, //500,
	boxWidth :  780, //900, //780, //300,
	boxHeight : 680, //200,

	largeRadius : 5,
	smallRadius : 0.99,

	minDeltaBoxCabinet : 60,
};

function breiteMittlererLappenLinksRechts() {
	return (metadata.boxLength - metadata.cabinetLength - 16) / 2;
}

function kartonbreiteMinusLappenLinksRechts() {
	return metadata.cabinetWidth + 12;
}

function obenUntenFetteLasche() {
	return determineTotalHeight() * 0.18;
}

function innenLinksRechtsLaschenHoehe() {
	return determineTotalHeight() * 0.34;
}

function isCartonWidtherThanBox() {
	return metadata.boxWidth > (breiteMittlererLappenLinksRechts() * 2 + kartonbreiteMinusLappenLinksRechts());
}

function determineTotalWidth() {
	return Math.max(metadata.boxWidth, breiteMittlererLappenLinksRechts() * 2 + kartonbreiteMinusLappenLinksRechts());
}

function determineTotalHeight() {
	return metadata.boxHeight;
}

function determineObenUntenLaschenHeight() {
	return metadata.boxWidth * 0.1;
}

function determineLinksRechtsLascheBreite() {
	return metadata.boxLength * 0.1
}

function determineEini() {
	return isCartonWidtherThanBox() ? ((metadata.boxWidth - kartonbreiteMinusLappenLinksRechts()) / 2) : breiteMittlererLappenLinksRechts();
}

function determineOba() {
	return ((determineTotalHeight() - (metadata.cabinetHeight + 8 )) / 2) + determineObenUntenLaschenHeight();
}

function einiBisObenuntenInnenLasche() {
		return determineEini() + determineLinksRechtsLascheBreite() + 15;
}

document.addEventListener("DOMContentLoaded", function(event) { 
	let thisYear = new Date();
	document.getElementById('auftragsNummer').value = "K" + (thisYear.getYear() % 100);
	opentype.load("https://fonts.cdnfonts.com/s/18519/Lovelo-Black.woff", function(err, fontParam) {
		if (err) {
			alert("Error: " + err);
		} else {
			font = fontParam;
			checkBoxTemplate();
			model = createModel();
			drawPreview();
			document.getElementById('cabinetLength').focus();
		}
	});
});

function createModel() {
	let obaLinkRechts = (metadata.boxHeight - innenLinksRechtsLaschenHoehe()) / 2;

	let perforationBorderLeftRight = (metadata.boxHeight - innenLinksRechtsLaschenHoehe() - obenUntenFetteLasche() - obenUntenFetteLasche() - 2 - 2 - 5 - 5) / 4;

	let lineLeftUpperX = (determineTotalWidth() - metadata.boxWidth ) / 2;

	let leftXOfFettenSeitlichenMittlerenLappen = isCartonWidtherThanBox() ? determineEini() - breiteMittlererLappenLinksRechts() : 0;

	var modelLocal = {
	  paths: {

		// Main Border
		lineBottom: new makerjs.paths.Line([lineLeftUpperX, 0], [determineTotalWidth() - lineLeftUpperX, 0]),
		lineTop: new makerjs.paths.Line([lineLeftUpperX, determineTotalHeight()], [determineTotalWidth() - lineLeftUpperX, determineTotalHeight()]),

		lineLeftUpper:  new makerjs.paths.Line([lineLeftUpperX, determineTotalHeight()], [lineLeftUpperX, determineTotalHeight() - obenUntenFetteLasche()]),
		lineRightUpper:  new makerjs.paths.Line([determineTotalWidth() - lineLeftUpperX, determineTotalHeight()], [determineTotalWidth() - lineLeftUpperX, determineTotalHeight() - obenUntenFetteLasche()]),
		lineLeftLower:  new makerjs.paths.Line([lineLeftUpperX, 0], [lineLeftUpperX, obenUntenFetteLasche()]),
		lineRightLower:  new makerjs.paths.Line([determineTotalWidth() - lineLeftUpperX, 0], [determineTotalWidth() - lineLeftUpperX, obenUntenFetteLasche()]),

		schnittEiniLinksOben : new makerjs.paths.Line([lineLeftUpperX, determineTotalHeight() - obenUntenFetteLasche()], [ determineEini() , determineTotalHeight() - obenUntenFetteLasche()]),
		schnittEiniLinksUnten : new makerjs.paths.Line([lineLeftUpperX, obenUntenFetteLasche()], [ determineEini() , obenUntenFetteLasche()]),
		schnittEiniRechtsOben : new makerjs.paths.Line([determineTotalWidth() - lineLeftUpperX, determineTotalHeight() - obenUntenFetteLasche()], [ determineTotalWidth() - determineEini(), determineTotalHeight() - obenUntenFetteLasche()]),
		schnittEiniRechtsUnten : new makerjs.paths.Line([determineTotalWidth() - lineLeftUpperX, obenUntenFetteLasche()], [ determineTotalWidth() - determineEini() , obenUntenFetteLasche()]),

		schnittEiniLinksObenToBack : new makerjs.paths.Line([determineEini(), determineTotalHeight() - obenUntenFetteLasche()], [ determineEini() , determineTotalHeight() - obenUntenFetteLasche() - 2]),
		schnittEiniLinksUntenToBack : new makerjs.paths.Line([determineEini(), obenUntenFetteLasche()], [ determineEini() , obenUntenFetteLasche() + 2]),
		schnittEiniRechtsObenToBack : new makerjs.paths.Line([determineTotalWidth() - determineEini(), determineTotalHeight() - obenUntenFetteLasche()], [ determineTotalWidth() - determineEini(), determineTotalHeight() - obenUntenFetteLasche() - 2]),
		schnittEiniRechtsUntenToBack : new makerjs.paths.Line([determineTotalWidth() - determineEini(), obenUntenFetteLasche()], [ determineTotalWidth() - determineEini() , obenUntenFetteLasche() + 2]),

		schnittEiniLinksObenBack : new makerjs.paths.Line([leftXOfFettenSeitlichenMittlerenLappen, determineTotalHeight() - obenUntenFetteLasche() - 2], [ determineEini() , determineTotalHeight() - obenUntenFetteLasche() - 2]),
		schnittEiniLinksUntenBack : new makerjs.paths.Line([leftXOfFettenSeitlichenMittlerenLappen, obenUntenFetteLasche() + 2], [ determineEini() , obenUntenFetteLasche() + 2]),
		schnittEiniRechtsObenBack : new makerjs.paths.Line([determineTotalWidth() - (leftXOfFettenSeitlichenMittlerenLappen), determineTotalHeight() - obenUntenFetteLasche() - 2], [ determineTotalWidth() - determineEini(), determineTotalHeight() - obenUntenFetteLasche() - 2]),
		schnittEiniRechtsUntenBack : new makerjs.paths.Line([determineTotalWidth() - (leftXOfFettenSeitlichenMittlerenLappen), obenUntenFetteLasche() + 2], [ determineTotalWidth() - determineEini() , obenUntenFetteLasche() + 2]),

		lineLeftMiddle : new makerjs.paths.Line([leftXOfFettenSeitlichenMittlerenLappen, determineTotalHeight() - obenUntenFetteLasche() - 2], [ leftXOfFettenSeitlichenMittlerenLappen , obenUntenFetteLasche() + 2]),
		lineRightMiddle : new makerjs.paths.Line([determineTotalWidth() - (leftXOfFettenSeitlichenMittlerenLappen), determineTotalHeight() - obenUntenFetteLasche() - 2], [ determineTotalWidth() - (leftXOfFettenSeitlichenMittlerenLappen) , obenUntenFetteLasche() + 2]),


		// Other Parts
		leftMiddlePartUpper : new makerjs.paths.Line([determineEini(), determineTotalHeight() - obaLinkRechts], [ determineEini() + determineLinksRechtsLascheBreite() , determineTotalHeight() - obaLinkRechts]),
		leftMiddlePartLower : new makerjs.paths.Line([determineEini(), obaLinkRechts], [ determineEini() + determineLinksRechtsLascheBreite() , obaLinkRechts]),
		leftMiddlePartMiddle : new makerjs.paths.Line([determineEini() + determineLinksRechtsLascheBreite(), determineTotalHeight() - obaLinkRechts], [ determineEini() + determineLinksRechtsLascheBreite() , obaLinkRechts]),

		rightMiddlePartUpper : new makerjs.paths.Line([determineTotalWidth() - determineEini(), determineTotalHeight() - obaLinkRechts], [ determineTotalWidth() - determineEini() - determineLinksRechtsLascheBreite() , determineTotalHeight() - obaLinkRechts]),
		rightMiddlePartLower : new makerjs.paths.Line([determineTotalWidth() - determineEini(), obaLinkRechts], [ determineTotalWidth() - determineEini() - determineLinksRechtsLascheBreite() , obaLinkRechts]),
		rightMiddlePartMiddle : new makerjs.paths.Line([determineTotalWidth() - determineEini() - determineLinksRechtsLascheBreite(), determineTotalHeight() - obaLinkRechts], [ determineTotalWidth() - determineEini() - determineLinksRechtsLascheBreite() , obaLinkRechts]),
	  },
	  models: {
	  
	  }
	};

	createLogo(modelLocal);

	modelLocal.units = makerjs.unitType.Millimeter;

	if (((metadata.boxWidth - determineEini() - determineLinksRechtsLascheBreite() + 15) - (einiBisObenuntenInnenLasche())) >= 260) {
		if (((metadata.boxWidth - determineEini() - determineLinksRechtsLascheBreite() + 15) - (einiBisObenuntenInnenLasche())) >= 560) {
			// 3 Spalten
			createColumnSpitAndPerforation3Columns(modelLocal);
		} else {
			// 2 Spalten
			createColumnSpitAndPerforation2Columns(modelLocal);
		}
	} else {
		// 1 Spalte
		createPerforation1Column(modelLocal);
	}

	createRadius(modelLocal);

	createVerticalPerforation(modelLocal);

	return modelLocal;
}

function createLogo(modelLocal) {
	let logoHasPercentOfFreeSpaceHorizontal = 266 / (determineTotalWidth() - ((determineEini() + determineLinksRechtsLascheBreite()) * 2));
    let scalefactor = 1.0 / logoHasPercentOfFreeSpaceHorizontal * 0.50; // logo should have 30 Percent of free Space 

	// In jeder Form
	modelLocal.models["tdLogoInJederForm"] = makerjs.importer.fromSVGPathData("M163.69,151.53c-0.88,0-1.9,0.25-3.08,0.74v-0.68h-1.79v14.98h1.87v-12.61c0.96-0.46,1.86-0.68,2.68-0.68 c1.3,0,1.95,0.64,1.95,1.92v11.37h1.87v-11.37c0-0.44-0.04-0.79-0.13-1.05c0.95-0.58,1.9-0.87,2.84-0.87 c1.28,0,1.92,0.64,1.92,1.92v11.37h1.9V155c0-1.11-0.32-1.96-0.95-2.57c-0.63-0.61-1.55-0.91-2.74-0.91 c-1.19,0-2.4,0.36-3.61,1.08C165.79,151.89,164.88,151.53,163.69,151.53 M155.13,151.63c-0.18,0.05-0.31,0.09-0.41,0.12 c-0.1,0.03-0.24,0.09-0.42,0.2c-0.18,0.11-0.3,0.17-0.34,0.2c-0.04,0.03-0.18,0.12-0.4,0.28c-0.22,0.16-0.36,0.25-0.41,0.29 v-1.13h-1.79v14.98h1.87V154.5c0.53-0.37,0.87-0.61,1.03-0.71c0.51-0.33,1.08-0.5,1.71-0.5h0.9v-1.79h-0.66 C155.75,151.5,155.39,151.55,155.13,151.63 M139.47,162.74c0,1.25,0.35,2.24,1.05,2.97c0.7,0.74,1.77,1.11,3.21,1.11 c1.44,0,2.51-0.37,3.21-1.11c0.7-0.74,1.05-1.73,1.05-2.97v-7.35c0-1.25-0.35-2.24-1.05-2.97c-0.7-0.74-1.77-1.11-3.21-1.11 c-1.44,0-2.51,0.37-3.21,1.11c-0.7,0.74-1.05,1.73-1.05,2.97V162.74z M146.15,162.72c0,1.65-0.81,2.47-2.42,2.47 c-1.62,0-2.42-0.82-2.42-2.47v-7.29c0-1.63,0.81-2.45,2.42-2.45c1.61,0,2.42,0.82,2.42,2.45V162.72z M129.96,166.56h1.87v-7.71 h5.29v-1.69h-5.29v-6.63h5.58v-1.66h-7.45V166.56z M121.3,151.63c-0.18,0.05-0.31,0.09-0.41,0.12c-0.1,0.03-0.24,0.09-0.42,0.2 c-0.18,0.11-0.3,0.17-0.34,0.2c-0.04,0.03-0.18,0.12-0.4,0.28c-0.22,0.16-0.36,0.25-0.41,0.29v-1.13h-1.79v14.98h1.87V154.5 c0.53-0.37,0.87-0.61,1.03-0.71c0.51-0.33,1.08-0.5,1.71-0.5h0.9v-1.79h-0.66C121.93,151.5,121.57,151.55,121.3,151.63 M107.64,155.42c0-1.65,0.82-2.47,2.45-2.47c1.63,0,2.45,0.83,2.45,2.47v3.03h-4.9V155.42z M110.75,166.69 c1.21,0,2.25-0.14,3.13-0.42v-1.74c-1.11,0.32-2.18,0.47-3.21,0.47c-1.04,0-1.8-0.19-2.29-0.58c-0.49-0.39-0.74-0.97-0.74-1.76 V160h6.69v-4.58c0-1.25-0.35-2.24-1.04-2.99c-0.69-0.75-1.76-1.12-3.2-1.12c-1.44,0-2.51,0.37-3.22,1.12 c-0.71,0.75-1.07,1.74-1.07,2.99v7.32C105.8,165.38,107.45,166.69,110.75,166.69 M100.56,151.58h-2.47 c-1.23,0-2.21,0.35-2.95,1.04c-0.74,0.69-1.11,1.66-1.11,2.91v7.34c0,1.21,0.31,2.14,0.94,2.79c0.62,0.65,1.52,0.97,2.7,0.97 c1.18,0,2.16-0.32,2.95-0.95v0.87h1.82l0.44-18.95H101L100.56,151.58z M100.56,164.06c-0.63,0.6-1.47,0.9-2.53,0.9 c-1.42,0-2.13-0.74-2.13-2.21v-7.19c0-1.51,0.83-2.26,2.5-2.26h2.16V164.06z M84.39,155.42c0-1.65,0.82-2.47,2.45-2.47 s2.45,0.83,2.45,2.47v3.03h-4.9V155.42z M87.5,166.69c1.21,0,2.25-0.14,3.13-0.42v-1.74c-1.11,0.32-2.18,0.47-3.21,0.47 c-1.04,0-1.8-0.19-2.29-0.58c-0.49-0.39-0.74-0.97-0.74-1.76V160h6.69v-4.58c0-1.25-0.35-2.24-1.04-2.99 c-0.69-0.75-1.76-1.12-3.2-1.12c-1.44,0-2.51,0.37-3.22,1.12c-0.71,0.75-1.07,1.74-1.07,2.99v7.32 C82.55,165.38,84.2,166.69,87.5,166.69 M77.31,166.8c0,0.72-0.14,1.24-0.42,1.55c-0.28,0.32-0.73,0.47-1.34,0.47 c-0.19,0-0.43-0.02-0.71-0.05v1.68c0.26,0.05,0.52,0.08,0.76,0.08c1.18,0,2.07-0.33,2.67-0.99c0.61-0.66,0.91-1.58,0.91-2.75 v-15.11h-1.87V166.8z M79.39,148.68c0-0.81-0.38-1.21-1.14-1.21s-1.15,0.4-1.15,1.21c0,0.81,0.38,1.21,1.15,1.21 S79.39,149.49,79.39,148.68 M62.25,151.58h-1.79v14.98h1.87v-12.61c0.97-0.46,1.86-0.68,2.69-0.68c1.3,0,1.95,0.64,1.95,1.92 v11.37h1.87V155c0-1.11-0.32-1.96-0.95-2.57s-1.43-0.91-2.41-0.91s-2.05,0.25-3.22,0.74V151.58z M54.96,166.56h1.87v-14.87 h-1.87V166.56z M57.04,148.68c0-0.81-0.38-1.21-1.14-1.21c-0.76,0-1.15,0.4-1.15,1.21c0,0.81,0.38,1.21,1.15,1.21 C56.66,149.9,57.04,149.49,57.04,148.68");
	makerjs.model.scale(modelLocal.models.tdLogoInJederForm, scalefactor);
	makerjs.model.center(modelLocal.models.tdLogoInJederForm);

	// Plexiglas
	modelLocal.models["tdLogoPlexiGlas"] = makerjs.importer.fromSVGPathData("M162.28,129.36c0,2.03,1.01,3.61,3.02,4.73l3.33,1.8c0.54,0.29,0.91,0.56,1.1,0.79c0.2,0.24,0.3,0.6,0.3,1.07v0.47c0,1.02-0.89,1.52-2.67,1.52c-1.78,0-3.38-0.3-4.79-0.9v4.51c1.14,0.48,2.83,0.72,5.08,0.72s4-0.45,5.24-1.35c1.24-0.9,1.87-2.19,1.87-3.87v-1.93c0-1.87-0.85-3.26-2.55-4.2l-3.55-1.99c-0.66-0.35-1.09-0.67-1.29-0.95c-0.2-0.28-0.3-0.71-0.3-1.29v-0.47c0-0.48,0.14-0.85,0.44-1.1c0.29-0.26,0.85-0.39,1.68-0.39c1.62,0,3.06,0.27,4.32,0.81v-4.48c-1.04-0.44-2.61-0.65-4.71-0.65c-2.1,0-3.72,0.45-4.84,1.35c-1.12,0.9-1.68,2.18-1.68,3.84V129.36z M152.94,126.65l1.49,8.33h-2.92L152.94,126.65z M160.46,143.91l-4.17-21.55h-6.5l-4.23,21.55h4.45l0.84-4.98h4.26l0.9,4.98H160.46zM134.19,143.91h10.48v-3.92h-5.75v-17.63h-4.73V143.91z M118.72,138.84c0,1.66,0.58,2.94,1.73,3.86c1.15,0.91,2.84,1.37,5.05,1.37c2.22,0,4.14-0.44,5.75-1.31v-10.42h-4.54v7.28c-0.33,0.17-0.8,0.25-1.41,0.25c-0.61,0-1.07-0.13-1.38-0.39c-0.31-0.26-0.47-0.64-0.47-1.14v-10.23c0-0.5,0.22-0.89,0.65-1.18c0.43-0.29,1.28-0.43,2.52-0.43c1.24,0,2.49,0.24,3.73,0.72v-4.42c-1.18-0.39-2.64-0.59-4.39-0.59c-2.32,0-4.11,0.48-5.36,1.45c-1.25,0.96-1.88,2.26-1.88,3.9V138.84z M110.68,143.91h4.73v-21.55h-4.73V143.91z M101.5,128.3l-2.15-5.94h-5.04l4.6,10.82l-4.6,10.73h5.07l2.11-5.88l1.99,5.88h5.07l-4.63-10.73l4.63-10.82h-5.04L101.5,128.3z M81.37,143.91h10.92v-4.04h-6.25v-4.85h5.41v-4.04h-5.41v-4.57h6.25v-4.04H81.37V143.91z M69.41,143.91h10.48v-3.92h-5.75v-17.63h-4.73V143.91z M54.75,143.91h4.7v-6.22h2.33c1.68,0,3-0.4,3.96-1.21c0.96-0.81,1.45-2,1.45-3.58v-5.75c0-1.57-0.48-2.77-1.45-3.58c-0.96-0.81-2.29-1.21-3.96-1.21h-7.03V143.91z M62.53,132.34c0,0.87-0.45,1.31-1.34,1.31h-1.74v-7.25h1.74c0.89,0,1.34,0.43,1.34,1.31V132.34z");
	makerjs.model.scale(modelLocal.models.tdLogoPlexiGlas, scalefactor);
	makerjs.model.center(modelLocal.models.tdLogoPlexiGlas);

	// Token mit T Oben
	modelLocal.models["tdLogoTokenOben"] = makerjs.importer.fromSVGPathData("M53.11,77.58h-4.96c-0.67,0-1.05,0.36-1.26,0.91c-0.29,1.04-0.55,2.09-0.79,3.15c0,0,0.01,0,0.01,0c2.67-0.82,5.46-1.35,8.35-1.6v-1.06v0C54.46,78.2,53.87,77.58,53.11,77.58 M94.9,91.88c-1.7-4.82-6.38-12.77-12.5-19.17c-6.15-6.48-15.1-13.89-21.33-13.66c-4.67,0.18-7.32,3.35-9.68,8c-0.22,0.59,0.05,1.1,1.01,1.1h15.57c0,0,1.16-0.02,1.78,0.59c2.26,2.23,3.74,4.38,4.88,6.92c0.5,1.11-0.06,1.92-1.59,1.92c-2.81,0-5.56,0-6.78,0c-0.75,0-1.31,0.66-1.31,1.4c0,0,0,0.01,0,0.01l0,1.5c12.45,2.17,22.82,10.02,28.14,20.68c0,0,0,0.01,0,0.01C96.92,98.28,96.24,95.68,94.9,91.88");
	makerjs.model.scale(modelLocal.models.tdLogoTokenOben, scalefactor);
	makerjs.model.center(modelLocal.models.tdLogoTokenOben);

	// Token mit T unten
	modelLocal.models["tdLogoTokenUnten"] = makerjs.importer.fromSVGPathData("M46.11,81.62c-1.19,5.24-1.8,10.47-1.72,13.94c0.14,5.69,0.81,9.54,3.36,12.75c2.43,3.04,9.99,3.42,17.3,2.42c11.75-1.55,18.11-4.27,23.92-7.17c1.74-0.84,3.07-1.63,4.09-2.4c-5.32-10.65-15.69-18.51-28.14-20.68L64.9,97.88c0,0,0.03,0.85-1.05,1.37c-2.12,1.02-5.39,1.94-8.44,2.27c0,0-0.94,0.18-0.94-1V80.02C51.57,80.27,48.78,80.81,46.11,81.62");
	makerjs.model.scale(modelLocal.models.tdLogoTokenUnten, scalefactor);
	makerjs.model.center(modelLocal.models.tdLogoTokenUnten);

	// R
	modelLocal.models["tdLogoRegisteredTradeMark"] = makerjs.importer.fromSVGPathData("M178.26,124.27h0.33c0.18,0,0.3,0.03,0.37,0.08c0.07,0.05,0.11,0.17,0.11,0.36c0,0.19-0.04,0.32-0.13,0.39c-0.08,0.07-0.23,0.1-0.43,0.1h-0.26V124.27z M177.88,126.48h0.38v-0.96h0.29c0.07,0,0.13,0,0.16-0.01l0.39,0.97h0.42l-0.47-1.05c0.24-0.12,0.35-0.36,0.35-0.73c0-0.51-0.29-0.77-0.86-0.77h-0.69V126.48z M177.37,123.87c0.19-0.24,0.6-0.36,1.22-0.36c0.62,0,1.03,0.12,1.23,0.36s0.3,0.69,0.3,1.35c0,0.66-0.1,1.1-0.29,1.34c-0.2,0.24-0.61,0.35-1.23,0.35c-0.63,0-1.03-0.12-1.22-0.35c-0.19-0.24-0.28-0.68-0.28-1.34C177.08,124.56,177.17,124.11,177.37,123.87 M177.09,126.78c0.28,0.32,0.78,0.47,1.51,0.47c0.73,0,1.23-0.16,1.51-0.48c0.28-0.32,0.41-0.84,0.41-1.56c0-0.72-0.14-1.24-0.42-1.57c-0.28-0.32-0.78-0.49-1.5-0.49c-0.72,0-1.22,0.16-1.5,0.49c-0.28,0.33-0.42,0.85-0.42,1.57S176.81,126.47,177.09,126.78");
	makerjs.model.scale(modelLocal.models.tdLogoRegisteredTradeMark, scalefactor);
	makerjs.model.center(modelLocal.models.tdLogoRegisteredTradeMark);

	// Transparent design
	modelLocal.models["tdLogoTransparentDesign"] = makerjs.importer.fromSVGPathData("M260.96,17.67h-5.25V39.5h5.59V23.18c0.54-0.32,1.13-0.48,1.78-0.48c0.64,0,0.96,0.3,0.96,0.89V39.5h5.66V22.22 c0-1.55-0.43-2.72-1.28-3.5c-0.85-0.78-1.98-1.17-3.39-1.17c-1.41,0-2.76,0.36-4.07,1.07V17.67z M243.57,27.7 c-1.11,0-1.67-0.48-1.67-1.44v-3.11c0-0.96,0.56-1.44,1.67-1.44c1.11,0,1.67,0.48,1.67,1.44v3.11 C245.23,27.22,244.68,27.7,243.57,27.7 M252.19,15.12h-0.59c-2.1,0-3.43,0.95-4,2.85c-1.09-0.44-2.43-0.67-4.03-0.67 c-2.42,0-4.23,0.51-5.42,1.52c-1.2,1.01-1.79,2.44-1.79,4.29v3.18c0,2.76,1.27,4.56,3.81,5.4c-1.38,0.25-2.07,1.15-2.07,2.7 v0.59c0,1.16,0.44,2,1.33,2.52c0.89,0.52,2.22,0.78,4,0.78h2.26c0.84,0,1.26,0.25,1.26,0.74v0.18c0,0.42-0.24,0.72-0.72,0.91 c-0.48,0.19-1.36,0.28-2.65,0.28h-0.78c-1.33,0-2.62-0.2-3.85-0.61c-1.23-0.41-2.2-0.88-2.89-1.42v5.07 c0.59,0.42,1.49,0.8,2.7,1.13c1.21,0.33,2.6,0.5,4.18,0.5h1.37c2.59,0,4.54-0.5,5.85-1.5c1.31-1,1.96-2.4,1.96-4.2v-0.93 c0-1.6-0.46-2.78-1.39-3.53c-0.93-0.75-2.34-1.13-4.24-1.13h-2.04c-0.57,0-0.96-0.06-1.17-0.17c-0.21-0.11-0.31-0.33-0.31-0.65 c0-0.54,0.32-0.81,0.96-0.81c2.29-0.05,4.01-0.58,5.14-1.59c1.13-1.01,1.7-2.43,1.7-4.26v-3.18c0-1.18-0.23-2.17-0.7-2.96 c0.35-0.05,0.62-0.07,0.81-0.07h1.3V15.12z M226.77,39.5h5.59V18.26h-5.59V39.5z M232.66,14.14c0-1.94-1.03-2.9-3.09-2.9 c-2.06,0-3.09,0.97-3.09,2.9c0,1.94,1.03,2.9,3.09,2.9C231.63,17.04,232.66,16.07,232.66,14.14 M210.19,24.41 c0,1.97,0.88,3.55,2.63,4.74c2.54,1.68,3.96,2.66,4.26,2.96c0.25,0.22,0.37,0.52,0.37,0.89v0.33c0,0.47-0.23,0.82-0.68,1.05 c-0.46,0.23-1.39,0.35-2.79,0.35c-1.41,0-2.69-0.17-3.85-0.52v5c1.33,0.32,2.94,0.48,4.81,0.48c5.38,0,8.07-2.05,8.07-6.14 v-0.93c0-1.11-0.25-2.04-0.76-2.78c-0.51-0.74-1.23-1.42-2.16-2.04l-3-2c-0.62-0.42-1.02-0.73-1.2-0.94 c-0.18-0.21-0.28-0.46-0.28-0.76v-0.3c0-0.49,0.18-0.85,0.54-1.07c0.36-0.22,1.2-0.33,2.52-0.33c1.32,0,2.53,0.18,3.65,0.56 v-4.92c-1.18-0.37-2.69-0.56-4.51-0.56c-2.66,0-4.6,0.5-5.79,1.5c-1.2,1-1.79,2.49-1.79,4.46V24.41z M198.35,23.33 c0-0.94,0.54-1.41,1.63-1.41c1.09,0,1.63,0.47,1.63,1.41v3.18h-3.26V23.33z M200.68,39.73c1.97,0,3.82-0.23,5.55-0.7v-4.88 c-1.65,0.49-3.18,0.74-4.57,0.74c-1.39,0-2.29-0.15-2.7-0.46c-0.41-0.31-0.61-0.83-0.61-1.57v-2.07h8.4v-7.51 c0-3.97-2.26-5.96-6.77-5.96c-2.34,0-4.1,0.52-5.26,1.57c-1.16,1.05-1.74,2.51-1.74,4.39v10.03 C192.98,37.58,195.55,39.73,200.68,39.73 M183.25,17.67h-1.63c-2.32,0-4.05,0.59-5.18,1.76c-1.13,1.17-1.7,2.79-1.7,4.87v10.32 c0,1.58,0.41,2.81,1.22,3.7c0.81,0.89,2.04,1.33,3.68,1.33c1.64,0,2.9-0.57,3.79-1.7v1.55h5.44V11.86h-5.62V17.67z M183.28,34.14c-0.49,0.3-1.11,0.44-1.85,0.44c-0.74,0-1.11-0.32-1.11-0.96v-9.14c0-1.23,0.58-1.85,1.74-1.85h1.22V34.14z M158.27,14.64l-0.74,3.81h-2.41v2.33h2.29v14.17c0,3.13,1.65,4.7,4.96,4.7c0.86,0,1.79-0.12,2.78-0.37v-2.41 c-0.81,0.27-1.65,0.41-2.52,0.41c-0.86,0-1.51-0.19-1.92-0.57c-0.42-0.38-0.63-1-0.63-1.87V20.78h4.7v-2.33h-4.7v-3.81H158.27z M142.58,18.45h-2.52V39.5h2.63V21.78c1.36-0.64,2.61-0.96,3.77-0.96c1.83,0,2.74,0.9,2.74,2.7V39.5h2.63V23.26 c0-1.55-0.44-2.76-1.33-3.61c-0.89-0.85-2.02-1.28-3.39-1.28c-1.37,0-2.88,0.35-4.53,1.04V18.45z M125.41,23.85 c0-2.32,1.15-3.48,3.44-3.48c2.29,0,3.44,1.16,3.44,3.48v4.26h-6.88V23.85z M129.77,39.69c1.7,0,3.17-0.2,4.4-0.59v-2.44 c-1.55,0.44-3.06,0.67-4.51,0.67c-1.46,0-2.53-0.27-3.22-0.81c-0.69-0.54-1.04-1.37-1.04-2.48v-3.74h9.4v-6.44 c0-1.75-0.49-3.15-1.46-4.2c-0.97-1.05-2.47-1.57-4.5-1.57c-2.02,0-3.53,0.52-4.53,1.57c-1,1.05-1.5,2.45-1.5,4.2v10.29 C122.82,37.84,125.13,39.69,129.77,39.69 M117.27,18.52c-0.25,0.07-0.44,0.13-0.57,0.17c-0.14,0.04-0.33,0.13-0.59,0.28 c-0.26,0.15-0.42,0.24-0.48,0.28c-0.06,0.04-0.25,0.17-0.56,0.39c-0.31,0.22-0.5,0.36-0.57,0.41v-1.59h-2.52V39.5h2.63V22.56 c0.74-0.52,1.22-0.85,1.44-1c0.72-0.47,1.52-0.7,2.41-0.7h1.26v-2.52h-0.93C118.14,18.34,117.64,18.4,117.27,18.52 M95.14,18.97 v2.48c1.38-0.49,2.89-0.74,4.53-0.74c1.64,0,2.73,0.23,3.28,0.7c0.54,0.47,0.83,1.21,0.85,2.22v3.22l-5.18,1.44 c-2.99,0.84-4.48,2.54-4.48,5.11v1.18c0,3.38,1.71,5.07,5.14,5.07c1.75,0,3.26-0.56,4.51-1.67v1.52h2.52V23.63 c0-3.58-2.1-5.37-6.29-5.37C98.17,18.26,96.54,18.5,95.14,18.97 M97.28,31.51c0.39-0.47,1.15-0.86,2.26-1.18l4.22-1.18v6.92 c-1.16,0.96-2.39,1.44-3.7,1.44c-1.31,0-2.2-0.23-2.66-0.7c-0.47-0.47-0.7-1.2-0.7-2.18v-1.11 C96.69,32.65,96.89,31.98,97.28,31.51 M80.74,18.45h-2.52v26.57h2.63V39.5h3.74c1.65,0,2.98-0.49,3.98-1.46 c1-0.97,1.5-2.33,1.5-4.05V23.26c0-1.55-0.45-2.76-1.35-3.61c-0.9-0.85-2.04-1.28-3.42-1.28c-1.38,0-2.9,0.36-4.55,1.07V18.45z M87.4,33.81c0,2.2-1.15,3.29-3.44,3.29h-3.11V21.78c1.36-0.64,2.63-0.96,3.81-0.96c1.83,0,2.74,0.9,2.74,2.7V33.81z M62.61,24.66c0,2.15,1.04,3.71,3.11,4.7l3.18,1.52c0.94,0.44,1.57,0.86,1.89,1.24c0.32,0.38,0.48,0.92,0.48,1.61v0.74 c0,0.94-0.31,1.65-0.94,2.13c-0.63,0.48-1.73,0.72-3.29,0.72c-1.57,0-2.99-0.22-4.27-0.67v2.44c1.28,0.39,2.76,0.59,4.44,0.59 c4.46,0,6.7-1.73,6.7-5.18v-1c0-1.92-1.11-3.43-3.33-4.51l-3.18-1.55c-0.84-0.37-1.41-0.76-1.72-1.18 c-0.31-0.42-0.46-1.02-0.46-1.81v-0.96c0-1.01,0.26-1.73,0.78-2.16c0.52-0.43,1.52-0.65,3-0.65s2.84,0.22,4.07,0.67v-2.44 c-1.36-0.42-2.73-0.63-4.11-0.63c-2.25,0-3.86,0.43-4.85,1.28c-0.99,0.85-1.48,2.14-1.48,3.87V24.66z M49.21,18.45H46.7V39.5 h2.63V21.78c1.36-0.64,2.61-0.96,3.77-0.96c1.83,0,2.74,0.9,2.74,2.7V39.5h2.63V23.26c0-1.55-0.44-2.76-1.33-3.61 c-0.89-0.85-2.02-1.28-3.39-1.28c-1.37,0-2.88,0.35-4.53,1.04V18.45z M29.86,18.97v2.48c1.38-0.49,2.89-0.74,4.53-0.74 c1.64,0,2.73,0.23,3.28,0.7c0.54,0.47,0.83,1.21,0.85,2.22v3.22l-5.18,1.44c-2.99,0.84-4.48,2.54-4.48,5.11v1.18 c0,3.38,1.71,5.07,5.14,5.07c1.75,0,3.26-0.56,4.51-1.67v1.52h2.52V23.63c0-3.58-2.1-5.37-6.29-5.37 C32.89,18.26,31.27,18.5,29.86,18.97 M32.01,31.51c0.39-0.47,1.15-0.86,2.26-1.18l4.22-1.18v6.92c-1.16,0.96-2.39,1.44-3.7,1.44 c-1.31,0-2.2-0.23-2.66-0.7c-0.47-0.47-0.7-1.2-0.7-2.18v-1.11C31.41,32.65,31.61,31.98,32.01,31.51 M24.31,18.52 c-0.25,0.07-0.44,0.13-0.57,0.17c-0.14,0.04-0.33,0.13-0.59,0.28c-0.26,0.15-0.42,0.24-0.48,0.28 c-0.06,0.04-0.25,0.17-0.56,0.39c-0.31,0.22-0.5,0.36-0.57,0.41v-1.59h-2.52V39.5h2.63V22.56c0.74-0.52,1.22-0.85,1.44-1 c0.72-0.47,1.52-0.7,2.41-0.7h1.26v-2.52h-0.93C25.18,18.34,24.68,18.4,24.31,18.52 M8.29,14.64l-0.74,3.81H5.14v2.33h2.29 v14.17c0,3.13,1.65,4.7,4.96,4.7c0.86,0,1.79-0.12,2.78-0.37v-2.41c-0.81,0.27-1.65,0.41-2.52,0.41c-0.86,0-1.51-0.19-1.92-0.57 c-0.42-0.38-0.63-1-0.63-1.87V20.78h4.7v-2.33h-4.7v-3.81H8.29z");
	makerjs.model.scale(modelLocal.models.tdLogoTransparentDesign, scalefactor);
	makerjs.model.center(modelLocal.models.tdLogoTransparentDesign);

	// Auftragsnummer
	let auftragsNummerOriginalStr = document.getElementById('auftragsNummer').value;
	let auftragsNummerGesperrtStr = "";
	for (let i = 0; i < auftragsNummerOriginalStr.length; i++) {
		auftragsNummerGesperrtStr += auftragsNummerOriginalStr.charAt(i) + " ";
	}
	modelLocal.models["auftragsnummer"] = new makerjs.models.Text(font, auftragsNummerGesperrtStr, 18);
	makerjs.model.scale(modelLocal.models.auftragsnummer, scalefactor);
	makerjs.model.center(modelLocal.models.auftragsnummer);

	
	makerjs.model.moveRelative(modelLocal.models.tdLogoInJederForm, [determineTotalWidth() / 2 + (25 * scalefactor), determineTotalHeight() / 2 + (-10 * scalefactor)]);
	makerjs.model.moveRelative(modelLocal.models.tdLogoPlexiGlas, [determineTotalWidth() / 2 + (25 * scalefactor), determineTotalHeight() / 2 + (20 * scalefactor)]);
	makerjs.model.moveRelative(modelLocal.models.tdLogoTokenOben, [determineTotalWidth() / 2 - (77.7 * scalefactor), determineTotalHeight() / 2 + (7.5 * scalefactor)]);
	makerjs.model.moveRelative(modelLocal.models.tdLogoTokenUnten, [determineTotalWidth() / 2 - (80 * scalefactor), determineTotalHeight() / 2 - (8 * scalefactor)]);
	makerjs.model.moveRelative(modelLocal.models.tdLogoRegisteredTradeMark, [determineTotalWidth() / 2 + (90 * scalefactor), determineTotalHeight() / 2 + (28.5 * scalefactor)]);
	makerjs.model.moveRelative(modelLocal.models.tdLogoTransparentDesign, [determineTotalWidth() / 2, determineTotalHeight() / 2 + (55 * scalefactor)]);
	makerjs.model.moveRelative(modelLocal.models.auftragsnummer, [determineTotalWidth() / 2 - (25 * scalefactor), determineTotalHeight() / 2 - (45 * scalefactor)]);
}

function calculateGenericPerforation(start, bruttoPerforatorLength) {
	const bzzzNoOfmm = 5;
	const gapNoOfBzzzz = 3

	
	if (bruttoPerforatorLength >= (((gapNoOfBzzzz * 2) + 1) * bzzzNoOfmm)) { // normal calculation of bzzz
		var numberOfBzzzzLocal = Math.floor((((bruttoPerforatorLength / bzzzNoOfmm /* mm ist die berechnungseinheit */) - gapNoOfBzzzz /* rechten Rand bestehend aus 3 mal 5 mm abziehen */) / (1 + gapNoOfBzzzz) /* (bzz und zwischenraum) bestehen aus 4 berechnungseinheiten */ ));
		let perforatorEinheiten = (numberOfBzzzzLocal * (1 + gapNoOfBzzzz)) + gapNoOfBzzzz;
		let nettoPerforatorLength = perforatorEinheiten * bzzzNoOfmm;
		let halfTara = (bruttoPerforatorLength - nettoPerforatorLength) / 2;
		var firstBzzzzLocal = start + halfTara + (gapNoOfBzzzz * bzzzNoOfmm);
	} else if (bruttoPerforatorLength >= (((gapNoOfBzzzz - 1) * 2) + 1) * bzzzNoOfmm) { // special logic for small bruttoPerforatorLength values
		var numberOfBzzzzLocal = 1;
		var firstBzzzzLocal = (bruttoPerforatorLength - bzzzNoOfmm) / 2 + start;
	} else {
		var numberOfBzzzzLocal = 0;
	}

	let ret = {
		numberOfBzzzz : numberOfBzzzzLocal,
		firstBzzzz : firstBzzzzLocal,
		bzzzLength : bzzzNoOfmm,
		gapLength : gapNoOfBzzzz * bzzzNoOfmm,
	}

	return ret;
}

function createVerticalPerforation(modelLocal) {
	let verticalPerforatorLowerY = obenUntenFetteLasche() + 2;
	let singleDelta = (determineTotalHeight() - innenLinksRechtsLaschenHoehe() - ( 2 * verticalPerforatorLowerY)) / 2;

	let perfInfo = calculateGenericPerforation(verticalPerforatorLowerY, singleDelta);
	
	for (let i = 0; i < perfInfo.numberOfBzzzz; i++) {
		let yLoop1 = perfInfo.firstBzzzz + (i * (perfInfo.bzzzLength + perfInfo.gapLength));
		let yLoop2 = yLoop1 + singleDelta + innenLinksRechtsLaschenHoehe();
		modelLocal.paths["verticalPerforatorLeftLower" + i] = new makerjs.paths.Line([determineEini(), yLoop1], [determineEini(), yLoop1 + perfInfo.bzzzLength]);	
		modelLocal.paths["verticalPerforatorRightLower" + i] = new makerjs.paths.Line([determineTotalWidth() -  determineEini(), yLoop1], [determineTotalWidth() -  determineEini(), yLoop1 + perfInfo.bzzzLength]);	
		modelLocal.paths["verticalPerforatorLeftUpper" + i] = new makerjs.paths.Line([determineEini(), yLoop2], [determineEini(), yLoop2 + perfInfo.bzzzLength]);	
		modelLocal.paths["verticalPerforatorRightUpper" + i] = new makerjs.paths.Line([determineTotalWidth() -  determineEini(), yLoop2], [determineTotalWidth() -  determineEini(), yLoop2 + perfInfo.bzzzLength]);	
	}
}

function createPerforation1Column(modelLocal) {
	
	// Laschen
	modelLocal.paths["upperMiddlePartLower"] = new makerjs.paths.Line([einiBisObenuntenInnenLasche(), determineTotalHeight() - determineOba()], [ determineTotalWidth() - einiBisObenuntenInnenLasche() , determineTotalHeight() - determineOba()]);
	modelLocal.paths["upperMiddlePartLeft"] = new makerjs.paths.Line([einiBisObenuntenInnenLasche(), determineTotalHeight() - determineOba()], [ einiBisObenuntenInnenLasche() , determineTotalHeight() - determineOba() + determineObenUntenLaschenHeight()]);
	modelLocal.paths["upperMiddlePartRight"] = new makerjs.paths.Line([determineTotalWidth() - einiBisObenuntenInnenLasche(), determineTotalHeight() - determineOba()], [ determineTotalWidth() - einiBisObenuntenInnenLasche() , determineTotalHeight() - determineOba() + determineObenUntenLaschenHeight()]);
	modelLocal.paths["upperMiddlePartUpperLeft"] = new makerjs.paths.Line([einiBisObenuntenInnenLasche(), determineTotalHeight() - determineOba() + determineObenUntenLaschenHeight()], [ einiBisObenuntenInnenLasche() + metadata.largeRadius + 0.01, determineTotalHeight() - determineOba() + determineObenUntenLaschenHeight()]);
	modelLocal.paths["upperMiddlePartUpperRight"] = new makerjs.paths.Line([determineTotalWidth() - einiBisObenuntenInnenLasche(), determineTotalHeight() - determineOba() + determineObenUntenLaschenHeight()], [ determineTotalWidth() - einiBisObenuntenInnenLasche() - metadata.largeRadius - 0.01, determineTotalHeight() - determineOba() + determineObenUntenLaschenHeight()]);
	modelLocal.paths["lowerMiddlePartLower"] = new makerjs.paths.Line([einiBisObenuntenInnenLasche(), determineOba()], [ determineTotalWidth() - einiBisObenuntenInnenLasche() , determineOba()]);
	modelLocal.paths["lowerMiddlePartLeft"] = new makerjs.paths.Line([einiBisObenuntenInnenLasche(), determineOba() - determineObenUntenLaschenHeight()], [ einiBisObenuntenInnenLasche() , determineOba()]);
	modelLocal.paths["lowerMiddlePartRight"] = new makerjs.paths.Line([determineTotalWidth() - einiBisObenuntenInnenLasche(), determineOba() - determineObenUntenLaschenHeight()], [ determineTotalWidth() - einiBisObenuntenInnenLasche() , determineOba()]);
	modelLocal.paths["lowerMiddlePartUpperLeft"] = new makerjs.paths.Line([einiBisObenuntenInnenLasche(), determineOba() - determineObenUntenLaschenHeight()], [ einiBisObenuntenInnenLasche() + metadata.largeRadius + 0.01, determineOba() - determineObenUntenLaschenHeight()]);
	modelLocal.paths["lowerMiddlePartUpperRight"] = new makerjs.paths.Line([determineTotalWidth() - einiBisObenuntenInnenLasche(), determineOba() - determineObenUntenLaschenHeight()], [ determineTotalWidth() - einiBisObenuntenInnenLasche() - metadata.largeRadius - 0.01, determineOba() - determineObenUntenLaschenHeight()]);
	
	// radius für Laschen
	modelLocal.paths.radiusUpperPartLowerLeft = makerjs.path.fillet(modelLocal.paths.upperMiddlePartLower, modelLocal.paths.upperMiddlePartLeft, metadata.largeRadius);
	modelLocal.paths.radiusUpperPartLowerRight = makerjs.path.fillet(modelLocal.paths.upperMiddlePartLower, modelLocal.paths.upperMiddlePartRight, metadata.largeRadius);
	modelLocal.paths.radiusUpperPartUpperLeft = makerjs.path.fillet(modelLocal.paths.upperMiddlePartUpperLeft, modelLocal.paths.upperMiddlePartLeft, metadata.largeRadius);
	modelLocal.paths.radiusUpperPartUpperRight = makerjs.path.fillet(modelLocal.paths.upperMiddlePartUpperRight, modelLocal.paths.upperMiddlePartRight, metadata.largeRadius);
	modelLocal.paths.radiusLowerPartLowerLeft = makerjs.path.fillet(modelLocal.paths.lowerMiddlePartLower, modelLocal.paths.lowerMiddlePartLeft, metadata.largeRadius);
	modelLocal.paths.radiusLowerPartLowerRight = makerjs.path.fillet(modelLocal.paths.lowerMiddlePartLower, modelLocal.paths.lowerMiddlePartRight, metadata.largeRadius);
	modelLocal.paths.radiusLowerPartUpperLeft = makerjs.path.fillet(modelLocal.paths.lowerMiddlePartUpperLeft, modelLocal.paths.lowerMiddlePartLeft, metadata.largeRadius);
	modelLocal.paths.radiusLowerPartUpperRight = makerjs.path.fillet(modelLocal.paths.lowerMiddlePartUpperRight, modelLocal.paths.lowerMiddlePartRight, metadata.largeRadius);
	
	// Perforation
	let perforatorUpperX1 = einiBisObenuntenInnenLasche() + metadata.largeRadius + 0.01;
	let perforatorUpperX2 = determineTotalWidth() - einiBisObenuntenInnenLasche() - metadata.largeRadius - 0.01;
	let delta = perforatorUpperX2 - perforatorUpperX1;
	let perfInfo = calculateGenericPerforation(perforatorUpperX1, delta);
	for (let i = 0; i < perfInfo.numberOfBzzzz; i++) {
		let xLoop = perfInfo.firstBzzzz + (i * (perfInfo.bzzzLength + perfInfo.gapLength));
		modelLocal.paths["perforationCenterUpper" + i] = new makerjs.paths.Line([xLoop, determineTotalHeight() - determineOba() + determineObenUntenLaschenHeight()], [xLoop + perfInfo.bzzzLength, determineTotalHeight() - determineOba() + determineObenUntenLaschenHeight()]);	
		modelLocal.paths["perforationCenterLower" + i] = new makerjs.paths.Line([xLoop, determineOba() - determineObenUntenLaschenHeight()], [xLoop + perfInfo.bzzzLength, determineOba() - determineObenUntenLaschenHeight()]);
	}
}

function createSingleObenLasche(modelLocal, x1, x2, uniqueTrallala) {
	modelLocal.paths[uniqueTrallala + "upperMiddlePartLower"] = new makerjs.paths.Line([x1, determineTotalHeight() - determineOba()], [x2, determineTotalHeight() - determineOba()]);
	modelLocal.paths[uniqueTrallala + "upperMiddlePartLeft"] = new makerjs.paths.Line([x1, determineTotalHeight() - determineOba()], [ x1 , determineTotalHeight() - determineOba() + determineObenUntenLaschenHeight()]);
	modelLocal.paths[uniqueTrallala + "upperMiddlePartRight"] = new makerjs.paths.Line([x2, determineTotalHeight() - determineOba()], [x2, determineTotalHeight() - determineOba() + determineObenUntenLaschenHeight()]);
	modelLocal.paths[uniqueTrallala + "upperMiddlePartLeftSmallBack"] = new makerjs.paths.Line([x1, determineTotalHeight() - determineOba() + determineObenUntenLaschenHeight()], [ x1 + metadata.largeRadius + 0.01, determineTotalHeight() - determineOba() + determineObenUntenLaschenHeight()]);
	modelLocal.paths[uniqueTrallala + "upperMiddlePartRightSmallBack"] = new makerjs.paths.Line([x2, determineTotalHeight() - determineOba() + determineObenUntenLaschenHeight()], [ x2 - metadata.largeRadius - 0.01, determineTotalHeight() - determineOba() + determineObenUntenLaschenHeight()]);
	modelLocal.paths[uniqueTrallala + "radiusUpperMiddlePartLeftLower"] = makerjs.path.fillet(modelLocal.paths[uniqueTrallala + "upperMiddlePartLower"], modelLocal.paths[uniqueTrallala + "upperMiddlePartLeft"], metadata.largeRadius);
	modelLocal.paths[uniqueTrallala + "radiusUpperMiddlePartRightLower"] = makerjs.path.fillet(modelLocal.paths[uniqueTrallala + "upperMiddlePartLower"], modelLocal.paths[uniqueTrallala + "upperMiddlePartRight"], metadata.largeRadius);
	modelLocal.paths[uniqueTrallala + "radiusUpperMiddlePartLeftLowerSmallBack"] = makerjs.path.fillet(modelLocal.paths[uniqueTrallala + "upperMiddlePartLeftSmallBack"], modelLocal.paths[uniqueTrallala + "upperMiddlePartLeft"], metadata.largeRadius);
	modelLocal.paths[uniqueTrallala + "radiusUpperMiddlePartRightLowerSmallBack"] = makerjs.path.fillet(modelLocal.paths[uniqueTrallala + "upperMiddlePartRightSmallBack"], modelLocal.paths[uniqueTrallala + "upperMiddlePartRight"], metadata.largeRadius);	

	let perfInfo = calculateGenericPerforation(x1, x2 - x1);

	for (let i = 0; i < perfInfo.numberOfBzzzz; i++) {
		let xLoop1 = perfInfo.firstBzzzz + (i * (perfInfo.bzzzLength + perfInfo.gapLength));
		modelLocal.paths[uniqueTrallala + "perforationCenterUpperLeft" + i] = new makerjs.paths.Line([xLoop1, determineTotalHeight() - determineOba() + determineObenUntenLaschenHeight()], [xLoop1 + perfInfo.bzzzLength, determineTotalHeight() - determineOba() + determineObenUntenLaschenHeight()]);	
	}
}

function createSingleUntenLasche(modelLocal, x1, x2, uniqueTrallala) {
	lascheX1 = einiBisObenuntenInnenLasche();
	laschetX2 = determineTotalWidth() - einiBisObenuntenInnenLasche();

	createSingleObenLasche(modelLocal, lascheX1, lascheX2, "");
	createSingleUntenLasche(modelLocal, lascheX1, lascheX2, "");
}

function createColumnSpitAndPerforation3Columns(modelLocal) {
	const halfGapBetween2SplittedLaschen = 30;
	const lascheWidth = (determineTotalWidth() - (2 * einiBisObenuntenInnenLasche()) - (4 * halfGapBetween2SplittedLaschen)) / 3;

	lascheLeftX1 = einiBisObenuntenInnenLasche();
	lascheLeftX2 = einiBisObenuntenInnenLasche() + lascheWidth;

	lascheMiddleX1 = (determineTotalWidth() / 2) - (lascheWidth / 2);
	lascheMiddleX2 = (determineTotalWidth() / 2) + (lascheWidth / 2);

	lascheRightX1 = determineTotalWidth() - einiBisObenuntenInnenLasche() - lascheWidth;
	lascheRightX2 = determineTotalWidth() - einiBisObenuntenInnenLasche();

	createSingleObenLasche(modelLocal, lascheLeftX1, lascheLeftX2, "left");
	createSingleObenLasche(modelLocal, lascheMiddleX1, lascheMiddleX2, "middle");
	createSingleObenLasche(modelLocal, lascheRightX1, lascheRightX2, "right");

	createSingleUntenLasche(modelLocal, lascheLeftX1, lascheLeftX2, "left");
	createSingleUntenLasche(modelLocal, lascheMiddleX1, lascheMiddleX2, "middle");
	createSingleUntenLasche(modelLocal, lascheRightX1, lascheRightX2, "right");
}

function createColumnSpitAndPerforation2Columns(modelLocal) {
	const halfGapBetween2SplittedLaschen = 30;
	const lascheWidth = (determineTotalWidth() - (2 * einiBisObenuntenInnenLasche()) - (2 * halfGapBetween2SplittedLaschen)) / 2;

	lascheLeftX1 = einiBisObenuntenInnenLasche();
	lascheLeftX2 = einiBisObenuntenInnenLasche() + lascheWidth;

	lascheRightX1 = determineTotalWidth() - einiBisObenuntenInnenLasche() - lascheWidth;
	lascheRightX2 = determineTotalWidth() - einiBisObenuntenInnenLasche();

	createSingleObenLasche(modelLocal, lascheLeftX1, lascheLeftX2, "left");
	createSingleObenLasche(modelLocal, lascheRightX1, lascheRightX2, "right");

	createSingleUntenLasche(modelLocal, lascheLeftX1, lascheLeftX2, "left");
	createSingleUntenLasche(modelLocal, lascheRightX1, lascheRightX2, "right");
}

function createRadius(modelLocal) {

	// Main Border
	modelLocal.paths.radiusLeftUpper = makerjs.path.fillet(modelLocal.paths.lineLeftUpper, modelLocal.paths.lineTop, metadata.largeRadius);
	modelLocal.paths.radiusRightUpper = makerjs.path.fillet(modelLocal.paths.lineTop, modelLocal.paths.lineRightUpper, metadata.largeRadius);
	modelLocal.paths.radiusRightLower = makerjs.path.fillet(modelLocal.paths.lineRightLower, modelLocal.paths.lineBottom, metadata.largeRadius);
	modelLocal.paths.radiusLeftLower = makerjs.path.fillet(modelLocal.paths.lineBottom, modelLocal.paths.lineLeftLower, metadata.largeRadius);

	modelLocal.paths.radiusLeftUpperEinschnitt = makerjs.path.fillet(modelLocal.paths.lineLeftUpper, modelLocal.paths.schnittEiniLinksOben, metadata.largeRadius);
	modelLocal.paths.radiusLeftLowerEinschnitt = makerjs.path.fillet(modelLocal.paths.lineLeftLower, modelLocal.paths.schnittEiniLinksUnten, metadata.largeRadius);
	modelLocal.paths.radiusRightUpperEinschnitt = makerjs.path.fillet(modelLocal.paths.lineRightUpper, modelLocal.paths.schnittEiniRechtsOben, metadata.largeRadius);
	modelLocal.paths.radiusRightLowerEinschnitt = makerjs.path.fillet(modelLocal.paths.lineRightLower, modelLocal.paths.schnittEiniRechtsUnten, metadata.largeRadius);

	modelLocal.paths.radiusLeftUpperEinschnittBackOben = makerjs.path.fillet(modelLocal.paths.schnittEiniLinksOben, modelLocal.paths.schnittEiniLinksObenToBack, metadata.smallRadius);
	modelLocal.paths.radiusLeftUpperEinschnittBackUnten = makerjs.path.fillet(modelLocal.paths.schnittEiniLinksObenToBack, modelLocal.paths.schnittEiniLinksObenBack, metadata.smallRadius);
	modelLocal.paths.radiusLeftLowerEinschnittBackOben = makerjs.path.fillet(modelLocal.paths.schnittEiniLinksUnten, modelLocal.paths.schnittEiniLinksUntenToBack, metadata.smallRadius);
	modelLocal.paths.radiusLeftLowerEinschnittBackUnten = makerjs.path.fillet(modelLocal.paths.schnittEiniLinksUntenToBack, modelLocal.paths.schnittEiniLinksUntenBack, metadata.smallRadius);
	modelLocal.paths.radiusRightUpperEinschnittBackOben = makerjs.path.fillet(modelLocal.paths.schnittEiniRechtsOben, modelLocal.paths.schnittEiniRechtsObenToBack, metadata.smallRadius);
	modelLocal.paths.radiusRightUpperEinschnittBackUnten = makerjs.path.fillet(modelLocal.paths.schnittEiniRechtsObenToBack, modelLocal.paths.schnittEiniRechtsObenBack, metadata.smallRadius);
	modelLocal.paths.radiusRightLowerEinschnittBackOben = makerjs.path.fillet(modelLocal.paths.schnittEiniRechtsUnten, modelLocal.paths.schnittEiniRechtsUntenToBack, metadata.smallRadius);
	modelLocal.paths.radiusRightLowerEinschnittBackUnten = makerjs.path.fillet(modelLocal.paths.schnittEiniRechtsUntenToBack, modelLocal.paths.schnittEiniRechtsUntenBack, metadata.smallRadius);

	modelLocal.paths.radiusRightMiddleEinschnittLeftOben = makerjs.path.fillet(modelLocal.paths.schnittEiniLinksObenBack, modelLocal.paths.lineLeftMiddle, metadata.largeRadius);
	modelLocal.paths.radiusRightMiddleEinschnittLeftUnten = makerjs.path.fillet(modelLocal.paths.schnittEiniLinksUntenBack, modelLocal.paths.lineLeftMiddle, metadata.largeRadius);
	modelLocal.paths.radiusLeftMiddleEinschnittRightOben = makerjs.path.fillet(modelLocal.paths.schnittEiniRechtsObenBack, modelLocal.paths.lineRightMiddle, metadata.largeRadius);
	modelLocal.paths.radiusLeftMiddleEinschnittRightUnten = makerjs.path.fillet(modelLocal.paths.schnittEiniRechtsUntenBack, modelLocal.paths.lineRightMiddle, metadata.largeRadius);

	// Other Parts

	modelLocal.paths.radiusLeftMiddlePartUpper = makerjs.path.fillet(modelLocal.paths.leftMiddlePartMiddle, modelLocal.paths.leftMiddlePartUpper, metadata.largeRadius);
	modelLocal.paths.radiusLeftMiddlePartLower = makerjs.path.fillet(modelLocal.paths.leftMiddlePartMiddle, modelLocal.paths.leftMiddlePartLower, metadata.largeRadius);

	modelLocal.paths.radiusRightMiddlePartUpper = makerjs.path.fillet(modelLocal.paths.rightMiddlePartMiddle, modelLocal.paths.rightMiddlePartUpper, metadata.largeRadius);
	modelLocal.paths.radiusRightMiddlePartLower = makerjs.path.fillet(modelLocal.paths.rightMiddlePartMiddle, modelLocal.paths.rightMiddlePartLower, metadata.largeRadius);
}

function boxSizeCheck() {
	return metadata.cabinetLength + metadata.minDeltaBoxCabinet > metadata.boxLength ||
		metadata.cabinetWidth + metadata.minDeltaBoxCabinet > metadata.boxWidth ||
		metadata.cabinetHeight + metadata.minDeltaBoxCabinet > metadata.boxHeight;
}

function drawPreview() {
	if (boxSizeCheck()) {
			document.getElementById('inleyPreviewDiv').innerHTML = "<div style='width:250px;'><div style='justify-content: center; display:flex'><?xml version='1.0' encoding='iso-8859-1'?> <svg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='200px'  viewBox='0 0 295.996 295.996' style='enable-background:new 0 0 295.996 295.996;' xml:space='preserve'> <g>  <path style='fill:#FFCE00;' d='M270.996,123.998c0-11.334-1.363-22.348-3.907-32.9c-7.269-15.152-17.35-28.708-29.558-39.996   c-22.391-13.376-48.766-20.666-76.771-19.644C83.492,34.274,23.139,99.196,25.955,176.463c0.413,11.304,2.17,22.239,5.087,32.673   c6.303,12.01,14.397,22.938,23.934,32.42c21.892,14.189,47.99,22.44,76.023,22.44C208.316,263.996,270.996,201.316,270.996,123.998   z M197.666,98.998c8.836,0,16,7.164,16,16s-7.164,16-16,16s-16-7.164-16-16S188.83,98.998,197.666,98.998z M98.666,98.998   c8.836,0,16,7.164,16,16s-7.164,16-16,16s-16-7.164-16-16S89.83,98.998,98.666,98.998z M87.959,215.396l-12.633-9.82   c21.441-27.579,57.392-40.777,91.587-33.631c21.262,4.447,40.353,16.391,53.756,33.631l-12.631,9.82   c-11.078-14.249-26.847-24.118-44.4-27.789C135.382,181.697,105.675,192.607,87.959,215.396z'/>  <path style='fill:#FFB100;' d='M267.089,91.098c2.544,10.553,3.907,21.566,3.907,32.9c0,77.318-62.68,139.998-139.998,139.998   c-28.032,0-54.131-8.251-76.023-22.44c23.88,23.744,56.766,38.44,93.023,38.44c72.784,0,131.998-59.214,131.998-131.998   C279.996,127.636,275.358,108.337,267.089,91.098z'/>  <path style='fill:#FFE454;' d='M160.76,31.457c28.006-1.021,54.381,6.268,76.771,19.644C213.985,29.328,182.521,16,147.998,16   C75.214,16,16,75.214,16,147.998c0,22.049,5.442,42.849,15.042,61.138c-2.917-10.434-4.674-21.369-5.087-32.673   C23.139,99.196,83.492,34.274,160.76,31.457z'/>  <path d='M147.998,0C66.392,0,0,66.392,0,147.998s66.392,147.998,147.998,147.998s147.998-66.392,147.998-147.998   S229.604,0,147.998,0z M147.998,279.996c-36.257,0-69.143-14.696-93.023-38.44c-9.536-9.482-17.631-20.41-23.934-32.42   C21.442,190.847,16,170.047,16,147.998C16,75.214,75.214,16,147.998,16c34.523,0,65.987,13.328,89.533,35.102   c12.208,11.288,22.289,24.844,29.558,39.996c8.27,17.239,12.907,36.538,12.907,56.9   C279.996,220.782,220.782,279.996,147.998,279.996z'/>  <path d='M163.638,187.607c17.554,3.671,33.322,13.54,44.4,27.789l12.631-9.82c-13.402-17.24-32.494-29.184-53.756-33.631   c-34.195-7.146-70.146,6.052-91.587,33.631l12.633,9.82C105.675,192.607,135.382,181.697,163.638,187.607z'/>  <circle cx='98.666' cy='114.998' r='16'/>  <circle cx='197.666' cy='114.998' r='16'/> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> </svg></div> "
				+ " <div style='color:#aa2222;text-align:center'> Der Karton ist zu klein :-( </div></div> ";
			document.getElementById('downloadDXF').style.visibility = "hidden";
			document.getElementById('downloadSVG').style.visibility = "hidden";
			return;
	}

	let previewWidth = determineTotalWidth();
	let previewHeight = determineTotalHeight();

	var svg = makerjs.exporter.toSVG(model, {svgAttrs : {"width" : previewWidth + "px", "height" : previewHeight + "px", "id" : "preViewSvg" } });
		
	document.getElementById('inleyPreviewDiv').innerHTML = "<div id='backgroundDiv'></div>";
	
	document.getElementById('backgroundDiv').innerHTML = "<div id='contentDiv'></div>";
	
	document.getElementById('contentDiv').innerHTML = svg;
	document.getElementById('contentDiv').style.position = "relative";

	let viewBoxAttrib = "-1 -1 " + (previewWidth + 2) + " " + (previewHeight + 2) ;
	document.getElementById('preViewSvg').setAttribute("viewBox", viewBoxAttrib);

	//let g = document.querySelector('#preViewSvg>g');
	//g.style="stroke-width:0.35mm";

	document.getElementById('downloadDXF').style.visibility = "";
	document.getElementById('downloadSVG').style.visibility = "";
	
	document.getElementById("cabinetWidth").value = metadata.cabinetWidth;
	document.getElementById("cabinetHeight").value = metadata.cabinetHeight;
	document.getElementById("cabinetLength").value = metadata.cabinetLength;
	document.getElementById("boxWidth").value = metadata.boxWidth;
    document.getElementById("boxHeight").value = metadata.boxHeight;
    document.getElementById("boxLength").value = metadata.boxLength;
}
	
function download(data, filename, type) {
        var file = new Blob([data], {type: type});
        if (window.navigator.msSaveOrOpenBlob) // IE10+
            window.navigator.msSaveOrOpenBlob(file, filename);
        else { // Others
            var a = document.createElement("a"),
                    url = URL.createObjectURL(file);
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            setTimeout(function() {
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);  
            }, 0); 
        }
    }

function downloadDXF() {
	var dxfExp = makerjs.exporter.toDXF(model, { fontSize: 4 })
	download(dxfExp, "Karton Inlay " + document.getElementById('auftragsNummer').value + ".dxf", "dxf")
}

function downloadSVG() {
   var svgExp = '<?xml version="1.0" encoding="UTF-8"?>\n' + 
		makerjs.exporter.toSVG(model, { 
			units: makerjs.unitType.Millimeter, 
			svgAttrs : {
				"width" : (determineTotalWidth() + "mm"), 
				"height" : (determineTotalHeight() + "mm"), 
				"xmlns" : "http://www.w3.org/2000/svg",
				"xmlns:xlink" : "http://www.w3.org/1999/xlink",
				"version" : "1.1",
				"baseProfile" : "full"
						}
		});
	download(svgExp, "Karton Inlay " + document.getElementById('auftragsNummer').value + ".svg", "svg")
}

function genericChanged(elementId, metaDataFieldName1, metaDataFieldName2, metaDataFieldName3) {
	var widthInt = parseInt(document.getElementById(elementId).value);
	if (!isNaN(widthInt)) {
		document.getElementById(elementId).style.backgroundColor = "";
		if (metaDataFieldName3) {
		    metadata[metaDataFieldName1][metaDataFieldName2][metaDataFieldName3] = parseInt(widthInt);
		} else if (metaDataFieldName2) {
			metadata[metaDataFieldName1][metaDataFieldName2] = parseInt(widthInt);
		} else {
			metadata[metaDataFieldName1] = parseInt(widthInt);
		}
		return true;
	} else {
	    document.getElementById(elementId).style.backgroundColor = "#d87979";
		return false;
	}
}

function boxLengthChanged() {
	document.getElementById("infoMessage").innerHTML = "";
	document.getElementById("infoMessage").style.backgroundColor = "";

    if (genericChanged("boxLength", "boxLength")) {
		model = createModel();
		drawPreview();
	}
	unCheckTemplate();
}

function boxWidthChanged() {
	document.getElementById("infoMessage").innerHTML = "";
	document.getElementById("infoMessage").style.backgroundColor = "";


	if (genericChanged("boxWidth", "boxWidth")) {
		model = createModel();
		drawPreview();
	}
	unCheckTemplate()
}

function boxHeightChanged() {
	document.getElementById("infoMessage").innerHTML = "";
	document.getElementById("infoMessage").style.backgroundColor = "";

	if (genericChanged("boxHeight", "boxHeight")) {
		model = createModel();
		drawPreview();
	}
	unCheckTemplate()
}

function cabinetLengthChanged() {
	document.getElementById("infoMessage").innerHTML = "";
	document.getElementById("infoMessage").style.backgroundColor = "";

	if (genericChanged("cabinetLength", "cabinetLength")) {
		checkBoxTemplate();
		model = createModel();
		drawPreview();
	}
}

function cabinetWidthChanged() {
	document.getElementById("infoMessage").innerHTML = "";
	document.getElementById("infoMessage").style.backgroundColor = "";

	if (genericChanged("cabinetWidth", "cabinetWidth")) {
		checkBoxTemplate();
		model = createModel();
		drawPreview();
	}
}

function cabinetHeightChanged() {
	let length = parseInt(document.getElementById("cabinetLength").value);
	let width = parseInt(document.getElementById("cabinetWidth").value);
	let height = parseInt(document.getElementById("cabinetHeight").value);
	
	let lbh = [length, width, height];
	lbh.sort(function(a, b){return a-b});
	lbh.reverse();

	if ((length != lbh[0]) || (width != lbh[1]) || (height != lbh[2])){
		document.getElementById("infoMessage").innerHTML = "Achtung Länge, Breite und Höhe wurden absteigent sortiert!";
		document.getElementById("infoMessage").style.backgroundColor = "yellow";

		document.getElementById("cabinetLength").value = lbh[0];
		document.getElementById("cabinetWidth").value = lbh[1];
		document.getElementById("cabinetHeight").value = lbh[2];

		metadata.cabinetLength = lbh[0];
		metadata.cabinetWidth = lbh[1];
		metadata.cabinetHeight = lbh[2];

	} else {
		document.getElementById("infoMessage").innerHTML = "";
		document.getElementById("infoMessage").style.backgroundColor = "";
	}

	if (genericChanged("cabinetHeight", "cabinetHeight")) {
		checkBoxTemplate();
		model = createModel();
		drawPreview();
	}
}

function boxTemplateChanged() {
	document.getElementById("infoMessage").innerHTML = "";
	document.getElementById("infoMessage").style.backgroundColor = "";
	var selected = document.querySelector('input[name="boxTemplate"]:checked'); 
	if (selected != null) {
		values = selected.value.split("x");
		metadata.boxLength = parseInt(values[0]);
		metadata.boxWidth = parseInt(values[1]);
		metadata.boxHeight = parseInt(values[2]);
		document.getElementById("boxLength").value = values[0];
		document.getElementById("boxWidth").value = values[1];
		document.getElementById("boxHeight").value = values[2];
		model = createModel();
		drawPreview();
	}
}

function checkBoxTemplate() {
	var radios = document.getElementsByName("boxTemplate");
    for( i = 0; i < radios.length; i++ ) {
		values = radios[i].value.split("x");
        let boxLength = parseInt(values[0]);
		let boxWidth = parseInt(values[1]);
		let boxHeight = parseInt(values[2]);

		if (metadata.cabinetLength + metadata.minDeltaBoxCabinet <= boxLength &&
			metadata.cabinetWidth + metadata.minDeltaBoxCabinet <= boxWidth &&
			metadata.cabinetHeight + metadata.minDeltaBoxCabinet <= boxHeight) {
				radios[i].checked = true;
				metadata.boxLength = parseInt(values[0]);
				metadata.boxWidth = parseInt(values[1]);
				metadata.boxHeight = parseInt(values[2]);
				document.getElementById("boxLength").value = values[0];
				document.getElementById("boxWidth").value = values[1];
				document.getElementById("boxHeight").value = values[2];
				return;
		}
    }
	var selected = document.querySelector('input[name="boxTemplate"]:checked'); 
	if (selected != null) {
		selected.checked = false;
	}
}

function auftragsnummerChanged() {
	model = createModel();
	drawPreview();
}

function defineInlayOhneKarton() {
	unCheckTemplate();
	metadata.boxLength = metadata.cabinetLength + 80;
	metadata.boxWidth =  metadata.cabinetWidth + 80;
	metadata.boxHeight = metadata.cabinetHeight + 80;
	model = createModel();
	drawPreview();
}

function unCheckTemplate() {
	Array.from(document.getElementsByName('boxTemplate')).forEach(function(option_element) {
		option_element.checked = false;
	});
}

</script>
</body>
</html>