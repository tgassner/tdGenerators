<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <link rel="icon" href="img/favicon114.png" sizes="32x32" />
    <link rel="icon" href="img/favicon114.png" sizes="192x192" />
    <link rel="apple-touch-icon" href="img/favicon114.png" />
    <meta name="msapplication-TileImage" content="img/favicon114.png" />

    <title>Transparentdesign Offer Generator</title>

    <script>

        var deleteButton = "<svg width=\"28\" height=\"28\" viewBox=\"0 0 56 56\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" focusable=\"false\">\n" +
            "    <defs>\n" +
            "      <!-- Farbverlauf Rot -->\n" +
            "      <linearGradient id=\"deleteGradient\" x1=\"0\" y1=\"0\" x2=\"1\" y2=\"1\">\n" +
            "        <stop offset=\"0\" stop-color=\"#e35b5b\"/>\n" +
            "        <stop offset=\"1\" stop-color=\"#c94040\"/>\n" +
            "      </linearGradient>\n" +
            //"      <filter id=\"shadow-del\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n" +
            //"        <feDropShadow dx=\"0\" dy=\"4\" stdDeviation=\"6\" flood-opacity=\"0.18\"/>\n" +
            //"      </filter>\n" +
            "    </defs>\n" +
            "\n" +
            "    <!-- Hintergrund -->\n" +
            "    <rect x=\"0.5\" y=\"0.5\" width=\"55\" height=\"55\" rx=\"12\" fill=\"url(#deleteGradient)\" filter=\"url(#shadow-del)\"/>\n" +
            "\n" +
            "    <!-- Weißes Minus -->\n" +
            "    <line x1=\"17.5\" y1=\"28\" x2=\"38.5\" y2=\"28\" stroke=\"#ffffff\" stroke-width=\"3.6\" stroke-linecap=\"round\"/>\n" +
            "  </svg>";

        function deletePosition(posId) {
            alert("ToDo: Delete " + posId);
        }

        function addPosition() {

            let posContainer = document.getElementById("positionenContainer");
            let posCountInternal = posContainer.childElementCount;
            let newPosNumber = ((posContainer.childElementCount + 1) * 10) + "";


            let singlePositionContainerDiv = document.createElement('div');
            singlePositionContainerDiv.id = "positionenContainerDiv" + posCountInternal;
            singlePositionContainerDiv.classList.add('singlePositionContainerDivClass');

            let positionDeleteButtonDiv = document.createElement('div');
            positionDeleteButtonDiv.classList.add('positionDeleteButtonDivClass');
            positionDeleteButtonDiv.innerHTML = deleteButton;
            positionDeleteButtonDiv.addEventListener('click', () => deletePosition(singlePositionContainerDiv.id));
            singlePositionContainerDiv.appendChild(positionDeleteButtonDiv);

            let positionPosDiv = document.createElement('div');
            positionPosDiv.innerHTML = newPosNumber;
            positionPosDiv.classList.add('positionPosDivClass');
            singlePositionContainerDiv.appendChild(positionPosDiv);


            let positionBausteinDiv = document.createElement('div');
            positionBausteinDiv.classList.add('positionBausteinDivClass');
            let positionBausteinList = document.createElement('select');

            let BausteinOptD = document.createElement('option');
            BausteinOptD.value = "D";
            BausteinOptD.innerHTML = "D";
            positionBausteinList.appendChild(BausteinOptD);

            let BausteinOptF = document.createElement('option');
            BausteinOptF.value = "F";
            BausteinOptF.innerHTML = "F";
            positionBausteinList.appendChild(BausteinOptF);

            let BausteinOptT = document.createElement('option');
            BausteinOptT.value = "T";
            BausteinOptT.innerHTML = "T";
            positionBausteinList.appendChild(BausteinOptT);

            let BausteinOptZ = document.createElement('option');
            BausteinOptZ.value = "Z";
            BausteinOptZ.innerHTML = "Z";
            positionBausteinList.appendChild(BausteinOptZ);

            positionBausteinDiv.appendChild(positionBausteinList);
            singlePositionContainerDiv.appendChild(positionBausteinDiv);


            let positionArtikelNrDiv = document.createElement('div');
            positionArtikelNrDiv.classList.add('positionArtikelNrDivClass');
            let positionArtikelNrInput = document.createElement('input');
            positionArtikelNrInput.type = "text";
            positionArtikelNrInput.id = "positionArtikelNrInput" + posCountInternal;
            positionArtikelNrDiv.appendChild(positionArtikelNrInput);
            singlePositionContainerDiv.appendChild(positionArtikelNrDiv);

            let positionBezeichnungDiv = document.createElement('div');
            positionBezeichnungDiv.classList.add('positionBezeichnungDivClass');
            let positionBezeichnungInput = document.createElement('input');
            positionBezeichnungInput.type = "text";
            positionBezeichnungInput.id = "positionBezeichnungInput" + posCountInternal;
            positionBezeichnungDiv.appendChild(positionBezeichnungInput);
            singlePositionContainerDiv.appendChild(positionBezeichnungDiv);

            let positionLengthDiv = document.createElement('div');
            positionLengthDiv.classList.add('positionLengthDivClass');
            let positionLengthInput = document.createElement('input');
            positionLengthInput.type = "number";
            positionLengthInput.id = "positionLengthInput" + posCountInternal;
            positionLengthDiv.appendChild(positionLengthInput);
            singlePositionContainerDiv.appendChild(positionLengthDiv);

            let positionWidthDiv = document.createElement('div');
            positionWidthDiv.classList.add('positionWidthDivClass');
            let positionWidthInput = document.createElement('input');
            positionWidthInput.type = "number";
            positionWidthInput.id = "positionWidthInput" + posCountInternal;
            positionWidthDiv.appendChild(positionWidthInput);
            singlePositionContainerDiv.appendChild(positionWidthDiv);

            let positionAnzahlDiv = document.createElement('div');
            positionAnzahlDiv.classList.add('positionAnzahlDivClass');
            let positionAnzahlInput = document.createElement('input');
            positionAnzahlInput.type = "number";
            positionAnzahlInput.id = "positionAnzahlInput" + posCountInternal;
            positionAnzahlDiv.appendChild(positionAnzahlInput);
            singlePositionContainerDiv.appendChild(positionAnzahlDiv);

            let positionMengeDiv = document.createElement('div');
            positionMengeDiv.classList.add('positionMengeDivClass');
            let positionMengeInput = document.createElement('input');
            positionMengeInput.type = "number";
            positionMengeInput.id = "positionMengeInput" + posCountInternal;
            positionMengeDiv.appendChild(positionMengeInput);
            singlePositionContainerDiv.appendChild(positionMengeDiv);












            let positionEinheitDiv = document.createElement('div');
            positionEinheitDiv.classList.add('positionEinheitDivClass');
            let positionEinheitList = document.createElement('select');

            let einheitLeer = document.createElement('option');
            einheitLeer.value = "";
            einheitLeer.innerHTML = "";
            positionEinheitList.appendChild(einheitLeer);

            let einheitStueck = document.createElement('option');
            einheitStueck.value = "Stück";
            einheitStueck.innerHTML = "Stück";
            positionEinheitList.appendChild(einheitStueck);

            let einheitQuadratmeter = document.createElement('option');
            einheitQuadratmeter.value = "m²";
            einheitQuadratmeter.innerHTML = "m²";
            positionEinheitList.appendChild(einheitQuadratmeter);

            let einheitMeter = document.createElement('option');
            einheitMeter.value = "m";
            einheitMeter.innerHTML = "m";
            positionEinheitList.appendChild(einheitMeter);

            let einheitSet = document.createElement('option');
            einheitSet.value = "Set";
            einheitSet.innerHTML = "Set";
            positionEinheitList.appendChild(einheitSet);

            let einheitPau = document.createElement('option');
            einheitPau.value = "Pau";
            einheitPau.innerHTML = "Pau";
            positionEinheitList.appendChild(einheitPau);

            let einheitStk = document.createElement('option');
            einheitStk.value = "Stk";
            einheitStk.innerHTML = "Stk";
            positionEinheitList.appendChild(einheitStk);

            let einheitStd = document.createElement('option');
            einheitStd.value = "Std";
            einheitStd.innerHTML = "Std";
            positionEinheitList.appendChild(einheitStd);

            let einheitLfm = document.createElement('option');
            einheitLfm.value = "lfm";
            einheitLfm.innerHTML = "lfm";
            positionEinheitList.appendChild(einheitLfm);

            let einheitPaar = document.createElement('option');
            einheitPaar.value = "Paar";
            einheitPaar.innerHTML = "Paar";
            positionEinheitList.appendChild(einheitPaar);

            let einheitMin = document.createElement('option');
            einheitMin.value = "min";
            einheitMin.innerHTML = "min";
            positionEinheitList.appendChild(einheitMin);

            let einheitKm = document.createElement('option');
            einheitKm.value = "km";
            einheitKm.innerHTML = "km";
            positionEinheitList.appendChild(einheitKm);

            positionEinheitDiv.appendChild(positionEinheitList);
            singlePositionContainerDiv.appendChild(positionEinheitDiv);


            posContainer.appendChild(singlePositionContainerDiv);

    }


    function doCreateOffer() {
            let xmlOfferDoc = document.implementation.createDocument("", "", null);
            let businessobjectsRootElement = xmlOfferDoc.createElement("businessobjects");

            let objectElem1 = xmlOfferDoc.createElement("object");
            objectElem1.setAttribute("name", "Angebot");
            objectElem1.setAttribute("id", "32");

            // AngebotArt
            let fieldAuftragArtElem1 = xmlOfferDoc.createElement("field");
            fieldAuftragArtElem1.setAttribute("name", "AngebotArt");
            fieldAuftragArtElem1.innerHTML = "0";
            objectElem1.appendChild(fieldAuftragArtElem1);

            // AngebotTyp
            let fieldAngebotTyp1 = xmlOfferDoc.createElement("field");
            fieldAngebotTyp1.setAttribute("name", "AngebotTyp");
            fieldAngebotTyp1.innerHTML = "";
            objectElem1.appendChild(fieldAngebotTyp1);

            // <field name="Bemerkung1"/>
            // <field name="Bemerkung2"/>
            // <field name="Bezeichnung"/>
            // <field name="ErstelltVon">LST</field>
            // <field name="Lieferzeit">1-2 Wochen</field>
            // <field name="MwStBetrag">28.80</field>
            // <field name="MwStBetragPos">28.80</field>
            // <field name="Nr">A251907</field>
            // <field name="SachkontoNr">4022</field>
            // <field name="Versandart">Zust</field>
            // <field name="Versandvermerk">##### nimmt Gassi mit!</field>

            let fieldMitarbeiterNr1 = xmlOfferDoc.createElement("field");
            fieldMitarbeiterNr1.setAttribute("name", "MitarbeiterNr");
            fieldMitarbeiterNr1.innerHTML = document.getElementById("MitarbeiterNr").value;
            objectElem1.appendChild(fieldMitarbeiterNr1);

            let fieldIhreZeichen1 = xmlOfferDoc.createElement("field");
            fieldIhreZeichen1.setAttribute("name", "IhreZeichen");
            fieldIhreZeichen1.innerHTML = document.getElementById("IhreZeichen").value;
            objectElem1.appendChild(fieldIhreZeichen1);

            let fieldLieferzeit1 = xmlOfferDoc.createElement("field");
            fieldLieferzeit1.setAttribute("name", "Lieferzeit");
            fieldLieferzeit1.innerHTML = document.getElementById("Lieferzeit").value;
            objectElem1.appendChild(fieldLieferzeit1);


            //let fieldDatum1 = xmlOfferDoc.createElement("field");
            //fieldDatum1.setAttribute("name", "Datum");
            //fieldDatum1.innerHTML = "2025.08.29 18:24:19";
            //objectElem1.appendChild(fieldDatum1);

            //let fieldGpartnerNr1 = xmlOfferDoc.createElement("field");
            //fieldGpartnerNr1.setAttribute("name", "GpartnerNr");
            //fieldGpartnerNr1.innerHTML = "20";
            //objectElem1.appendChild(fieldGpartnerNr1);

            let fieldSachkontoNr1 = xmlOfferDoc.createElement("field");
            fieldSachkontoNr1.setAttribute("name", "SachkontoNr");
            fieldSachkontoNr1.innerHTML = "4022";
            objectElem1.appendChild(fieldSachkontoNr1);

            //let fieldMwStNr1 = xmlOfferDoc.createElement("field");
            //fieldMwStNr1.setAttribute("name", "MwStNr");
            //fieldMwStNr1.innerHTML = "20";
            //objectElem1.appendChild(fieldMwStNr1);

            let fieldLiefBedText1 = xmlOfferDoc.createElement("field");
            fieldLiefBedText1.setAttribute("name", "LiefBedText");
            fieldLiefBedText1.innerHTML = document.getElementById("LiefBedText").value;
            objectElem1.appendChild(fieldLiefBedText1);

            //let fieldNr1 = xmlOfferDoc.createElement("field");
            //fieldNr1.setAttribute("name", "Nr");
            //fieldNr1.innerHTML = "K259397";
            //objectElem1.appendChild(fieldNr1);

            //let fieldUstKZ1 = xmlOfferDoc.createElement("field");
            //fieldUstKZ1.setAttribute("name", "UstKZ");
            //fieldUstKZ1.innerHTML = "IN";
            //objectElem1.appendChild(fieldUstKZ1);

            let fieldVersandart1 = xmlOfferDoc.createElement("field");
            fieldVersandart1.setAttribute("name", "Versandart");
            fieldVersandart1.innerHTML = document.getElementById("Versandart").value;
            objectElem1.appendChild(fieldVersandart1);

            let fieldVersandvermerk1 = xmlOfferDoc.createElement("field");
            fieldVersandvermerk1.setAttribute("name", "Versandvermerk");
            fieldVersandvermerk1.innerHTML = document.getElementById("Versandvermerk").value;
            objectElem1.appendChild(fieldVersandvermerk1);

            let fieldZahlBedText1 = xmlOfferDoc.createElement("field");
            fieldZahlBedText1.setAttribute("name", "ZahlBedText");
            fieldZahlBedText1.innerHTML = document.getElementById("ZahlBedText").value;
            objectElem1.appendChild(fieldZahlBedText1);

            let zahlBedTextSelectElement = document.getElementById("ZahlBedText")
            let option = zahlBedTextSelectElement.options[zahlBedTextSelectElement.selectedIndex];
            let fieldZahlTage1 = xmlOfferDoc.createElement("field");
            fieldZahlTage1.setAttribute("name", "ZahlTage");
            fieldZahlTage1.innerHTML = option.getAttribute("zahlTage");
            objectElem1.appendChild(fieldZahlTage1);

            // Adresse BEGIN
            let objectAdresse1 = xmlOfferDoc.createElement("object");
            objectAdresse1.setAttribute("name", "Adresse");

            let objectAdresse1FieldApartnerName1 = xmlOfferDoc.createElement("field");
            objectAdresse1FieldApartnerName1.setAttribute("name", "ApartnerName");
            objectAdresse1FieldApartnerName1.innerHTML = document.getElementById("adresseApartnerName").value;
            objectAdresse1.appendChild(objectAdresse1FieldApartnerName1);

            let objectAdresse1FieldEmail1 = xmlOfferDoc.createElement("field");
            objectAdresse1FieldEmail1.setAttribute("name", "Email");
            objectAdresse1FieldEmail1.innerHTML = document.getElementById("adresseemail").value;
            objectAdresse1.appendChild(objectAdresse1FieldEmail1);

            let objectAdresse1FieldFirma11 = xmlOfferDoc.createElement("field");
            objectAdresse1FieldFirma11.setAttribute("name", "Firma1");
            objectAdresse1FieldFirma11.innerHTML = document.getElementById("adresseFirma1").value;
            objectAdresse1.appendChild(objectAdresse1FieldFirma11);

            let objectAdresse1FieldFirma21 = xmlOfferDoc.createElement("field");
            objectAdresse1FieldFirma21.setAttribute("name", "Firma2");
            objectAdresse1FieldFirma21.innerHTML = document.getElementById("adresseFirma2").value;
            objectAdresse1.appendChild(objectAdresse1FieldFirma21);

            let objectAdresse1FieldLkz1 = xmlOfferDoc.createElement("field");
            objectAdresse1FieldLkz1.setAttribute("name", "Lkz");
            objectAdresse1FieldLkz1.innerHTML = document.getElementById("adresseLkz").value;
            objectAdresse1.appendChild(objectAdresse1FieldLkz1);

            let objectAdresse1FieldOrt1 = xmlOfferDoc.createElement("field");
            objectAdresse1FieldOrt1.setAttribute("name", "Ort");
            objectAdresse1FieldOrt1.innerHTML = document.getElementById("adresseOrt").value;
            objectAdresse1.appendChild(objectAdresse1FieldOrt1);

            let objectAdresse1FieldPlz1 = xmlOfferDoc.createElement("field");
            objectAdresse1FieldPlz1.setAttribute("name", "Plz");
            objectAdresse1FieldPlz1.innerHTML = document.getElementById("adressePlz").value;
            objectAdresse1.appendChild(objectAdresse1FieldPlz1);

            let objectAdresse1FieldStrasse1 = xmlOfferDoc.createElement("field");
            objectAdresse1FieldStrasse1.setAttribute("name", "Strasse");
            objectAdresse1FieldStrasse1.innerHTML = document.getElementById("adresseStrasse").value;
            objectAdresse1.appendChild(objectAdresse1FieldStrasse1);

            let objectAdresse1FieldTelefon1 = xmlOfferDoc.createElement("field");
            objectAdresse1FieldTelefon1.setAttribute("name", "Telefon");
            objectAdresse1FieldTelefon1.innerHTML = document.getElementById("adresseTel").value;
            objectAdresse1.appendChild(objectAdresse1FieldTelefon1);

            objectElem1.appendChild(objectAdresse1);
            // Adresse END

            // Position BEGIN
            let objectPosition1 = xmlOfferDoc.createElement("object");
            objectPosition1.setAttribute("name", "Position");
            objectPosition1.innerHTML = "";

            let objectPosition1FieldArtikelNr1 = xmlOfferDoc.createElement("field");
            objectPosition1FieldArtikelNr1.setAttribute("name", "ArtikelNr");
            objectPosition1FieldArtikelNr1.innerHTML = "PLATTEN NACH MASS";
            objectPosition1.appendChild(objectPosition1FieldArtikelNr1);

            let objectPosition1FieldBaustein1 = xmlOfferDoc.createElement("field");
            objectPosition1FieldBaustein1.setAttribute("name", "Baustein");
            objectPosition1FieldBaustein1.innerHTML = "D";
            objectPosition1.appendChild(objectPosition1FieldBaustein1);

            let objectPosition1FieldBestellDatum1 = xmlOfferDoc.createElement("field");
            objectPosition1FieldBestellDatum1.setAttribute("name", "BestellDatum");
            objectPosition1FieldBestellDatum1.innerHTML = "2025.08.29 18:24:19";
            objectPosition1.appendChild(objectPosition1FieldBestellDatum1);

            let objectPosition1FieldBestellNr1 = xmlOfferDoc.createElement("field");
            objectPosition1FieldBestellNr1.setAttribute("name", "BestellNr");
            objectPosition1FieldBestellNr1.innerHTML = "43785403";
            objectPosition1.appendChild(objectPosition1FieldBestellNr1);

            let objectPosition1FieldBezeichnung1 = xmlOfferDoc.createElement("field");
            objectPosition1FieldBezeichnung1.setAttribute("name", "Bezeichnung");
            objectPosition1FieldBezeichnung1.innerHTML = "5mm PLEXIGLAS® XT farblos";
            objectPosition1.appendChild(objectPosition1FieldBezeichnung1);

            let objectPosition1FieldLangtextHtml1 = xmlOfferDoc.createElement("field");
            objectPosition1FieldLangtextHtml1.setAttribute("name", "LangtextHtml");
            objectPosition1FieldLangtextHtml1.innerHTML = "195mm x 535mm, Kanten entgratet";
            objectPosition1.appendChild(objectPosition1FieldLangtextHtml1);

            let objectPosition1FieldKommission1 = xmlOfferDoc.createElement("field");
            objectPosition1FieldKommission1.setAttribute("name", "Kommission");
            objectPosition1FieldKommission1.innerHTML = "K259397";
            objectPosition1.appendChild(objectPosition1FieldKommission1);

            let objectPosition1FieldLiefertermin1 = xmlOfferDoc.createElement("field");
            objectPosition1FieldLiefertermin1.setAttribute("name", "Liefertermin");
            objectPosition1FieldLiefertermin1.innerHTML = "";
            objectPosition1.appendChild(objectPosition1FieldLiefertermin1);

            let objectPosition1FieldMenge1 = xmlOfferDoc.createElement("field");
            objectPosition1FieldMenge1.setAttribute("name", "Menge");
            objectPosition1FieldMenge1.innerHTML = "10";
            objectPosition1.appendChild(objectPosition1FieldMenge1);

            let objectPosition1FieldPosNr1 = xmlOfferDoc.createElement("field");
            objectPosition1FieldPosNr1.setAttribute("name", "PosNr");
            objectPosition1FieldPosNr1.innerHTML = "10";
            objectPosition1.appendChild(objectPosition1FieldPosNr1);

            let objectPosition1FieldSachkontoNr1 = xmlOfferDoc.createElement("field");
            objectPosition1FieldSachkontoNr1.setAttribute("name", "SachkontoNr");
            objectPosition1FieldSachkontoNr1.innerHTML = "4022";
            objectPosition1.appendChild(objectPosition1FieldSachkontoNr1);

            let objectPosition1FieldPreis1 = xmlOfferDoc.createElement("field");
            objectPosition1FieldPreis1.setAttribute("name", "Preis");
            objectPosition1FieldPreis1.innerHTML = "9.8";
            objectPosition1.appendChild(objectPosition1FieldPreis1);

            let objectPosition1FieldMwStNr1 = xmlOfferDoc.createElement("field");
            objectPosition1FieldMwStNr1.setAttribute("name", "MwStNr");
            objectPosition1FieldMwStNr1.innerHTML = "20";
            objectPosition1.appendChild(objectPosition1FieldMwStNr1);

            let objectPosition1FieldMwStSatz1 = xmlOfferDoc.createElement("field");
            objectPosition1FieldMwStSatz1.setAttribute("name", "MwStSatz");
            objectPosition1FieldMwStSatz1.innerHTML = "20";
            objectPosition1.appendChild(objectPosition1FieldMwStSatz1);

            let objectPosition1FieldEinheit1 = xmlOfferDoc.createElement("field");
            objectPosition1FieldEinheit1.setAttribute("name", "Einheit");
            objectPosition1FieldEinheit1.innerHTML = "Stück";
            objectPosition1.appendChild(objectPosition1FieldEinheit1);

            objectElem1.appendChild(objectPosition1);
            // Position BEGIN

            businessobjectsRootElement.appendChild(objectElem1);
            xmlOfferDoc.appendChild(businessobjectsRootElement);

            let serializer = new XMLSerializer();
            let xmlOfferDocString = serializer.serializeToString(xmlOfferDoc);

            xmlOfferDocString = "<?xml version=\"1.0\" encoding=\"utf-8\"?>\n" + formatXml(xmlOfferDocString, "  ");

            document.getElementById("offerXml").innerHTML = xmlOfferDocString;
        }

        /**
         * thx to arcturus on Stackoverflow
         * https://stackoverflow.com/questions/376373/pretty-printing-xml-with-javascript
         * @param xml the XML String
         * @param tab intent optional indent value, default is tab (\t)
         * @returns formated XML
         */
        function formatXml(xml, tab) {
            let formatted = '', indent= '';
            tab = tab || '\t';
            xml.split(/>\s*</).forEach(function(node) {
                if (node.match( /^\/\w/ )) indent = indent.substring(tab.length); // decrease indent by one 'tab'
                formatted += indent + '<' + node + '>\r\n';
                if (node.match( /^<?\w[^>]*[^\/]$/ )) indent += tab;              // increase indent
            });
            return formatted.substring(1, formatted.length-3);
        }

        function onClickAdresseReiter() {
            console.log("Click Adresse");
        }

        function onClickLieferanschriftReiter() {
            alert("ToDo!");
        }

        function onClickRechnungsanschriftReiter() {
            alert("ToDo!");
        }

        function selectReiter(reiterId) {
            document.getElementById(reiterId).style.borderTopWidth = "2px";
            document.getElementById(reiterId).style.borderLeftWidth = "2px";
            document.getElementById(reiterId).style.borderBottomWidth = "1px";
            document.getElementById(reiterId).style.borderRightWidth = "1px";
            document.getElementById(reiterId).style.background = "#cdcdcd";

            //alert("Döner macht schöner");
        }

        document.addEventListener("DOMContentLoaded", function() {
            selectReiter("reiterAdresse");
        })

    </script>

</head>
<body style="margin: 0px; ">

<div style="display: flex; flex-flow: row; background-color: #ffdc14; background: linear-gradient(135deg, rgba(255,205,0,1) 0%, rgba(255,220,20,1) 35%, rgba(255,205,0,1) 100%);padding-left: 20px; justify-content: space-between;height:100px">
    <div style="display: flex; flex-flow: column;">
        <h1 style="display: flex;margin-top: 5px;margin-bottom: 2px;font-family: Khand, Helvetia, Arial, sans-serif; font-size: 34px; font-weight: 600; color:#000000;">TD Offer Generator</h1>
        <div style="display: flex; margin-top: 0px;margin-bottom: 15px;">Version 0.1.1&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;11.09.2025</div>
    </div>
    <img src="img/td_header.png" height="150px" style="; display: flex; justify-content: right; align-self: center;filter: drop-shadow(8px 8px 40px #FFB214);">
</div>

<style>
    .fullFormElementDiv {
        display: flex;
        flex-direction: row;
        margin: 5px;
    }

    .labelFormElementDiv {
        display: flex;
        width: 150px;
    }

    .inputFormElementDiv {
        display: flex;
        width: 500px;
    }

    .formAtAllDiv {
        display: flex;
        flex-direction: column;
        margin-top: 10px;
        margin-left: auto;
        margin-right: auto;
        max-width: 800px;
    }

    .inputElement {
        display: flex;
        width: 100%;
    }

    .adressContainerDiv {
        display: flex;
        flex-direction: column;
        margin: 5px;
        padding-top: 0px;
        padding-left: 0px;
        padding-right: 10px;
        padding-bottom: 10px;
        border : solid 1px #565656;
    }

    .adressReiterDiv {
        display: flex;
        flex-direction: column;
    }

    .reiterButtonContainerDiv {
        display: flex;
        flex-direction: row;
    }
    .reiterElementDiv {
        width: 150px;
        display: flex;
        margin-top: 0px;
        margin-left: 0px;
        margin-right: 0px;
        margin-bottom: 10px;
        cursor: pointer;
        border-top: solid 1px #565656;
        border-left: solid 1px #565656;
        border-bottom: solid 2px #565656;
        border-right: solid 2px #565656;
        background: #ffffff;
        padding-top: 10px;
        padding-bottom: 10px;
        justify-content: center;
    }

    .positionenTextHeadlineDiv {
        display: flex;
    }

    .positionenHeadlineContainerDiv {
        display: flex;
        align-items: center;
    }

    .addPositionenButtonDiv {
        display: flex;
        cursor: pointer;
        width:28px;
        height: 28px
    }

    .positionenContainerDiv {
        display: flex;
        flex-direction: column;
    }

    .singlePositionContainerDivClass {
        display: flex;
        flex-direction: row;
    }

    .positionDeleteButtonDivClass {
        display: flex;
        cursor: pointer;
        width:28px;
        height: 28px
    }

    .positionPosDivClass {
        display: flex;
        margin-top: auto;
        margin-bottom: auto;
    }

    .positionBausteinDivClass {
        display: flex;
    }

    .positionArtikelNrDivClass {
        display: flex;
    }

    .positionBezeichnungDivClass {
        display: flex;
    }

    .positionLengthDivClass {
        display: flex;
    }

    .positionWidthDivClass {
        display: flex;
    }

    .positionAnzahlDivClass {
        display: flex;
    }

    .positionEinheitDivClass {
        display: flex;
    }
</style>

<div style="" class="formAtAllDiv">

    <!-- MitarbeiterNr -->
    <div style="" class="fullFormElementDiv">
        <div style="" class="labelFormElementDiv">
            <label for="MitarbeiterNr">Mitarbeiter:</label>
        </div>
        <div style="" class="inputFormElementDiv">
            <select id="MitarbeiterNr" name="MitarbeiterNr" class="inputElement">
                <option value=""></option>
                <option value="LST">Ludwig</option>
                <option value="RRI">Richard</option>
                <option value="SSC">Silvia</option>
                <option value="MMU">Martina</option>
            </select>
        </div>
    </div>

    <!-- Versandart -->
    <div style="" class="fullFormElementDiv">
        <div style="" class="labelFormElementDiv">
            <label for="Versandart">Versandart:</label>
        </div>
        <div style="" class="inputFormElementDiv">
            <select id="Versandart" name="Versandart" class="inputElement">
                <option value=""></option>
                <option value="AA">Abholung Aviso</option>
                <option value="Post">Post</option>
                <option value="o">Bis datto undefiniert ob Abholung oder Versand</option>
                <option value="AB">Zahlung bei Abholung</option>
                <option value="u">Unfrei</option>
                <option value="Zust">Zustellung</option>
                <option value="Sped">Spedition</option>
                <option value="BO">Botendienst</option>
                <option value="uu">Unfrei Unverzollt</option>
                <option value="M">Montage</option>
            </select>
        </div>
    </div>

    <!-- Versandart -->
    <div style="" class="fullFormElementDiv">
        <div style="" class="labelFormElementDiv">
            <label for="ZahlBedText">Zahlungs Bed:</label>
        </div>
        <div style="" class="inputFormElementDiv">
            <select id="ZahlBedText" name="ZahlBedText" class="inputElement">
                <option zahlTage="0" value=""></option>
                <option zahlTage="30" value = "14 Tage 2%, 30 Tage netto">14 Tage 2%, 30 Tage netto</option>
                <option zahlTage="0" value = "Vorauskasse">Vorauskasse</option>
                <option zahlTage="0" value = "zahlbar bei Abholung">zahlbar bei Abholung</option>
                <option zahlTage="30" value = "14 Tage 3%, 30 Tage netto">14 Tage 3%, 30 Tage netto</option>
                <option zahlTage="0" value = "bei Erstbestellung: zahlbar bei Abholung oder Vorauskassa">bei Erstbestellung: zahlbar bei Abholung oder Vorauskassa</option>
                <option zahlTage="0" value = "zahlbar bei Abholung oder Vorauskassa">zahlbar bei Abholung oder Vorauskassa</option>
                <option zahlTage="10" value = "10 Tage netto">10 Tage netto</option>
                <option zahlTage="0" value = "bei Erstbestellung: zahlbar bei Abholung, Vorauskassa oder Nachnahme">bei Erstbestellung: zahlbar bei Abholung, Vorauskassa oder Nachnahme</option>
                <option zahlTage="0" value = "zahlbar bei Abholung, Vorauskassa oder Nachnahme">zahlbar bei Abholung, Vorauskassa oder Nachnahme</option>
                <option zahlTage="60" value = "30 Tage 3%, 60 Tage netto">30 Tage 3%, 60 Tage netto</option>
                <option zahlTage="30" value = "10 Tage 3%, 30 Tage netto">10 Tage 3%, 30 Tage netto</option>
                <option zahlTage="30" value = "10 Tage 2%, 30 Tage netto">10 Tage 2%, 30 Tage netto</option>
                <option zahlTage="60" value = "30 Tage 5%, 60 Tage netto">30 Tage 5%, 60 Tage netto</option>
                <option zahlTage="60" value = "14 Tage 3%, 60 Tage netto">14 Tage 3%, 60 Tage netto</option>
                <option zahlTage="30" value = "21 Tage 3%, 30 Tage netto">21 Tage 3%, 30 Tage netto</option>
                <option zahlTage="90" value = "30 Tage 3%, 90 Tage netto">30 Tage 3%, 90 Tage netto</option>
                <option zahlTage="0" value = "sofort nach Rechnungserhalt ohne Abzug">sofort nach Rechnungserhalt ohne Abzug</option>
                <option zahlTage="60" value = "60 Tage netto">60 Tage netto</option>
                <option zahlTage="0" value = "bei Erstbestellung: Vorauskassa oder Nachnahme">bei Erstbestellung: Vorauskassa oder Nachnahme</option>
                <option zahlTage="0" value = "bei Erstbestellung: zahlbar bei Abholung, Vorauskassa oder Nachnahme (NN-Gebühr 20,-- + 20% MWST.)">bei Erstbestellung: zahlbar bei Abholung, Vorauskassa oder Nachnahme (NN-Gebühr 20,-- + 20% MWST.)</option>
                <option zahlTage="30" value = "21 Tage 2% Skonto, 30 Tage netto">21 Tage 2% Skonto, 30 Tage netto</option>
                <option zahlTage="0" value = "zahlbar bei Abholung, Vorauskassa oder Nachnahme (NN-Gebühr 20,-- + 20% MWST.)">zahlbar bei Abholung, Vorauskassa oder Nachnahme (NN-Gebühr 20,-- + 20% MWST.)</option>
                <option zahlTage="0" value = "Vorauskassa oder Nachnahme">Vorauskassa oder Nachnahme</option>
                <option zahlTage="0" value = "bei Erstbestellung: zahlbar bei Abholung">bei Erstbestellung: zahlbar bei Abholung</option>
                <option zahlTage="0" value = "Zahlung per Nachnahme">Zahlung per Nachnahme</option>
                <option zahlTage="60" value = "14 Tage 2%, 60 Tage netto">14 Tage 2%, 60 Tage netto</option>
                <option zahlTage="30" value = "30 Tage netto">30 Tage netto</option>
                <option zahlTage="0" value = "bei Erstbestellung: Vorauskassa">bei Erstbestellung: Vorauskassa</option>
                <option zahlTage="7" value = "7 Tage netto">7 Tage netto</option>
                <option zahlTage="30" value = "19 Tage 3%, 30 Tage netto">19 Tage 3%, 30 Tage netto</option>
                <option zahlTage="30" value = "7 Tage 5%, 14 Tage 3%, 30 Tage netto">7 Tage 5%, 14 Tage 3%, 30 Tage netto</option>
                <option zahlTage="45" value = "14 Tage 2%, 45 Tage netto">14 Tage 2%, 45 Tage netto</option>
                <option zahlTage="0" value = "nach Vereinbarung">nach Vereinbarung</option>
                <option zahlTage="0" value = "prepayment">prepayment</option>
                <option zahlTage="0" value = "zahlbar bei Zustellung">zahlbar bei Zustellung</option>
                <option zahlTage="90" value = "30 Tage 3%, 45 Tage 2%, 90 Tage netto">30 Tage 3%, 45 Tage 2%, 90 Tage netto</option>
                <option zahlTage="30" value = "7 Tage 3%, 30 Tage netto">7 Tage 3%, 30 Tage netto</option>
            </select>
        </div>
    </div>

    <!-- IhreZeichen -->
    <div style="" class="fullFormElementDiv">
        <div style="" class="labelFormElementDiv">
            <label for="IhreZeichen">IhreZeichen:</label>
        </div>
        <div style="" class="inputFormElementDiv">
            <input type="text" id="IhreZeichen" name="IhreZeichen" class="inputElement"/>
        </div>
    </div>

    <!-- Lieferzeit -->
    <div style="" class="fullFormElementDiv">
        <div style="" class="labelFormElementDiv">
            <label for="Lieferzeit">Lieferzeit:</label>
        </div>
        <div style="" class="inputFormElementDiv">
            <input type="text" id="Lieferzeit" name="Lieferzeit" class="inputElement"/>
        </div>
    </div>

    <!-- Versandvermerk -->
    <div style="" class="fullFormElementDiv">
        <div style="" class="labelFormElementDiv">
            <label for="Versandvermerk">Versandvermerk:</label>
        </div>
        <div style="" class="inputFormElementDiv">
            <input type="text" id="Versandvermerk" name="Versandvermerk" class="inputElement"/>
        </div>
    </div>

    <!-- LiefBedText -->
    <div style="" class="fullFormElementDiv">
        <div style="" class="labelFormElementDiv">
            <label for="LiefBedText">Liefer Bedingung:</label>
        </div>
        <div style="" class="inputFormElementDiv">
            <select id="LiefBedText" name="LiefBedText" class="inputElement">
                <option value=""></option>
                <option value="ab Werk, unverpackt">ab Werk, unverpackt</option>
                <option value="Versand unfrei">Versand unfrei</option>
                <option value="Frei Haus">Frei Haus</option>
                <option value="Zustellung unfrei">Zustellung unfrei</option>
                <option value="Versand unfrei - Spedition">Versand unfrei - Spedition</option>
                <option value="Versand unfrei, unverzollt">Versand unfrei, unverzollt</option>
                <option value="ab Werk">ab Werk</option>
                <option value="ab Werk, verpackt">ab Werk, verpackt</option>
            </select>
        </div>
    </div>


    <!-- BEGIN Adress Reiter Container -->
    <div style="" class="adressContainerDiv">
        <div style="" class="reiterButtonContainerDiv">
            <div id="reiterAdresse" style="" class="reiterElementDiv" onclick="onClickAdresseReiter()">
                Adresse
            </div>
            <div id="reiterLieferanschrift" style="" class="reiterElementDiv" onclick="onClickLieferanschriftReiter()">
                Lieferanschrift
            </div>
            <div id="reiterRechnungsanschrift" style="" class="reiterElementDiv" onclick="onClickRechnungsanschriftReiter()">
                Rechnungsanschrift
            </div>
        </div>
        <!-- BEGIN Adresse Reiter -->
        <div style="" class="adressReiterDiv">

            <!-- Aasprech Partner Name -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="adresseApartnerName">Name:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="text" id="adresseApartnerName" name="adresseApartnerName" class="inputElement"/>
                </div>
            </div>

            <!-- email -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="adresseemail">E-Mail:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="email" id="adresseemail" name="adresseemail" class="inputElement"/>
                </div>
            </div>

            <!-- Firma1 -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="adresseFirma1">Firma1:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="text" id="adresseFirma1" name="adresseFirma1" class="inputElement"/>
                </div>
            </div>

            <!-- Firma2 -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="adresseFirma2">Firma2:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="text" id="adresseFirma2" name="adresseFirma2" class="inputElement"/>
                </div>
            </div>

            <!-- Lkz -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="adresseLkz">Land:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <select id="adresseLkz" name="adresseLkz" class="inputElement">
                        <option value=""></option>
                        <option value="AT">Österreich</option>
                        <option value="DE">Deutschland</option>
                        <option value="CH">Schweiz</option>
                        <option value="IT">Italien</option>
                        <option value="SI">Slowenien</option>
                        <option value="NL">Holland</option>
                        <option value="LU">Luxenburg</option>
                        <option value="HU">Ungarn</option>
                        <option value="SK">Slowakei</option>
                        <option value="ES">Spanien</option>
                        <option value="FR">Frankreich</option>
                        <option value="CZ">Tschechien</option>
                        <option value="LI">Liechtenstein</option>
                        <option value="PL">Polen</option>
                        <option value="HR">Kroatien</option>
                        <option value="RO">Rumänien</option>
                        <option value="GB">Großbritannien</option>
                    </select>
                </div>
            </div>

            <!-- Ort -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="adresseOrt">Ort:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="text" id="adresseOrt" name="adresseOrt" class="inputElement"/>
                </div>
            </div>

            <!-- Plz -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="adressePlz">Postleitzahl:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="text" id="adressePlz" name="adressePlz" class="inputElement"/>
                </div>
            </div>

            <!-- Strasse -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="adresseStrasse">Strasse:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="text" id="adresseStrasse" name="adresseStrasse" class="inputElement"/>
                </div>
            </div>

            <!-- Tel -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="adresseTel">Tel:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="tel" id="adresseTel" name="adresseTel" class="inputElement"/>
                </div>
            </div>
        </div> <!-- END Adresse Reiter -->
    </div> <!-- END Adress Reiter Container -->

    <div class="positionenHeadlineContainerDiv">
        <div class="addPositionenButtonDiv" onclick="addPosition()">
            <svg width="28" height="28" viewBox="0 0 56 56" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
                <defs>
                    <linearGradient id="addGradient" x1="0" y1="0" x2="1" y2="1">
                        <stop offset="0" stop-color="#00aac8"/>
                        <stop offset="1" stop-color="#0096be"/>
                    </linearGradient>
                </defs>
                <rect x="0.5" y="0.5" width="55" height="55" rx="12" fill="url(#addGradient)" filter="url(#shadow)"/>
                <g stroke="#ffffff" stroke-width="3.6" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M28 17.5 L28 38.5" />
                    <path d="M17.5 28 L38.5 28" />
                </g>
            </svg>
        </div>
        <div class="positionenTextHeadlineDiv"> Positionen </div>
    </div>
    <!-- BEGIN POSITIONEN DIV -->
    <div id="positionenContainer" class="positionenContainerDiv">

    </div>

</div>

<button onclick="doCreateOffer()">Erstelle Angebotsdatei</button>
<br>
<textarea id="offerXml" style="width: 600px; height: 800px"></textarea>

</body>
</html>