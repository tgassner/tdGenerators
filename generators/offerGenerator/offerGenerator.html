<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <link rel="icon" href="img/favicon114.png" sizes="32x32" />
    <link rel="icon" href="img/favicon114.png" sizes="192x192" />
    <link rel="apple-touch-icon" href="img/favicon114.png" />
    <meta name="msapplication-TileImage" content="img/favicon114.png" />

    <script src="js/autoComplete.min.js"></script>
    <link rel="stylesheet" href="css/autoComplete.min.css">

    <title>Transparentdesign Offer Generator</title>

    <script>

        window.addEventListener("beforeunload", function (event) {
            //if (formNochNichtGespeichert()) {
                event.preventDefault(); // notwendig in modernen Browsern
                //event.returnValue = ""; // Chrome, Edge, Firefox
            //}
        });

        function deletePosition(posNumber) {
            document.getElementById("singlePositionenContainerDiv" + posNumber).remove();
            document.getElementById("posLangTextDiv" + posNumber).remove();
            let posElements = document.getElementsByName("positionHiddenPos");
            if (posElements.length <= 0) {
                Array.from(document.getElementsByClassName("posHeader")).forEach(element => {
                    element.classList.add("hideAtStartup");
                })
            }
        }

        function expandLangtextPosition(posNumber) {
            document.getElementById("posLangTextTextArea" + posNumber).classList.remove("hiddenClass");
            let collapseDiv = document.getElementById("positionCollapseLangTextButtonDiv" + posNumber);
            collapseDiv.classList.remove("hiddenClass")
            let expandDiv = document.getElementById("positionExpandLangTextButtonDiv" + posNumber);
            expandDiv.classList.add("hiddenClass");
        }

        function collapseLangtextPosition(posNumber) {
            document.getElementById("posLangTextTextArea" + posNumber).classList.add("hiddenClass");
            document.getElementById("positionCollapseLangTextButtonDiv" + posNumber).classList.add("hiddenClass");
            document.getElementById("positionExpandLangTextButtonDiv" + posNumber).classList.remove("hiddenClass");
        }

        function createDivWithClassname(classname) {
            let divElement = document.createElement('div');
            divElement.classList.add(classname);
            return divElement;
        }

        function createInputWithTypeAndId(type, id, name = "", value = "", cssClass = "") {
            let inputElement = document.createElement('input');
            inputElement.type = type;
            inputElement.id = id;
            if (name) {
                inputElement.name = name;
            }
            if (value) {
                inputElement.value = value;
            }

            if (cssClass) {
                inputElement.classList.add(cssClass);
            }

            inputElement.autocomplete = "off";
            inputElement.spellcheck = false;
            inputElement.autocapitalize = "sentence";

            return inputElement;
        }

        function createSelectOptionAndAddToList(value, text, selectElement, selected = false) {
            let optionElement = document.createElement('option');
            optionElement.value = value;
            optionElement.innerHTML = text;
            optionElement.selected = selected;
            selectElement.appendChild(optionElement);
            return optionElement;
        }

        function calculateNewPosNr() {
            let posElements = document.getElementsByName("positionHiddenPos");

            let maxPos = posElements.length * 10;
            if (posElements) {
                posElements.forEach(pos => {
                    let intValue =  parseInt(pos.value, 10);
                    maxPos = (intValue > maxPos) ? intValue : maxPos;
                })
            }

            return maxPos + 10;
        }

        function isNumeric(str) {
            if (typeof str != "string") return false // we only process strings!
            return !isNaN(str) && // use type coercion to parse the _entirety_ of the string (`parseFloat` alone does not do this)...
                !isNaN(parseFloat(str)) // ...and ensure strings of whitespace fail
        }

        function calcGesamtPreis(posNumber) {
            console.log("PosNumber= " + posNumber);
            let mengeElement = document.getElementById('positionMengeInput' + posNumber);
            let preisElement = document.getElementById('positionPreisInput' + posNumber);


            if (!mengeElement || ! preisElement) {
                document.getElementById("positionGesamtpreisInput" + posNumber).value = "";
                return;
            }

            let mengeValueString = mengeElement.value;
            let preisValueString = preisElement.value;
            console.log("mengeValueString= " + mengeValueString);
            console.log("preisValueString= " + preisValueString);
            console.log("-------------------------");

            if (!isNumeric(mengeValueString) || !isNumeric(preisValueString)) {
                document.getElementById("positionGesamtpreisInput" + posNumber).value = "";
                return;
            }

            mengeValueNumber = parseFloat(mengeValueString);
            preisValueNumber = parseFloat(preisValueString);

            let gesamtPreisNumber = mengeValueNumber * preisValueNumber;

            document.getElementById("positionGesamtpreisInput" + posNumber).value = gesamtPreisNumber;
        }

        function addPosition() {
            // Show Healine of Pos Table if not already
            let posHeadlineElementsAreNowHidden = document.getElementsByClassName("hideAtStartup");
            if (posHeadlineElementsAreNowHidden) {
                Array.from(posHeadlineElementsAreNowHidden).forEach(element => {
                    element.classList.remove("hideAtStartup");
                })
            }

            let posContainer = document.getElementById("positionenContainerGridDiv");
            let newPosNumber = calculateNewPosNr();

            let singlePositionContainerDiv = createDivWithClassname('singlePositionContainerDivClass');
            singlePositionContainerDiv.id = "singlePositionenContainerDiv" + newPosNumber;
            posContainer.appendChild(singlePositionContainerDiv);

            let positionDeleteButtonDiv = createDivWithClassname('positionDeleteButtonDivClass');
            let deleteImgElem = document.createElement("img");
            deleteImgElem.src = "img/delete.svg";
            deleteImgElem.alt = "Delete Button";
            positionDeleteButtonDiv.appendChild(deleteImgElem);
            positionDeleteButtonDiv.addEventListener('click', () => deletePosition(newPosNumber));
            singlePositionContainerDiv.appendChild(positionDeleteButtonDiv);

            // Position - Pos
            let positionPosDiv = createDivWithClassname('positionPosDivClass');
            positionPosDiv.innerHTML = newPosNumber;
            let positionHiddenPosIdInput = createInputWithTypeAndId("hidden", "positionHiddenPosId" + newPosNumber, "positionHiddenPos", newPosNumber + "");
            positionPosDiv.appendChild(positionHiddenPosIdInput);
            singlePositionContainerDiv.appendChild(positionPosDiv);

            // Baustein
            let positionBausteinDiv = createDivWithClassname('positionBausteinDivClass');
            let positionBausteinSelect = document.createElement('select');
            let positionBausteinSelectElementId = "positionBausteinSelect" + newPosNumber;
            positionBausteinSelect.id = positionBausteinSelectElementId;
            positionBausteinSelect.classList.add("positionBausteinSelectClass");
            createSelectOptionAndAddToList("", "", positionBausteinSelect);
            createSelectOptionAndAddToList("D", "D", positionBausteinSelect);
            createSelectOptionAndAddToList("F", "F", positionBausteinSelect);
            createSelectOptionAndAddToList("T", "T", positionBausteinSelect);
            createSelectOptionAndAddToList("Z", "Z", positionBausteinSelect);
            positionBausteinDiv.appendChild(positionBausteinSelect);
            singlePositionContainerDiv.appendChild(positionBausteinDiv);

            // Artikel Nr
            let positionArtikelNrDiv = createDivWithClassname("positionArtikelNrDivClass");
            let artikelNrInputElementId = "positionArtikelNrInput" + newPosNumber;
            let positionArtikelNrInput = createInputWithTypeAndId("text", artikelNrInputElementId, null, null, "positionArtikelNrInputClass");
            positionArtikelNrInput.spellcheck = false;
            positionArtikelNrInput.autocomplete = "off";
            positionArtikelNrInput.autocorrect = "off";
            positionArtikelNrInput.autocapitalize = "off";
            positionArtikelNrDiv.appendChild(positionArtikelNrInput);
            singlePositionContainerDiv.appendChild(positionArtikelNrDiv);

            // Bezeichnung
            let positionBezeichnungDiv = createDivWithClassname('positionBezeichnungDivClass');
            let artikelBezeichnungInputElementId = "positionBezeichnungInput" + newPosNumber;
            let positionBezeichnungInput = createInputWithTypeAndId("text", artikelBezeichnungInputElementId, null, null, "positionBezeichnungInputClass");
            positionBezeichnungDiv.appendChild(positionBezeichnungInput);
            singlePositionContainerDiv.appendChild(positionBezeichnungDiv);

            // Länge
            let positionLengthDiv = createDivWithClassname('positionLengthDivClass');
            let positionLengthInput = createInputWithTypeAndId("number", "positionLengthInput" + newPosNumber, null, null, "positionLengthInputClass");
            positionLengthDiv.appendChild(positionLengthInput);
            singlePositionContainerDiv.appendChild(positionLengthDiv);

            // Breite
            let positionWidthDiv = createDivWithClassname('positionWidthDivClass');
            let positionWidthInput = createInputWithTypeAndId("number", "positionWidthInput" + newPosNumber, null, null, "positionWidthInputClass");
            positionWidthDiv.appendChild(positionWidthInput);
            singlePositionContainerDiv.appendChild(positionWidthDiv);

            // Anzahl
            let positionAnzahlDiv = createDivWithClassname('positionAnzahlDivClass');
            let positionAnzahlInput = createInputWithTypeAndId("number", "positionAnzahlInput" + newPosNumber, null, null, "positionAnzahlInputClass");
            positionAnzahlDiv.appendChild(positionAnzahlInput);
            singlePositionContainerDiv.appendChild(positionAnzahlDiv);

            // Menge
            let positionMengeDiv = createDivWithClassname('positionMengeDivClass');
            let positionMengeInput = createInputWithTypeAndId("number", "positionMengeInput" + newPosNumber, null, null, "positionMengeInputClass");
            positionMengeInput.addEventListener('change', () => calcGesamtPreis(newPosNumber));
            positionMengeDiv.appendChild(positionMengeInput);
            singlePositionContainerDiv.appendChild(positionMengeDiv);

            // Einheit
            let positionEinheitDiv = createDivWithClassname('positionEinheitDivClass');
            let positionEinheitList = document.createElement('select');
            let positionEinheitSelectElementId = "positionEinheitSelect" + newPosNumber;
            positionEinheitList.id = positionEinheitSelectElementId;
            positionEinheitList.classList.add("positionEinheitListSelectClass");
            createSelectOptionAndAddToList("", "", positionEinheitList);
            createSelectOptionAndAddToList("Stück", "Stück", positionEinheitList);
            createSelectOptionAndAddToList("m²", "m²", positionEinheitList);
            createSelectOptionAndAddToList("m", "m", positionEinheitList);
            createSelectOptionAndAddToList("Set", "Set", positionEinheitList);
            createSelectOptionAndAddToList("Pau", "Pau", positionEinheitList);
            createSelectOptionAndAddToList("Stk", "Stk", positionEinheitList);
            createSelectOptionAndAddToList("Std", "Std", positionEinheitList);
            createSelectOptionAndAddToList("lfm", "lfm", positionEinheitList);
            createSelectOptionAndAddToList("Paar", "Paar", positionEinheitList);
            createSelectOptionAndAddToList("min", "min", positionEinheitList);
            createSelectOptionAndAddToList("km", "km", positionEinheitList);
            positionEinheitDiv.appendChild(positionEinheitList);
            singlePositionContainerDiv.appendChild(positionEinheitDiv);

            // Preis
            let positionPreisDiv = createDivWithClassname('positionPreisDivClass');
            let positionPreisInputElementId = "positionPreisInput" + newPosNumber;
            let positionPreisInput = createInputWithTypeAndId("number", positionPreisInputElementId, null, null, "positionPreisInputClass");
            positionPreisInput.addEventListener('change', () => calcGesamtPreis(newPosNumber));
            positionPreisDiv.appendChild(positionPreisInput);
            singlePositionContainerDiv.appendChild(positionPreisDiv);

            // Rabatt
            let positionRabattDiv = createDivWithClassname('positionRabattDivClass');
            let positionRabattInput = createInputWithTypeAndId("number", "positionRabattInput" + newPosNumber, null, null, "positionRabattInputClass");
            positionRabattDiv.appendChild(positionRabattInput);
            singlePositionContainerDiv.appendChild(positionRabattDiv);

            // Gesamtpreis  = Preis * Menge
            let positionGesamtpreisDiv = createDivWithClassname('positionGesamtpreisDivClass');
            let positionGesamtpreisInput = createInputWithTypeAndId("number", "positionGesamtpreisInput" + newPosNumber, null, null, "positionGesamtpreisInputClass");
            positionGesamtpreisDiv.appendChild(positionGesamtpreisInput);
            singlePositionContainerDiv.appendChild(positionGesamtpreisDiv);

            let positionExpandAndCollapseLangTextButtonDiv = createDivWithClassname('positionExpandAndCollapseLangTextButtonDivClass');
            singlePositionContainerDiv.appendChild(positionExpandAndCollapseLangTextButtonDiv);

            // expand Langtext
            let positionExpandLangTextButtonDiv = createDivWithClassname('positionExpandLangTextButtonDivClass');
            positionExpandLangTextButtonDiv.id = "positionExpandLangTextButtonDiv" + newPosNumber;
            let expandImgElem = document.createElement("img");
            expandImgElem.src = "img/expand.svg";
            expandImgElem.alt = "Aufklappen Button";
            positionExpandLangTextButtonDiv.appendChild(expandImgElem);
            positionExpandLangTextButtonDiv.addEventListener('click', () => expandLangtextPosition(newPosNumber));
            positionExpandAndCollapseLangTextButtonDiv.appendChild(positionExpandLangTextButtonDiv);

            // collapse Langtext
            let positionCollapseLangTextButtonDiv = createDivWithClassname('positionCollapseLangTextButtonDivClass');
            positionCollapseLangTextButtonDiv.id = "positionCollapseLangTextButtonDiv" + newPosNumber;
            let collapseImgElem = document.createElement("img");
            collapseImgElem.src = "img/collapse.svg";
            collapseImgElem.alt = "Einklappen Button";
            positionCollapseLangTextButtonDiv.appendChild(collapseImgElem);
            positionCollapseLangTextButtonDiv.addEventListener('click', () => collapseLangtextPosition(newPosNumber));
            positionCollapseLangTextButtonDiv.classList.add("hiddenClass");
            positionExpandAndCollapseLangTextButtonDiv.appendChild(positionCollapseLangTextButtonDiv);

            // LangText
            let posLangTextDiv = createDivWithClassname('posLangTextDivClass');
            posLangTextDiv.id = "posLangTextDiv" + newPosNumber;
            let posLangTextTextArea = document.createElement('textarea');
            posLangTextTextArea.classList.add("hiddenClass");
            posLangTextTextArea.id = "posLangTextTextArea" + newPosNumber;
            posLangTextTextArea.classList.add("posLangTextTextAreaClass");
            posLangTextDiv.appendChild(posLangTextTextArea);
            posContainer.appendChild(posLangTextDiv);

            // ADDING autocompletion
            if (allArticleData) {
                initAutoComplete(artikelNrInputElementId, artikelBezeichnungInputElementId, positionPreisInputElementId, positionEinheitSelectElementId, positionBausteinSelectElementId);
            }
    }

    function createXmlElement(document, parentElement, name, textContent = "", id, tag) {
        let element = document.createElement(tag);

        if (name) {
            element.setAttribute("name", name);
        }

        if (id) {
            element.setAttribute("id", id);
        }

        if (textContent) {
            element.textContent = textContent;
        }

        parentElement.appendChild(element);
        
        return element;
    }

    function createXmlField(document, parentElement, name, textContent = "") {
        return createXmlElement(document, parentElement, name, textContent, "", "field");
    }

    function createXmlObject(document, parentElement, name, textContent = "", id) {
        return createXmlElement(document, parentElement, name, textContent, id, "object");
    }

    function processLangtextHtml(planeLangtext) {
        //planeLangtext = planeLangtext.replaceAll("\n", "&#13;");
        //planeLangtext = planeLangtext.replace(/(?:\r\n|\r|\n)/g, "&#13;");

        const einzelneZeilen = planeLangtext.split('\n');

        let retZeilen = "";
        for (let i = 0; i < einzelneZeilen.length; i++) {
            retZeilen += "<p>" + einzelneZeilen[i] + "</p>";
        }

        return retZeilen;
    }

    function determineFilename() {
        let mitarbeiter = document.getElementById("MitarbeiterNr").value.trim();
        let currentDate = new Date();
        let dateTime = currentDate.getFullYear() + "-" + (currentDate.getMonth() + 1) + "-" + currentDate.getDate() + " " + currentDate.getHours() + "." + currentDate.getMinutes() + "." + currentDate.getSeconds();
        let auftragsnummer = document.getElementById("AuftragsNummer").value;
        return  ((mitarbeiter === "") ? "" : (mitarbeiter + " ")) + dateTime  + " " + auftragsnummer + ".xml";
    }

    function download(data) {
        let file = new Blob([data], {type: "application/xml"});
        let a = document.createElement("a"),
        url = URL.createObjectURL(file);
        a.href = url;
        a.download = determineFilename();
        document.body.appendChild(a);
        a.click();
        setTimeout(function () {
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }, 0);
    }

    function isOfferNumberAvailable() {
        let auftragsNummerElement = document.getElementById("AuftragsNummer");
        return auftragsNummerElement && auftragsNummerElement.value && auftragsNummerElement.value.trim().length > 0;
    }


    function doCreateOfferWithExistingAuftragsNummer() {
            let xmlOffDoc = document.implementation.createDocument("", "", null);

            let businessobjectsRootElement = createXmlElement(xmlOffDoc, xmlOffDoc, "", "", "", "businessobjects");

            // Offer / Angebot Object
            let objOfferElem = createXmlObject(xmlOffDoc, businessobjectsRootElement, "Angebot", "", "32");

            // Nr   - AngebotNummer
            createXmlField(xmlOffDoc, objOfferElem, "Nr", document.getElementById("AuftragsNummer").value);

            // AngebotArt
            createXmlField(xmlOffDoc, objOfferElem, "AngebotArt", "0");

            // AngebotTyp
            createXmlField(xmlOffDoc, objOfferElem, "AngebotTyp", "");

            // MitarbeiterNr
            createXmlField(xmlOffDoc, objOfferElem, "MitarbeiterNr", document.getElementById("MitarbeiterNr").value);

            // IhreZeichen
            createXmlField(xmlOffDoc, objOfferElem, "IhreZeichen", document.getElementById("IhreZeichen").value);

            // Lieferzeit
            createXmlField(xmlOffDoc, objOfferElem, "Lieferzeit", document.getElementById("Lieferzeit").value);

            // SachkontoNr
            createXmlField(xmlOffDoc, objOfferElem, "SachkontoNr", "4022");

            // MwStNr
            createXmlField(xmlOffDoc, objOfferElem, "MwStNr", "20");

            // LiefBedText
            createXmlField(xmlOffDoc, objOfferElem, "LiefBedText", document.getElementById("LiefBedText").value);

            //let fieldNr1 = xmlOffDoc.createElement("field");
            //fieldNr1.setAttribute("name", "Nr");
            //fieldNr1.textContent = "K259397";
            //objOfferElem.appendChild(fieldNr1);

            // Versandart
            createXmlField(xmlOffDoc, objOfferElem, "Versandart", document.getElementById("Versandart").value);
    
            // Versandvermerk
            createXmlField(xmlOffDoc, objOfferElem, "Versandvermerk", document.getElementById("Versandvermerk").value);

            // ZahlBedText
            createXmlField(xmlOffDoc, objOfferElem, "ZahlBedText", document.getElementById("ZahlBedText").value);

            // ZahlTage
            let zahlBedTextSelectElement = document.getElementById("ZahlBedText")
            let option = zahlBedTextSelectElement.options[zahlBedTextSelectElement.selectedIndex];
            let fieldZahlTage1 = xmlOffDoc.createElement("field");
            createXmlField(xmlOffDoc, objOfferElem, "ZahlTage", option.getAttribute("zahlTage"));

            // Adresse BEGIN
            let adresseElement = createXmlObject(xmlOffDoc, objOfferElem, "Adresse", "", "")
            // ApartnerName
            createXmlField(xmlOffDoc, adresseElement, "ApartnerName", document.getElementById("adresseApartnerName").value);
            // Email
            createXmlField(xmlOffDoc, adresseElement, "Email", document.getElementById("adresseemail").value);
            // Firma1
            createXmlField(xmlOffDoc, adresseElement, "Firma1", document.getElementById("adresseFirma1").value);
            // Firma2
            createXmlField(xmlOffDoc, adresseElement, "Firma2", document.getElementById("adresseFirma2").value);
            // Lkz
            createXmlField(xmlOffDoc, adresseElement, "Lkz", document.getElementById("adresseLkz").value);
            // Ort
            createXmlField(xmlOffDoc, adresseElement, "Ort", document.getElementById("adresseOrt").value);
            // Plz
            createXmlField(xmlOffDoc, adresseElement, "Plz", document.getElementById("adressePlz").value);
            // Strasse
            createXmlField(xmlOffDoc, adresseElement, "Strasse", document.getElementById("adresseStrasse").value);
            // Telefon
            createXmlField(xmlOffDoc, adresseElement, "Telefon", document.getElementById("adresseTel").value);
            // Adresse END

            // Lieferanschrift BEGIN
            let lieferAnschriftElement = createXmlObject(xmlOffDoc, objOfferElem, "Lieferanschrift", "", "")
            // ApartnerName
            createXmlField(xmlOffDoc, lieferAnschriftElement, "ApartnerName", document.getElementById("lieferanschriftApartnerName").value);
            // Email
            createXmlField(xmlOffDoc, lieferAnschriftElement, "Email", document.getElementById("lieferanschriftemail").value);
            // Firma1
            createXmlField(xmlOffDoc, lieferAnschriftElement, "Firma1", document.getElementById("lieferanschriftFirma1").value);
            // Firma2
            createXmlField(xmlOffDoc, lieferAnschriftElement, "Firma2", document.getElementById("lieferanschriftFirma2").value);
            // Lkz
            createXmlField(xmlOffDoc, lieferAnschriftElement, "Lkz", document.getElementById("lieferanschriftLkz").value);
            // Ort
            createXmlField(xmlOffDoc, lieferAnschriftElement, "Ort", document.getElementById("lieferanschriftOrt").value);
            // Plz
            createXmlField(xmlOffDoc, lieferAnschriftElement, "Plz", document.getElementById("lieferanschriftPlz").value);
            // Strasse
            createXmlField(xmlOffDoc, lieferAnschriftElement, "Strasse", document.getElementById("lieferanschriftStrasse").value);
            // Telefon
            createXmlField(xmlOffDoc, lieferAnschriftElement, "Telefon", document.getElementById("lieferanschriftTel").value);
            // Lieferanschrift END

            // Rechnungsanschrift BEGIN
            let rechnungsAnschriftElement = createXmlObject(xmlOffDoc, objOfferElem, "Rechnungsanschrift", "", "")
            // ApartnerName
            createXmlField(xmlOffDoc, rechnungsAnschriftElement, "ApartnerName", document.getElementById("rechnungsanschriftApartnerName").value);
            // Email
            createXmlField(xmlOffDoc, rechnungsAnschriftElement, "Email", document.getElementById("rechnungsanschriftemail").value);
            // Firma1
            createXmlField(xmlOffDoc, rechnungsAnschriftElement, "Firma1", document.getElementById("rechnungsanschriftFirma1").value);
            // Firma2
            createXmlField(xmlOffDoc, rechnungsAnschriftElement, "Firma2", document.getElementById("rechnungsanschriftFirma2").value);
            // Lkz
            createXmlField(xmlOffDoc, rechnungsAnschriftElement, "Lkz", document.getElementById("rechnungsanschriftLkz").value);
            // Ort
            createXmlField(xmlOffDoc, rechnungsAnschriftElement, "Ort", document.getElementById("rechnungsanschriftOrt").value);
            // Plz
            createXmlField(xmlOffDoc, rechnungsAnschriftElement, "Plz", document.getElementById("rechnungsanschriftPlz").value);
            // Strasse
            createXmlField(xmlOffDoc, rechnungsAnschriftElement, "Strasse", document.getElementById("rechnungsanschriftStrasse").value);
            // Telefon
            createXmlField(xmlOffDoc, rechnungsAnschriftElement, "Telefon", document.getElementById("rechnungsanschriftTel").value);
            // Rechnungsanschrift END


            // Positionen BEGIN
            let posElements = document.getElementsByName("positionHiddenPos");
            if (posElements) {
                posElements.forEach(pos => {
                    let posNumber = pos.value;

                    // object position
                    let posElement = createXmlObject(xmlOffDoc, objOfferElem, "Position", "", "");

                    // PosNr
                    createXmlField(xmlOffDoc, posElement, "PosNr", posNumber);

                    // Baustein
                    createXmlField(xmlOffDoc, posElement, "Baustein", document.getElementById("positionBausteinSelect" + posNumber).value);

                    // ArtikelNr
                    createXmlField(xmlOffDoc, posElement, "ArtikelNr", document.getElementById("positionArtikelNrInput" + posNumber).value);

                    // Bezeichnung
                    createXmlField(xmlOffDoc, posElement, "Bezeichnung", document.getElementById("positionBezeichnungInput" + posNumber).value);

                    freieFelderElement = createXmlObject(xmlOffDoc, posElement, "FreieFelder", "")

                    freiesFeldePosLaengeElement = createXmlObject(xmlOffDoc, freieFelderElement, "FreiesFeld", "")
                    createXmlField(xmlOffDoc, freiesFeldePosLaengeElement, "Name", "PosLaenge");
                    createXmlField(xmlOffDoc, freiesFeldePosLaengeElement, "Wert", document.getElementById("positionLengthInput" + posNumber).value);

                    freiesFeldePosLaengeEinheitElement = createXmlObject(xmlOffDoc, freieFelderElement, "FreiesFeld", "")
                    createXmlField(xmlOffDoc, freiesFeldePosLaengeEinheitElement, "Name", "PosLaengeEinheit");
                    createXmlField(xmlOffDoc, freiesFeldePosLaengeEinheitElement, "Wert", "mm");

                    freiesFeldePosBreiteElement = createXmlObject(xmlOffDoc, freieFelderElement, "FreiesFeld", "")
                    createXmlField(xmlOffDoc, freiesFeldePosBreiteElement, "Name", "PosBreite");
                    createXmlField(xmlOffDoc, freiesFeldePosBreiteElement, "Wert", document.getElementById("positionWidthInput" + posNumber).value);

                    freiesFeldePosBreiteEinheitElement = createXmlObject(xmlOffDoc, freieFelderElement, "FreiesFeld", "")
                    createXmlField(xmlOffDoc, freiesFeldePosBreiteEinheitElement, "Name", "PosBreiteEinheit");
                    createXmlField(xmlOffDoc, freiesFeldePosBreiteEinheitElement, "Wert", "mm");

                    freiesFeldePosAnzahlEinheitElement = createXmlObject(xmlOffDoc, freieFelderElement, "FreiesFeld", "")
                    createXmlField(xmlOffDoc, freiesFeldePosAnzahlEinheitElement, "Name", "PosAnzahl");
                    createXmlField(xmlOffDoc, freiesFeldePosAnzahlEinheitElement, "Wert", document.getElementById("positionAnzahlInput" + posNumber).value);

                    // Menge
                    createXmlField(xmlOffDoc, posElement, "Menge", document.getElementById("positionMengeInput" + posNumber).value);

                    // Einheit
                    createXmlField(xmlOffDoc, posElement, "Einheit", document.getElementById("positionEinheitSelect" + posNumber).value);

                    // Preis
                    createXmlField(xmlOffDoc, posElement, "Preis", document.getElementById("positionPreisInput" + posNumber).value);

                    // Rabatt
                    createXmlField(xmlOffDoc, posElement, "Rabatt", document.getElementById("positionRabattInput" + posNumber).value);

                    // Gesamtpreis
                    createXmlField(xmlOffDoc, posElement, "Gesamtpreis", document.getElementById("positionGesamtpreisInput" + posNumber).value);

                    // LangtextHtml
                    let langtext = document.getElementById("posLangTextTextArea" + posNumber).value;
                    createXmlField(xmlOffDoc, posElement, "LangtextHtml", processLangtextHtml(langtext));

                    // MwStNr
                    createXmlField(xmlOffDoc, posElement, "MwStNr", "20");

                    // MwStSatz
                    createXmlField(xmlOffDoc, posElement, "MwStSatz", "20");

                    // SachkontoNr
                    createXmlField(xmlOffDoc, posElement, "SachkontoNr", "4022");
                })
            }
            // Positionen BEGIN

            let serializer = new XMLSerializer();
            let xmlOfferDocString = serializer.serializeToString(xmlOffDoc);

            xmlOfferDocString = "<?xml version=\"1.0\" encoding=\"utf-8\"?>\n" + xmlOfferDocString;

            return xmlOfferDocString;
        }

        function doDownloadFile(syncronCall = true) {
            if (isOfferNumberAvailable()) {
                download(doCreateOfferWithExistingAuftragsNummer());
            } else {
                if (!syncronCall) {
                    determineAuftragsnummerFromServer(doDownloadFile);
                }
            }
        }

        function doShowFile(syncronCall = true) {
            document.getElementById("preViewDiv").style.display = "flex";
            if (isOfferNumberAvailable()) {
                document.getElementById("offerXmlPreView").innerHTML = formatXml(doCreateOfferWithExistingAuftragsNummer(), "  ");
            } else {
                if (!syncronCall) {
                    determineAuftragsnummerFromServer(doShowFile);
                }
            }
        }

        function doReset() {
            Array.from(document.getElementsByClassName("singlePositionContainerDivClass")).forEach(element => {
                element.remove();
            })

            Array.from(document.getElementsByClassName("posLangTextDivClass")).forEach(element => {
                element.remove();
            })

            Array.from(document.getElementsByTagName("input")).forEach(element => {
                element.value = "";
            })

            Array.from(document.getElementsByTagName("select")).forEach(element => {
                element.selectedIndex = 0;
            })


            document.getElementById("animationWaitStribeAuftragsNummer").style.display = "none";

            document.getElementById("AuftragsNummer").style.display = "inline-flex";
            document.getElementById("AuftragsNummer").value = "";

            document.getElementById("AuftragsHolenNummerButton").disabled = false;
            document.getElementById("AuftragsHolenNummerButton").style.display = "inline-flex";
            document.getElementById("downloadButton").disabled = false;
            document.getElementById("viewButton").disabled = false;
            document.getElementById("resetButton").disabled = false;

            document.getElementById("preViewDiv").style.display = "none";

            onClickAdresseReiter();
        }

        function determineAuftragsnummerFromServer(callBack) {
            document.getElementById("animationWaitStribeAuftragsNummer").style.display = "block";
            document.getElementById("AuftragsNummer").style.display = "none";
            let buttonAuftragHolen = document.getElementById("AuftragsHolenNummerButton");
            if (buttonAuftragHolen) {
                buttonAuftragHolen.disabled = true;
            }

            let buttonDownload = document.getElementById("downloadButton");
            if (buttonDownload) {
                buttonDownload.disabled = true;
            }

            let buttonView = document.getElementById("viewButton");
            if (buttonView) {
                buttonView.disabled = true;
            }

            fetch("OfferServiceRemoteCall.php?action=generateNewOfferNumber") // Call the fetch function passing the url of the API as a parameter
                .then(res => res.json())
                .then(function (res) {
                    let ok = res.ok;
                    let value = res.value;
                    let msg = res.msg;

                    if (!ok) {
                        alert(msg);
                        return;
                    }
                    document.getElementById("AuftragsNummer").value = value;
                    let button = document.getElementById("AuftragsHolenNummerButton");
                    if (button) {
                        button.style.display = "none";
                    }
                })
                .catch(function(e) {
                    alert("Sorry, something went wrong.\n" + e);
                    document.getElementById("AuftragsHolenNummerButton").enabled = false;
                }).finally(function () {
                    document.getElementById("AuftragsNummer").style.display = "block";
                    document.getElementById("animationWaitStribeAuftragsNummer").style.display = "none";
                    let button = document.getElementById("AuftragsHolenNummerButton");
                    if (button) {
                        button.disabled = false;
                    }

                    let buttonDownload = document.getElementById("downloadButton");
                    if (buttonDownload) {
                        buttonDownload.disabled = false;
                    }

                    let buttonView = document.getElementById("viewButton");
                    if (buttonView) {
                        buttonView.disabled = false;
                    }
                    callBack();
            });

        }

        /**
         * thx to arcturus on Stackoverflow
         * https://stackoverflow.com/questions/376373/pretty-printing-xml-with-javascript
         * @param xml the XML String
         * @param tab intent optional indent value, default is tab (\t)
         * @returns formated XML
         */
        function formatXml(xml, tab) {
            let formatted = '', indent= '';
            tab = tab || '\t';
            xml.split(/>\s*</).forEach(function(node) {
                if (node.match( /^\/\w/ )) indent = indent.substring(tab.length); // decrease indent by one 'tab'
                formatted += indent + '<' + node + '>\r\n';
                if (node.match( /^<?\w[^>]*[^\/]$/ )) indent += tab;              // increase indent
            });
            return formatted.substring(1, formatted.length-3);
        }

        function switchReiterAdresse(idOfEnabledButtons, idOfEnabledContent) {
            document.getElementById("reiterAdresse").classList.remove("reiterSelectedElementDiv");
            document.getElementById("reiterLieferanschrift").classList.remove("reiterSelectedElementDiv");
            document.getElementById("reiterRechnungsanschrift").classList.remove("reiterSelectedElementDiv");
            document.getElementById(idOfEnabledButtons).classList.add("reiterSelectedElementDiv");

            document.getElementById("reiterContentAdresse").style.display = "none";
            document.getElementById("reiterContentLieferanschrift").style.display = "none";
            document.getElementById("reiterContentRechnungsanschrift").style.display = "none";
            document.getElementById(idOfEnabledContent).style.display = "";
        }

        function onClickAdresseReiter() {
            switchReiterAdresse("reiterAdresse", "reiterContentAdresse");
        }

        function onClickLieferanschriftReiter() {
            switchReiterAdresse("reiterLieferanschrift", "reiterContentLieferanschrift");
        }

        function onClickRechnungsanschriftReiter() {
            switchReiterAdresse("reiterRechnungsanschrift", "reiterContentRechnungsanschrift");
        }

        function createStatusElement(status, text) {
            let okElement = document.createElement('span');
            switch (status) {
                case "ok":
                    okElement.style.color = "#AFC80A";
                    break;
                case "nok":
                    okElement.style.color = "#FF0000";
                    break;
                default:
                    okElement.style.color = "#000000";
                    break;
            }
            okElement.title = text;
            okElement.innerHTML = "&#xFFED;"
            return okElement;
        }

        document.addEventListener("DOMContentLoaded", function() {
            fetch("ArticleServiceRemoteCall.php?action=findAllProducts") // Call the fetch function passing the url of the API as a parameter
                .then(res => res.json())
                .then(function (res) {
                    let ok = res.ok;
                    let value = res.value;
                    let msg = res.msg;

                    if (!ok) {
                        document.getElementById("statusSpan").appendChild(createStatusElement("nok", msg));
                        return;
                    }

                    allArticleData = value;

                    document.getElementById("statusSpan").appendChild(createStatusElement("ok", "Article Data loaded Successfully!"));
                })
                .catch(function(e) {
                    document.getElementById("statusSpan").appendChild(createStatusElement("nok", "Sorry, something went wrong.\n" + e));
                }).finally(function () {
            });
        })

        function initAutoComplete(artikelNrInputElementId, artikelBezeichnungInputElementId, positionPreisInputElementId, positionEinheitSelectElementId, positionBausteinSelectElementId) {
            const autoCompleteJS = new autoComplete({
                selector: "#" + artikelNrInputElementId,
                data: { src: allArticleData, keys: ["Nr", "Bezeichnung"] },
                resultItem: {
                    highlight: true,
                    //selected: "autoComplete_selected"
                },
                resultsList: {
                    tabSelect : true,
                }
            });

            document.querySelector("#" + artikelNrInputElementId).addEventListener("selection", function (event) {
                if (event && event.detail && event.detail.selection && event.detail.selection.value) {
                    fillArticleWithAutocompletion(
                        positionBausteinSelectElementId,
                        artikelNrInputElementId,
                        artikelBezeichnungInputElementId,
                        positionPreisInputElementId,
                        positionEinheitSelectElementId,
                        event.detail.selection.value.Nr,
                        event.detail.selection.value.Bezeichnung,
                        event.detail.selection.value.KalkPreis,
                        event.detail.selection.value.Einheit);
                }
            });

            document.getElementById(artikelNrInputElementId).addEventListener("keydown", (e) => {
                if (e.key === "Enter" || e.key === "Tab") {
                    const val = e.target.value.trim();
                    // 1. In den aktuell geladenen Daten suchen
                    let artikel = allArticleData.find(a => a.Nr.toLowerCase() === val.toLowerCase());
                    if (artikel) {
                        if (e.key === "Enter") {
                            e.preventDefault(); // verhindert, dass das Formular direkt abgeschickt wird
                        }

                        fillArticleWithAutocompletion(
                            positionBausteinSelectElementId,
                            artikelNrInputElementId,
                            artikelBezeichnungInputElementId,
                            positionPreisInputElementId,
                            positionEinheitSelectElementId,
                            artikel.Nr,
                            artikel.Bezeichnung,
                            artikel.KalkPreis,
                            artikel.Einheit);
                        autoCompleteJS.close();
                    }
                }
            });
        }

        function fillArticleWithAutocompletion(
            positionBausteinSelectElementId,
            artikelNrInputElementId,
            artikelBezeichnungInputElementId,
            positionPreisInputElementId,
            positionEinheitSelectElementId,
            artikelNrValue,
            artikelBezeichnungValue,
            artikelKalkpreisValue,
            artikelEinheitValue) {

            let positionBaustrinElement = document.getElementById(positionBausteinSelectElementId);
            if (positionBaustrinElement) {
                positionBaustrinElement.value = "D";
            }

            let artikelNummerElement = document.getElementById(artikelNrInputElementId);
            if (artikelNummerElement) {
                artikelNummerElement.value = artikelNrValue;
            }

            let artikelBezeichnungElement = document.getElementById(artikelBezeichnungInputElementId);
            if (artikelBezeichnungElement) {
                artikelBezeichnungElement.value = artikelBezeichnungValue;
            }

            let preisElement = document.getElementById(positionPreisInputElementId);
            if (preisElement) {

                let preis = parseFloat(artikelKalkpreisValue);
                if (preis !== Number.NaN) {
                    preisElement.value = preis.toFixed(2);
                }
            }

            let bausteinElement = document.getElementById(positionEinheitSelectElementId);
            if (bausteinElement) {
                bausteinElement.value = artikelEinheitValue;
            }
        }

        var allArticleData = null;
    </script>

</head>
<body style="margin: 0px; ">

<div style="display: flex; flex-flow: row; background-color: #ffdc14; background: linear-gradient(135deg, rgba(255,205,0,1) 0%, rgba(255,220,20,1) 35%, rgba(255,205,0,1) 100%);padding-left: 20px; justify-content: space-between;height:100px">
    <div style="display: flex; flex-flow: column;">
        <h1 style="display: flex;margin-top: 5px;margin-bottom: 2px;font-family: Khand, Helvetia, Arial, sans-serif; font-size: 34px; font-weight: 600; color:#000000;">TD Offer Generator</h1>
        <div style="display: flex; margin-top: 0px;margin-bottom: 15px;">Version 0.9.3&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;29.09.2025 <span id="statusSpan" style="margin-left: 10px"> </span></div>
    </div>
    <img src="img/td_header.png" height="150px" style="; display: flex; justify-content: right; align-self: center;filter: drop-shadow(8px 8px 40px #FFB214);">
</div>

<style>
    .fullFormElementDiv {
        display: flex;
        flex-direction: row;
        margin: 5px;
    }

    .labelFormElementDiv {
        display: flex;
        width: 150px;
    }

    .lkzPlzOrtDivClass {
        display: flex;
        flex-direction: row;
        width: 100%;
    }

    .inputFormElementDiv {
        display: flex;
        width: 100%;
    }

    .LkzAllAddressElementDiv {
        display: flex;
        width: 20%;
    }

    .PlzAllAddressElementDiv {
        display: flex;
        width: 20%;
    }

    .formAtAllDiv {
        display: flex;
        flex-direction: column;
        margin-top: 10px;
        margin-left: auto;
        margin-right: auto;
        max-width: 800px;
    }

    .inputElement {
        display: flex;
        width: 100%;
    }

    .adressContainerDivClass {
        display: flex;
        flex-direction: column;
        margin: 5px 0px 5px 5px;
        padding-top: 10px;
        padding-left: 0px;
        padding-right: 0px;
        padding-bottom: 5px;
        border-top: #cdcdcd 1px solid;
        align-items: stretch;
    }

    .adressReiterDiv {
        display: flex;
        flex-direction: column;
    }

    .reiterButtonContainerDiv {
        display: flex;
        flex-direction: row;
        flex-basis: 33.33%;
    }

    .reiterElementDiv {
        width: 33.33%;
        white-space: nowrap;
        display: flex;
        cursor: pointer;
        background: #ffffff;
        padding-top: 10px;
        padding-bottom: 10px;
        justify-content: center;

        font-family: Roboto, sans-serif;
        font-size: 14px;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.02857em;
        border-bottom: #565656 solid 1px;

        user-select: none;
    }

    .reiterElementDiv:hover {
        background: #0096be;
        color: #ffffff;
    }

    .reiterSelectedElementDiv {
        color: #ffffff;
        border-bottom: #565656 solid 2px;
        background: #00aac8;
    }

    .reiterSelectedElementDiv:hover {
        background: #0096be;
        color: #ffffff;
    }

    .positionenTextHeadlineDiv {
        display: flex;
    }

    .positionenHeadlineContainerDiv {
        display: contents;
        align-items: center;
        font-size: 80%;
    }


    .hiddenClass,
    .hideAtStartup {
        display: none;
    }

    .addPositionenButtonDiv,
    .positionenTextHeadlinePosDiv,
    .positionenTextHeadlineBDiv,
    .positionenTextHeadlineArtikelNrDiv,
    .positionenTextHeadlineBezeichnungDiv,
    .positionenTextHeadlineLängeDiv,
    .positionenTextHeadlineBreiteDiv,
    .positionenTextHeadlineAnzahlDiv,
    .positionenTextHeadlineMengeDiv,
    .positionenTextHeadlineEinheitDiv,
    .positionenTextHeadlinePreisDiv,
    .positionenTextHeadlineRabattDiv,
    .positionenTextHeadlineGesamtpreisDiv {
        align-content: center;
    }

    .addPositionenButtonDiv {
        cursor: pointer;
        width:14px;
        height: 14px
    }

    .positionenContainerGridDiv {
        display: grid;
        column-gap: 4px;
        row-gap: 4px;
        grid-template-columns: auto auto auto auto auto auto auto auto auto auto auto auto auto;
        padding-top: 10px;
        border-top: #cdcdcd 1px solid;
    }

    .singlePositionContainerDivClass {
        display: contents;
    }

    .positionExpandAndCollapseLangTextButtonDivClass {
        grid-column: 2 ;
    }

    .posLangTextDivClass {
        grid-column: 3 / 14;
    }

    .positionBausteinSelectClass,
    .positionEinheitListSelectClass {
        height: 100%;
    }

    .addPositionenButtonDiv,
    .positionenHeadlineContainerDiv,
    .positionenTextHeadlinePosDiv,
    .positionenTextHeadlineBDiv,
    .positionenTextHeadlineArtikelNrDiv,
    .positionenTextHeadlineBezeichnungDiv,
    .positionenTextHeadlineLängeDiv,
    .positionenTextHeadlineBreiteDiv,
    .positionenTextHeadlineAnzahlDiv,
    .positionenTextHeadlineMengeDiv,
    .positionenTextHeadlineEinheitDiv,
    .positionenTextHeadlinePreisDiv,
    .positionenTextHeadlineRabattDiv,
    .positionenTextHeadlineGesamtpreisDiv,
    .positionDeleteButtonDivClass,
    .positionPosDivClass,
    .positionBausteinDivClass,
    .positionArtikelNrDivClass,
    .positionBezeichnungDivClass,
    .positionLengthDivClass,
    .positionWidthDivClass,
    .positionAnzahlDivClass,
    .positionMengeDivClass,
    .positionEinheitDivClass,
    .positionPreisDivClass,
    .positionRabattDivClass,
    .positionGesamtpreisDivClass {

    }



    .positionDeleteButtonDivClass,
    .positionPosDivClass,
    .positionBausteinDivClass,
    .positionArtikelNrDivClass,
    .positionBezeichnungDivClass,
    .positionLengthDivClass,
    .positionWidthDivClass,
    .positionAnzahlDivClass,
    .positionMengeDivClass,
    .positionEinheitDivClass,
    .positionPreisDivClass ,
    .positionRabattDivClass,
    .positionGesamtpreisDivClass {
        align-content: center;
    }

    .positionDeleteButtonDivClass {
        cursor: pointer;
        width:14px;
        height: 100%;
    }

    .positionPosDivClass {
        margin-top: auto;
        margin-bottom: auto;
    }

    .positionBausteinDivClass {

    }

    .positionArtikelNrDivClass {
    }

    .positionBezeichnungDivClass {
    }

    .positionLengthDivClass {
    }

    .positionWidthDivClass {
    }

    .positionAnzahlDivClass {
    }

    .positionMengeDivClass {
    }

    .positionEinheitDivClass {
    }

    .positionPreisDivClass {
    }

    .positionRabattDivClass {
    }

    .positionGesamtpreisDivClass {
    }

    .positionExpandLangTextButtonDivClass {
        cursor: pointer;
    }

    .positionCollapseLangTextButtonDivClass {
        cursor: pointer;
    }

    .positionBausteinSelectClass,
    .positionArtikelNrInputClass,
    .positionBezeichnungInputClass,
    .positionLengthInputClass,
    .positionWidthInputClass,
    .positionAnzahlInputClass,
    .positionMengeInputClass,
    .positionEinheitListSelectClass,
    .positionPreisInputClass,
    .positionRabattInputClass,
    .positionGesamtpreisInputClass,
    .posLangTextTextAreaClass {
        font-size: 80%;
    }

    .positionBausteinSelectClass {

    }

    .positionArtikelNrInputClass {
        width: 60px !important;
    }

    .positionBezeichnungInputClass {
        width: 120px;
    }

    .positionLengthInputClass {
        width: 45px;
    }

    .positionWidthInputClass {
        width: 45px;
    }

    .positionAnzahlInputClass {
        width: 40px;
    }

    .positionMengeInputClass {
        width: 40px;
    }

    .positionEinheitListSelectClass {
        width: 55px;
    }

    .positionPreisInputClass {
        width: 60px;
    }

    .positionRabattInputClass {
        width: 60px;
    }

    .positionGesamtpreisInputClass {
        width: 60px;
    }

    .posLangTextTextAreaClass {
        width: 750px;
        resize: none;
        height: 50px;
    }

    .buttonsDivClass {
        display: flex;
        margin-top: 20px;
        gap:10px;
    }

    .preViewDivClass {
        display: flex;
        margin-top: 20px;
    }

    .previewTextAreaClass {
        width: 100%;
        height: 800px;
    }

     .defaultButtonClass:disabled {
        background-color: rgba(0,0,0,0.12);
        color: rgba(0,0,0,0.38);
        box-shadow: none;
        cursor: default;
    }

    .defaultButtonClass:active {
        background-color: #0096be;
        transform: translateY(1px); /* leicht reindrücken */
        box-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),
                    0px 4px 5px 0px rgba(0,0,0,0.14),
                    0px 1px 10px 0px rgba(0,0,0,0.12);
    }

    .defaultButtonClass:hover {
        background-color: #0096be;
        box-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),
                    0px 4px 5px 0px rgba(0,0,0,0.14),
                    0px 1px 10px 0px rgba(0,0,0,0.12);
    }

    .defaultButtonClass {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 6px 16px;
        min-width: 64px;
        height: 36px;


        font-family: Roboto, sans-serif;
        font-size: 14px;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.02857em;

        background-color: #00aac8;
        color: #fff;
        border: none;
        border-radius: 4px;

        box-shadow: 0px 3px 1px -2px rgba(0,0,0,0.2),
                    0px 2px 2px 0px rgba(0,0,0,0.14),
                    0px 1px 5px 0px rgba(0,0,0,0.12);

        transition: background-color 0.3s, box-shadow 0.3s;
        cursor: pointer;

        user-select: none;

        flex-basis: 33.33%;
    }

    .inlineButtonClass {
        flex-basis: auto;
        height: 21px;
    }

    .autoComplete_wrapper {
        height: 100%;
        display: block;
    }

    .autoComplete_wrapper > input {
        all: unset;          /* entfernt ALLE Styles */
        padding-block: 1px;
        padding-inline: 2px;
        display: inline-block;     /* oder was du willst */
        font: inherit;       /* übernimmt Schrift vom Eltern-Element */
        color: inherit;
        background: none;
        /* height: 80%; *%
        /* border: 1px solid #ccc; */ /* falls du einen Rahmen willst */
        border-color: #ffffff;
        border-width: 1px;
        border-radius: 2px;
        border-style: solid;
        /* padding: 1px 2px 1px 2px; */
        font-size: 80%;

        outline-style: solid;
        outline-width: 1px;
        outline-color: #767676;
    }

    .autoComplete_wrapper > input:focus {
        color: inherit;
        border-color: #101010;
        outline-style: solid;
        outline-width: 1px;
        outline-color: #101010;
    }

    .autoComplete_wrapper > input:hover {
        color: inherit;
        outline-color: #4F4F4F;
        border-style: solid;
        transition: none;
    }

    .autoComplete_wrapper > input:hover:focus {
        color: inherit;
        border-color: #101010;
        outline-style: solid;
        outline-width: 1px;
        outline-color: #101010;
    }

    .autoComplete_wrapper>ul {
        width: 300px;
    }


</style>

<div style="" class="formAtAllDiv">

    <!-- Auftragsnummer -->
    <div style="" class="fullFormElementDiv">
        <div style="" class="labelFormElementDiv">
            <label for="AuftragsNummer">AuftragsNummer:</label>
        </div>
        <div style="" class="inputFormElementDiv">
            <div class="inputElement">
                <img id="animationWaitStribeAuftragsNummer" style="display: none" src="img/animationWaitStribe.png" alt="Waiting Animation">
                <input type="text" id="AuftragsNummer" name="AuftragsNummer" disabled="disabled"/>
                <button id="AuftragsHolenNummerButton" onclick="determineAuftragsnummerFromServer()" style="margin-left: 5px" class="inlineButtonClass defaultButtonClass">AuftragsNummer holen</button>
            </div>
        </div>
    </div>

    <!-- MitarbeiterNr -->
    <div style="" class="fullFormElementDiv">
        <div style="" class="labelFormElementDiv">
            <label for="MitarbeiterNr">Mitarbeiter:</label>
        </div>
        <div style="" class="inputFormElementDiv">
            <select id="MitarbeiterNr" name="MitarbeiterNr" class="inputElement">
                <option value=""></option>
                <option value="LST">Ludwig</option>
                <option value="RRI">Richard</option>
                <option value="SSC">Silvia</option>
                <option value="MMU">Martina</option>
            </select>
        </div>
    </div>

    <!-- Versandart -->
    <div style="" class="fullFormElementDiv">
        <div style="" class="labelFormElementDiv">
            <label for="Versandart">Versandart:</label>
        </div>
        <div style="" class="inputFormElementDiv">
            <select id="Versandart" name="Versandart" class="inputElement">
                <option value=""></option>
                <option value="AA">Abholung Aviso</option>
                <option value="Post">Post</option>
                <option value="o">Bis datto undefiniert ob Abholung oder Versand</option>
                <option value="AB">Zahlung bei Abholung</option>
                <option value="u">Unfrei</option>
                <option value="Zust">Zustellung</option>
                <option value="Sped">Spedition</option>
                <option value="BO">Botendienst</option>
                <option value="uu">Unfrei Unverzollt</option>
                <option value="M">Montage</option>
            </select>
        </div>
    </div>

    <!-- Versandart -->
    <div style="" class="fullFormElementDiv">
        <div style="" class="labelFormElementDiv">
            <label for="ZahlBedText">Zahlungs Bed:</label>
        </div>
        <div style="" class="inputFormElementDiv">
            <select id="ZahlBedText" name="ZahlBedText" class="inputElement">
                <option zahlTage="0" value=""></option>
                <option zahlTage="30" value = "14 Tage 2%, 30 Tage netto">14 Tage 2%, 30 Tage netto</option>
                <option zahlTage="0" value = "Vorauskasse">Vorauskasse</option>
                <option zahlTage="0" value = "zahlbar bei Abholung">zahlbar bei Abholung</option>
                <option zahlTage="30" value = "14 Tage 3%, 30 Tage netto">14 Tage 3%, 30 Tage netto</option>
                <option zahlTage="0" value = "bei Erstbestellung: zahlbar bei Abholung oder Vorauskassa">bei Erstbestellung: zahlbar bei Abholung oder Vorauskassa</option>
                <option zahlTage="0" value = "zahlbar bei Abholung oder Vorauskassa">zahlbar bei Abholung oder Vorauskassa</option>
                <option zahlTage="10" value = "10 Tage netto">10 Tage netto</option>
                <option zahlTage="0" value = "bei Erstbestellung: zahlbar bei Abholung, Vorauskassa oder Nachnahme">bei Erstbestellung: zahlbar bei Abholung, Vorauskassa oder Nachnahme</option>
                <option zahlTage="0" value = "zahlbar bei Abholung, Vorauskassa oder Nachnahme">zahlbar bei Abholung, Vorauskassa oder Nachnahme</option>
                <option zahlTage="60" value = "30 Tage 3%, 60 Tage netto">30 Tage 3%, 60 Tage netto</option>
                <option zahlTage="30" value = "10 Tage 3%, 30 Tage netto">10 Tage 3%, 30 Tage netto</option>
                <option zahlTage="30" value = "10 Tage 2%, 30 Tage netto">10 Tage 2%, 30 Tage netto</option>
                <option zahlTage="60" value = "30 Tage 5%, 60 Tage netto">30 Tage 5%, 60 Tage netto</option>
                <option zahlTage="60" value = "14 Tage 3%, 60 Tage netto">14 Tage 3%, 60 Tage netto</option>
                <option zahlTage="30" value = "21 Tage 3%, 30 Tage netto">21 Tage 3%, 30 Tage netto</option>
                <option zahlTage="90" value = "30 Tage 3%, 90 Tage netto">30 Tage 3%, 90 Tage netto</option>
                <option zahlTage="0" value = "sofort nach Rechnungserhalt ohne Abzug">sofort nach Rechnungserhalt ohne Abzug</option>
                <option zahlTage="60" value = "60 Tage netto">60 Tage netto</option>
                <option zahlTage="0" value = "bei Erstbestellung: Vorauskassa oder Nachnahme">bei Erstbestellung: Vorauskassa oder Nachnahme</option>
                <option zahlTage="0" value = "bei Erstbestellung: zahlbar bei Abholung, Vorauskassa oder Nachnahme (NN-Gebühr 20,-- + 20% MWST.)">bei Erstbestellung: zahlbar bei Abholung, Vorauskassa oder Nachnahme (NN-Gebühr 20,-- + 20% MWST.)</option>
                <option zahlTage="30" value = "21 Tage 2% Skonto, 30 Tage netto">21 Tage 2% Skonto, 30 Tage netto</option>
                <option zahlTage="0" value = "zahlbar bei Abholung, Vorauskassa oder Nachnahme (NN-Gebühr 20,-- + 20% MWST.)">zahlbar bei Abholung, Vorauskassa oder Nachnahme (NN-Gebühr 20,-- + 20% MWST.)</option>
                <option zahlTage="0" value = "Vorauskassa oder Nachnahme">Vorauskassa oder Nachnahme</option>
                <option zahlTage="0" value = "bei Erstbestellung: zahlbar bei Abholung">bei Erstbestellung: zahlbar bei Abholung</option>
                <option zahlTage="0" value = "Zahlung per Nachnahme">Zahlung per Nachnahme</option>
                <option zahlTage="60" value = "14 Tage 2%, 60 Tage netto">14 Tage 2%, 60 Tage netto</option>
                <option zahlTage="30" value = "30 Tage netto">30 Tage netto</option>
                <option zahlTage="0" value = "bei Erstbestellung: Vorauskassa">bei Erstbestellung: Vorauskassa</option>
                <option zahlTage="7" value = "7 Tage netto">7 Tage netto</option>
                <option zahlTage="30" value = "19 Tage 3%, 30 Tage netto">19 Tage 3%, 30 Tage netto</option>
                <option zahlTage="30" value = "7 Tage 5%, 14 Tage 3%, 30 Tage netto">7 Tage 5%, 14 Tage 3%, 30 Tage netto</option>
                <option zahlTage="45" value = "14 Tage 2%, 45 Tage netto">14 Tage 2%, 45 Tage netto</option>
                <option zahlTage="0" value = "nach Vereinbarung">nach Vereinbarung</option>
                <option zahlTage="0" value = "prepayment">prepayment</option>
                <option zahlTage="0" value = "zahlbar bei Zustellung">zahlbar bei Zustellung</option>
                <option zahlTage="90" value = "30 Tage 3%, 45 Tage 2%, 90 Tage netto">30 Tage 3%, 45 Tage 2%, 90 Tage netto</option>
                <option zahlTage="30" value = "7 Tage 3%, 30 Tage netto">7 Tage 3%, 30 Tage netto</option>
            </select>
        </div>
    </div>

    <!-- IhreZeichen -->
    <div style="" class="fullFormElementDiv">
        <div style="" class="labelFormElementDiv">
            <label for="IhreZeichen">IhreZeichen:</label>
        </div>
        <div style="" class="inputFormElementDiv">
            <input type="text" id="IhreZeichen" name="IhreZeichen" class="inputElement" autocomplete="off" spellcheck="false" autocapitalize="sentences"/>
        </div>
    </div>

    <!-- Lieferzeit -->
    <div style="" class="fullFormElementDiv">
        <div style="" class="labelFormElementDiv">
            <label for="Lieferzeit">Lieferzeit:</label>
        </div>
        <div style="" class="inputFormElementDiv">
            <input type="text" id="Lieferzeit" name="Lieferzeit" class="inputElement" list="lieferzeitVorschlaege"  autocomplete="off" spellcheck="false" autocapitalize="sentences"/>
            <datalist id="lieferzeitVorschlaege">
                <option>1-2 Werktage</option>
                <option>3-4 Werktage</option>
                <option>1 Woche</option>
                <option>1-2 Wochen</option>
                <option>2 Wochen</option>
                <option>2-3 Wochen</option>
                <option>3 Wochen</option>
            </datalist>
        </div>
    </div>

    <!-- Versandvermerk -->
    <div style="" class="fullFormElementDiv">
        <div style="" class="labelFormElementDiv">
            <label for="Versandvermerk">Versandvermerk:</label>
        </div>
        <div style="" class="inputFormElementDiv">
            <input type="text" id="Versandvermerk" name="Versandvermerk" class="inputElement" autocomplete="off" spellcheck="false" autocapitalize="sentences"/>
        </div>
    </div>

    <!-- LiefBedText -->
    <div style="" class="fullFormElementDiv">
        <div style="" class="labelFormElementDiv">
            <label for="LiefBedText">Liefer Bedingung:</label>
        </div>
        <div style="" class="inputFormElementDiv">
            <select id="LiefBedText" name="LiefBedText" class="inputElement">
                <option value=""></option>
                <option value="ab Werk, unverpackt">ab Werk, unverpackt</option>
                <option value="Versand unfrei">Versand unfrei</option>
                <option value="Frei Haus">Frei Haus</option>
                <option value="Zustellung unfrei">Zustellung unfrei</option>
                <option value="Versand unfrei - Spedition">Versand unfrei - Spedition</option>
                <option value="Versand unfrei, unverzollt">Versand unfrei, unverzollt</option>
                <option value="ab Werk">ab Werk</option>
                <option value="ab Werk, verpackt">ab Werk, verpackt</option>
            </select>
        </div>
    </div>


    <!-- BEGIN Adress Reiter Container -->
    <div style="" class="adressContainerDivClass">
        <div style="" class="reiterButtonContainerDiv">
            <div id="reiterAdresse" style="" class="reiterElementDiv reiterSelectedElementDiv" onclick="onClickAdresseReiter()">
                Adresse
            </div>
            <div id="reiterLieferanschrift" style="" class="reiterElementDiv" onclick="onClickLieferanschriftReiter()">
                Lieferanschrift
            </div>
            <div id="reiterRechnungsanschrift" style="" class="reiterElementDiv" onclick="onClickRechnungsanschriftReiter()">
                Rechnungsanschrift
            </div>
        </div>
        <!-- BEGIN Adresse Reiter -->
        <div id="reiterContentAdresse" style="" class="adressReiterDiv">

            <!-- Firma1 -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="adresseFirma1">Firma:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="text" id="adresseFirma1" name="adresseFirma1" class="inputElement" autocomplete="off" spellcheck="false" autocapitalize="sentences"/>
                </div>
            </div>

            <!-- Firma2 -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="adresseFirma2">-</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="text" id="adresseFirma2" name="adresseFirma2" class="inputElement" autocomplete="off" spellcheck="false" autocapitalize="sentences"/>
                </div>
            </div>

            <!-- Ansprech Partner Name -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="adresseApartnerName">Anspr.partner:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="text" id="adresseApartnerName" name="adresseApartnerName" class="inputElement" autocomplete="off" spellcheck="false" autocapitalize="sentences"/>
                </div>
            </div>

            <!-- Strasse -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="adresseStrasse">Strasse:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="text" id="adresseStrasse" name="adresseStrasse" class="inputElement" autocomplete="off" spellcheck="false" autocapitalize="sentences"/>
                </div>
            </div>

            <!-- Lkz-Plz-Ort -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="adresseLkz">LKZ-PLZ-Ort:</label>
                </div>
                <div class="lkzPlzOrtDivClass">
                    <div style="" class="LkzAllAddressElementDiv">
                        <select id="adresseLkz" name="adresseLkz" class="inputElement">
                            <option value=""></option>
                            <option value="AT">Österreich</option>
                            <option value="DE">Deutschland</option>
                            <option value="CH">Schweiz</option>
                            <option value="IT">Italien</option>
                            <option value="SI">Slowenien</option>
                            <option value="NL">Holland</option>
                            <option value="LU">Luxenburg</option>
                            <option value="HU">Ungarn</option>
                            <option value="SK">Slowakei</option>
                            <option value="ES">Spanien</option>
                            <option value="FR">Frankreich</option>
                            <option value="CZ">Tschechien</option>
                            <option value="LI">Liechtenstein</option>
                            <option value="PL">Polen</option>
                            <option value="HR">Kroatien</option>
                            <option value="RO">Rumänien</option>
                            <option value="GB">Großbritannien</option>
                        </select>
                    </div>
                    <div style="" class="PlzAllAddressElementDiv">
                        <input type="text" id="adressePlz" name="adressePlz" class="inputElement" placeholder="PLZ" autocomplete="off" spellcheck="false" autocapitalize="sentences"/>
                    </div>
                    <div style="" class="inputFormElementDiv">
                        <input type="text" id="adresseOrt" name="adresseOrt" class="inputElement" placeholder="Ort" autocomplete="off" spellcheck="false" autocapitalize="sentences"/>
                    </div>
                </div>
            </div>

            <!-- Tel -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="adresseTel">Tel:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="tel" id="adresseTel" name="adresseTel" class="inputElement"/>
                </div>
            </div>

            <!-- email -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="adresseemail">E-Mail:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="email" id="adresseemail" name="adresseemail" class="inputElement"/>
                </div>
            </div>
        </div> <!-- END Adresse Reiter -->

        <!-- BEGIN Lieferanschrift -->
        <div id="reiterContentLieferanschrift" style="display: none" class="adressReiterDiv">

            <!-- Firma1 -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="lieferanschriftFirma1">Firma:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="text" id="lieferanschriftFirma1" name="lieferanschriftFirma1" class="inputElement" autocomplete="off" spellcheck="false" autocapitalize="sentences"/>
                </div>
            </div>

            <!-- Firma2 -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="lieferanschriftFirma2">-</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="text" id="lieferanschriftFirma2" name="lieferanschriftFirma2" class="inputElement" autocomplete="off" spellcheck="false" autocapitalize="sentences"/>
                </div>
            </div>

            <!-- Ansprech Partner Name -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="lieferanschriftApartnerName">Anspr.partner:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="text" id="lieferanschriftApartnerName" name="lieferanschriftApartnerName" class="inputElement" autocomplete="off" spellcheck="false" autocapitalize="sentences"/>
                </div>
            </div>

            <!-- Strasse -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="lieferanschriftStrasse">Strasse:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="text" id="lieferanschriftStrasse" name="lieferanschriftStrasse" class="inputElement" autocomplete="off" spellcheck="false" autocapitalize="sentences"/>
                </div>
            </div>

            <!-- Lkz-Plz-Ort -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="lieferanschriftLkz">LKZ-PLZ-Ort:</label>
                </div>
                <div class="lkzPlzOrtDivClass">
                    <div style="" class="LkzAllAddressElementDiv">
                        <select id="lieferanschriftLkz" name="lieferanschriftLkz" class="inputElement">
                            <option value=""></option>
                            <option value="AT">Österreich</option>
                            <option value="DE">Deutschland</option>
                            <option value="CH">Schweiz</option>
                            <option value="IT">Italien</option>
                            <option value="SI">Slowenien</option>
                            <option value="NL">Holland</option>
                            <option value="LU">Luxenburg</option>
                            <option value="HU">Ungarn</option>
                            <option value="SK">Slowakei</option>
                            <option value="ES">Spanien</option>
                            <option value="FR">Frankreich</option>
                            <option value="CZ">Tschechien</option>
                            <option value="LI">Liechtenstein</option>
                            <option value="PL">Polen</option>
                            <option value="HR">Kroatien</option>
                            <option value="RO">Rumänien</option>
                            <option value="GB">Großbritannien</option>
                        </select>
                    </div>
                    <div style="" class="PlzAllAddressElementDiv">
                        <input type="text" id="lieferanschriftPlz" name="lieferanschriftPlz" class="inputElement" placeholder="PLZ" autocomplete="off" spellcheck="false" autocapitalize="sentences"/>
                    </div>
                    <div style="" class="inputFormElementDiv">
                        <input type="text" id="lieferanschriftOrt" name="lieferanschriftOrt" class="inputElement" placeholder="Ort" autocomplete="off" spellcheck="false" autocapitalize="sentences"/>
                    </div>
                </div>
            </div>

            <!-- Tel -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="lieferanschriftTel">Tel:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="tel" id="lieferanschriftTel" name="lieferanschriftTel" class="inputElement"/>
                </div>
            </div>

            <!-- email -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="lieferanschriftemail">E-Mail:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="email" id="lieferanschriftemail" name="lieferanschriftemail" class="inputElement"/>
                </div>
            </div>
        </div>
        <!-- END Lieferanschrift -->

        <!-- BEGIN Rechnungsanschrift -->
        <div id="reiterContentRechnungsanschrift" style="display: none" class="adressReiterDiv">

            <!-- Firma1 -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="rechnungsanschriftFirma1">Firma:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="text" id="rechnungsanschriftFirma1" name="rechnungsanschriftFirma1" class="inputElement"/>
                </div>
            </div>

            <!-- Firma2 -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="rechnungsanschriftFirma2">-</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="text" id="rechnungsanschriftFirma2" name="rechnungsanschriftFirma2" class="inputElement"/>
                </div>
            </div>

            <!-- Ansprech Partner Name -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="rechnungsanschriftApartnerName">Anspr.partner:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="text" id="rechnungsanschriftApartnerName" name="rechnungsanschriftApartnerName" class="inputElement"/>
                </div>
            </div>

            <!-- Strasse -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="rechnungsanschriftStrasse">Strasse:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="text" id="rechnungsanschriftStrasse" name="rechnungsanschriftStrasse" class="inputElement"/>
                </div>
            </div>

            <!-- Lkz-Plz-Ort -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="rechnungsanschriftLkz">LKZ-PLZ-Ort:</label>
                </div>
                <div class="lkzPlzOrtDivClass">
                    <div style="" class="LkzAllAddressElementDiv">
                        <select id="rechnungsanschriftLkz" name="rechnungsanschriftLkz" class="inputElement">
                            <option value=""></option>
                            <option value="AT">Österreich</option>
                            <option value="DE">Deutschland</option>
                            <option value="CH">Schweiz</option>
                            <option value="IT">Italien</option>
                            <option value="SI">Slowenien</option>
                            <option value="NL">Holland</option>
                            <option value="LU">Luxenburg</option>
                            <option value="HU">Ungarn</option>
                            <option value="SK">Slowakei</option>
                            <option value="ES">Spanien</option>
                            <option value="FR">Frankreich</option>
                            <option value="CZ">Tschechien</option>
                            <option value="LI">Liechtenstein</option>
                            <option value="PL">Polen</option>
                            <option value="HR">Kroatien</option>
                            <option value="RO">Rumänien</option>
                            <option value="GB">Großbritannien</option>
                        </select>
                    </div>
                    <div style="" class="PlzAllAddressElementDiv">
                        <input type="text" id="rechnungsanschriftPlz" name="rechnungsanschriftPlz" class="inputElement" placeholder="PLZ" autocomplete="off" spellcheck="false" autocapitalize="sentences"/>
                    </div>
                    <div style="" class="inputFormElementDiv">
                        <input type="text" id="rechnungsanschriftOrt" name="rechnungsanschriftOrt" class="inputElement"  placeholder="Ort" autocomplete="off" spellcheck="false" autocapitalize="sentences"/>
                    </div>
                </div>
            </div>

            <!-- Tel -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="rechnungsanschriftTel">Tel:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="tel" id="rechnungsanschriftTel" name="rechnungsanschriftTel" class="inputElement"/>
                </div>
            </div>

            <!-- email -->
            <div style="" class="fullFormElementDiv">
                <div style="" class="labelFormElementDiv">
                    <label for="rechnungsanschriftemail">E-Mail:</label>
                </div>
                <div style="" class="inputFormElementDiv">
                    <input type="email" id="rechnungsanschriftemail" name="rechnungsanschriftemail" class="inputElement"/>
                </div>
            </div>
        </div>
        <!-- END Rechnungsanschrift -->

    </div> <!-- END Adress Reiter Container -->

    <!-- BEGIN POSITIONEN DIV -->
    <div id="positionenContainerGridDiv" class="positionenContainerGridDiv">
        <div class="positionenHeadlineContainerDiv">
            <div class="addPositionenButtonDiv" onclick="addPosition()">
                <img src="img/add.svg" alt="Button Add Position">
            </div>
            <div class="positionenTextHeadlinePosDiv hideAtStartup posHeader">Pos</div>
            <div class="positionenTextHeadlineBDiv hideAtStartup posHeader">B</div>
            <div class="positionenTextHeadlineArtikelNrDiv hideAtStartup posHeader">ArtikelNr</div>
            <div class="positionenTextHeadlineBezeichnungDiv hideAtStartup posHeader">Bezeichnung</div>
            <div class="positionenTextHeadlineLängeDiv hideAtStartup posHeader">Länge</div>
            <div class="positionenTextHeadlineBreiteDiv hideAtStartup posHeader">Breite</div>
            <div class="positionenTextHeadlineAnzahlDiv hideAtStartup posHeader">Anzahl</div>
            <div class="positionenTextHeadlineMengeDiv hideAtStartup posHeader">Menge</div>
            <div class="positionenTextHeadlineEinheitDiv hideAtStartup posHeader">Einheit</div>
            <div class="positionenTextHeadlinePreisDiv hideAtStartup posHeader">Preis</div>
            <div class="positionenTextHeadlineRabattDiv hideAtStartup posHeader">Rabatt</div>
            <div class="positionenTextHeadlineGesamtpreisDiv hideAtStartup posHeader">Gesamtpreis</div>
        </div>
    </div>

    <div style="" class="buttonsDivClass">
        <button id="downloadButton" onclick="doDownloadFile(false)" class="defaultButtonClass">Download XML-File</button>
        <button id="viewButton" onclick="doShowFile(false)" class="defaultButtonClass">Anzeigen XML-File</button>
        <button id="resetButton" onclick="doReset()" class="defaultButtonClass">Reset</button>
    </div>
    <div id="preViewDiv" style="display: none" class="preViewDivClass">
        <textarea id="offerXmlPreView" style="" class="previewTextAreaClass"></textarea>
    </div>
</div>
<br><br>

</body>
</html>